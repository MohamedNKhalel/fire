"use strict";(self.webpackChunkfirebase_train=self.webpackChunkfirebase_train||[]).push([[157],{8157:(tT,Xc,D)=>{D.r(Xc),D.d(Xc,{DashboardComponent:()=>JI,MyErrorStateMatcher:()=>XI});var G=D(6814),N=D(95),l=D(5879);function Te(n){return null!=n&&"false"!=`${n}`}function Jc(n,e=0){return function v_(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function Dr(n){return Array.isArray(n)?n:[n]}function de(n){return null==n?"":"string"==typeof n?n:`${n}px`}function hi(n){return n instanceof l.SBq?n.nativeElement:n}let go;try{go=typeof Intl<"u"&&Intl.v8BreakIterator}catch{go=!1}let vn,Ke=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?(0,G.NF)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!go)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(l.Lbi))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const ed=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function td(){if(vn)return vn;if("object"!=typeof document||!document)return vn=new Set(ed),vn;let n=document.createElement("input");return vn=new Set(ed.filter(e=>(n.setAttribute("type",e),n.type===e))),vn}let fi,Gt;function mi(n){return function x_(){if(null==fi&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>fi=!0}))}finally{fi=fi||!1}return fi}()?n:!!n.capture}function b_(){if(null==Gt){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Gt=!1,Gt;if("scrollBehavior"in document.documentElement.style)Gt=!0;else{const n=Element.prototype.scrollTo;Gt=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return Gt}function vo(n){return n.composedPath?n.composedPath()[0]:n.target}function xo(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var w_=D(6232),ie=D(8645);const nd=mi({passive:!0});let I_=(()=>{class n{constructor(t,i){this._platform=t,this._ngZone=i,this._monitoredElements=new Map}monitor(t){if(!this._platform.isBrowser)return w_.E;const i=hi(t),r=this._monitoredElements.get(i);if(r)return r.subject;const s=new ie.x,o="cdk-text-field-autofilled",a=c=>{"cdk-text-field-autofill-start"!==c.animationName||i.classList.contains(o)?"cdk-text-field-autofill-end"===c.animationName&&i.classList.contains(o)&&(i.classList.remove(o),this._ngZone.run(()=>s.next({target:c.target,isAutofilled:!1}))):(i.classList.add(o),this._ngZone.run(()=>s.next({target:c.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{i.addEventListener("animationstart",a,nd),i.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(i,{subject:s,unlisten:()=>{i.removeEventListener("animationstart",a,nd)}}),s}stopMonitoring(t){const i=hi(t),r=this._monitoredElements.get(i);r&&(r.unlisten(),r.subject.complete(),i.classList.remove("cdk-text-field-autofill-monitored"),i.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(i))}ngOnDestroy(){this._monitoredElements.forEach((t,i)=>this.stopMonitoring(i))}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(Ke),l.LFG(l.R0b))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),T_=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({})}return n})();var lt=D(7394);function pi(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}var z_=D(9397),Mr=D(6321),Fr=D(9360),_i=D(8251);function od(n,e=Mr.z){return(0,Fr.e)((t,i)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const d=s;s=null,i.next(d)}};function c(){const d=o+n,u=e.now();if(u<d)return r=this.schedule(void 0,d-u),void i.add(r);a()}t.subscribe((0,_i.x)(i,d=>{s=d,o=e.now(),r||(r=e.schedule(c,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{s=r=null}))})}var ct=D(2181),De=D(7398),U_=D(2572),q_=D(5211),xn=D(5592),Or=D(8180),bn=D(7921),Ge=D(9773);const ad=new Set;let jt,j_=(()=>{class n{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Z_}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function H_(n,e){if(!ad.has(n))try{jt||(jt=document.createElement("style"),e&&(jt.nonce=e),jt.setAttribute("type","text/css"),document.head.appendChild(jt)),jt.sheet&&(jt.sheet.insertRule(`@media ${n} {body{ }}`,0),ad.add(n))}catch(t){console.error(t)}}(t,this._nonce),this._matchMedia(t)}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(Ke),l.LFG(l.Ojb,8))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Z_(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let K_=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new ie.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return ld(Dr(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){const r=ld(Dr(t)).map(o=>this._registerQuery(o).observable);let s=(0,U_.a)(r);return s=(0,q_.z)(s.pipe((0,Or.q)(1)),s.pipe(function G_(n){return(0,ct.h)((e,t)=>n<=t)}(1),od(0))),s.pipe((0,De.U)(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:c,query:d})=>{a.matches=a.matches||c,a.breakpoints[d]=c}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new xn.y(o=>{const a=c=>this._zone.run(()=>o.next(c));return i.addListener(a),()=>{i.removeListener(a)}}).pipe((0,bn.O)(i),(0,De.U)(({matches:o})=>({query:t,matches:o})),(0,Ge.R)(this._destroySubject)),mql:i};return this._queries.set(t,s),s}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(j_),l.LFG(l.R0b))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ld(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}function dd(n,e,t){const r=ud(n,e).filter(s=>s!=t.trim());r.length?n.setAttribute(e,r.join(" ")):n.removeAttribute(e)}function ud(n,e){return(n.getAttribute(e)||"").match(/\S+/g)||[]}class Q_{constructor(e){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new ie.x,this._typeaheadSubscription=lt.w0.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new ie.x,this.change=new ie.x,e instanceof l.n_E&&(this._itemChangesSubscription=e.changes.subscribe(t=>{if(this._activeItem){const r=t.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}}))}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe((0,z_.b)(t=>this._pressedLetters.push(t)),od(e),(0,ct.h)(()=>this._pressedLetters.length>0),(0,De.U)(()=>this._pressedLetters.join(""))).subscribe(t=>{const i=this._getItemsArray();for(let r=1;r<i.length+1;r++){const s=(this._activeItemIndex+r)%i.length,o=i[s];if(!this._skipPredicateFn(o)&&0===o.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,t=10){return this._pageUpAndDown={enabled:e,delta:t},this}setActiveItem(e){const t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex+this._pageUpAndDown.delta,o=this._getItemsArray().length;this._setActiveItemByIndex(s<o?s:o-1,-1);break}return;default:return void((r||pi(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),i="number"==typeof e?e:t.indexOf(e);this._activeItem=t[i]??null,this._activeItemIndex=i}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let i=1;i<=t.length;i++){const r=(this._activeItemIndex+e*i+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const i=this._getItemsArray();if(i[e]){for(;this._skipPredicateFn(i[e]);)if(!i[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return this._items instanceof l.n_E?this._items.toArray():this._items}}class X_ extends Q_{setActiveItem(e){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(e),this.activeItem&&this.activeItem.setActiveStyles()}}const og=new l.OlP("liveAnnouncerElement",{providedIn:"root",factory:function ag(){return null}}),lg=new l.OlP("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let cg=0,dg=(()=>{class n{constructor(t,i,r,s){this._ngZone=i,this._defaultOptions=s,this._document=r,this._liveElement=t||this._createLiveElement()}announce(t,...i){const r=this._defaultOptions;let s,o;return 1===i.length&&"number"==typeof i[0]?o=i[0]:[s,o]=i,this.clear(),clearTimeout(this._previousTimeout),s||(s=r&&r.politeness?r.politeness:"polite"),null==o&&r&&(o=r.duration),this._liveElement.setAttribute("aria-live",s),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(a=>this._currentResolve=a)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=t,"number"==typeof o&&(this._previousTimeout=setTimeout(()=>this.clear(),o)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const t="cdk-live-announcer-element",i=this._document.getElementsByClassName(t),r=this._document.createElement("div");for(let s=0;s<i.length;s++)i[s].remove();return r.classList.add(t),r.classList.add("cdk-visually-hidden"),r.setAttribute("aria-atomic","true"),r.setAttribute("aria-live","polite"),r.id="cdk-live-announcer-"+cg++,this._document.body.appendChild(r),r}_exposeAnnouncerToModals(t){const i=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let r=0;r<i.length;r++){const s=i[r],o=s.getAttribute("aria-owns");o?-1===o.indexOf(t)&&s.setAttribute("aria-owns",o+" "+t):s.setAttribute("aria-owns",t)}}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(og,8),l.LFG(l.R0b),l.LFG(G.K0),l.LFG(lg,8))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const fd="cdk-high-contrast-black-on-white",md="cdk-high-contrast-white-on-black",To="cdk-high-contrast-active";let ug=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=(0,l.f3M)(K_).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(To,fd,md),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(To,fd):2===i&&t.add(To,md)}}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(Ke),l.LFG(G.K0))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const hg=new l.OlP("cdk-dir-doc",{providedIn:"root",factory:function fg(){return(0,l.f3M)(G.K0)}}),mg=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Vr=(()=>{class n{constructor(t){this.value="ltr",this.change=new l.vpe,t&&(this.value=function pg(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?mg.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(hg,8))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),gi=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({})}return n})();const _g=["text"];function gg(n,e){if(1&n&&l._UZ(0,"mat-pseudo-checkbox",6),2&n){const t=l.oxw();l.Q6J("disabled",t.disabled)("state",t.selected?"checked":"unchecked")}}function yg(n,e){if(1&n&&l._UZ(0,"mat-pseudo-checkbox",7),2&n){const t=l.oxw();l.Q6J("disabled",t.disabled)}}function vg(n,e){if(1&n&&(l.TgZ(0,"span",8),l._uU(1),l.qZA()),2&n){const t=l.oxw();l.xp6(1),l.hij("(",t.group.label,")")}}const xg=[[["mat-icon"]],"*"],bg=["mat-icon","*"],wg=new l.OlP("mat-sanity-checks",{providedIn:"root",factory:function Eg(){return!0}});let Ye=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!xo()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(ug),l.LFG(wg,8),l.LFG(G.K0))};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({imports:[gi,gi]})}return n})();function Ig(n){return class extends n{get disabled(){return this._disabled}set disabled(e){this._disabled=Te(e)}constructor(...e){super(...e),this._disabled=!1}}}function Tg(n){return class extends n{get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=Te(e)}constructor(...e){super(...e),this._disableRipple=!1}}}function Ag(n,e=0){return class extends n{get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?Jc(t):this.defaultTabIndex}constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}}}function gd(n){return class extends n{updateErrorState(){const e=this.errorState,s=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);s!==e&&(this.errorState=s,this.stateChanges.next())}constructor(...e){super(...e),this.errorState=!1}}}let yd=(()=>{class n{isErrorState(t,i){return!!(t&&t.invalid&&(t.touched||i&&i.submitted))}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class Sg{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const vd=mi({passive:!0,capture:!0});class Rg{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=vo(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){const s=this._events.get(t);if(s){const o=s.get(i);o?o.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,vd)})}removeHandler(e,t,i){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(i),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,vd)))}}const xd={enterDuration:225,exitDuration:150},bd=mi({passive:!0,capture:!0}),Ed=["mousedown","touchstart"],wd=["mouseup","mouseleave","touchend","touchcancel"];class Nr{static#e=this._eventManager=new Rg;constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=hi(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...xd,...i.animation};i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function Dg(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),a=e-r.left,c=t-r.top,d=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=c-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=i.color&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${d}ms`,this._containerElement.appendChild(u);const h=window.getComputedStyle(u),m=h.transitionDuration,g="none"===h.transitionProperty||"0s"===m||"0s, 0s"===m||0===r.width&&0===r.height,v=new Sg(this,u,i,g);u.style.transform="scale3d(1, 1, 1)",v.state=0,i.persistent||(this._mostRecentTransientRipple=v);let b=null;return!g&&(d||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const C=()=>this._finishRippleTransition(v),k=()=>this._destroyRipple(v);u.addEventListener("transitionend",C),u.addEventListener("transitioncancel",k),b={onTransitionEnd:C,onTransitionCancel:k}}),this._activeRipples.set(v,b),(g||!d)&&this._finishRippleTransition(v),v}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,i={...xd,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=hi(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,Ed.forEach(i=>{Nr._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{wd.forEach(t=>{this._triggerElement.addEventListener(t,this,bd)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=1,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=function rg(n){return 0===n.buttons||0===n.detail}(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!function sg(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(Ed.forEach(t=>Nr._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&wd.forEach(t=>e.removeEventListener(t,this,bd)))}}const kg=new l.OlP("mat-ripple-global-options");let Mg=(()=>{class n{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new Nr(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}static#e=this.\u0275fac=function(i){return new(i||n)(l.Y36(l.SBq),l.Y36(l.R0b),l.Y36(Ke),l.Y36(kg,8),l.Y36(l.QbO,8))};static#t=this.\u0275dir=l.lG2({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){2&i&&l.ekj("mat-ripple-unbounded",r.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return n})(),Fg=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({imports:[Ye,Ye]})}return n})(),Og=(()=>{class n{constructor(t){this._animationMode=t,this.state="unchecked",this.disabled=!1,this.appearance="full"}static#e=this.\u0275fac=function(i){return new(i||n)(l.Y36(l.QbO,8))};static#t=this.\u0275cmp=l.Xpm({type:n,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(i,r){2&i&&l.ekj("mat-pseudo-checkbox-indeterminate","indeterminate"===r.state)("mat-pseudo-checkbox-checked","checked"===r.state)("mat-pseudo-checkbox-disabled",r.disabled)("mat-pseudo-checkbox-minimal","minimal"===r.appearance)("mat-pseudo-checkbox-full","full"===r.appearance)("_mat-animation-noopable","NoopAnimations"===r._animationMode)},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},decls:0,vars:0,template:function(i,r){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-full{border:2px solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0})}return n})(),Vg=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({imports:[Ye]})}return n})();const Id=new l.OlP("MAT_OPTION_PARENT_COMPONENT"),Td=new l.OlP("MatOptgroup");let Ng=0;class Lg{constructor(e,t=!1){this.source=e,this.isUserInput=t}}let Bg=(()=>{class n{get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(t){this._disabled=Te(t)}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get hideSingleSelectionIndicator(){return!(!this._parent||!this._parent.hideSingleSelectionIndicator)}constructor(t,i,r,s){this._element=t,this._changeDetectorRef=i,this._parent=r,this.group=s,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+Ng++,this.onSelectionChange=new l.vpe,this._stateChanges=new ie.x}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(t=!0){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),t&&this._emitSelectionChangeEvent())}deselect(t=!0){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),t&&this._emitSelectionChangeEvent())}focus(t,i){const r=this._getHostElement();"function"==typeof r.focus&&r.focus(i)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(t){(13===t.keyCode||32===t.keyCode)&&!pi(t)&&(this._selectViaInteraction(),t.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const t=this.viewValue;t!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=t)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(t=!1){this.onSelectionChange.emit(new Lg(this,t))}static#e=this.\u0275fac=function(i){l.$Z()};static#t=this.\u0275dir=l.lG2({type:n,viewQuery:function(i,r){if(1&i&&l.Gf(_g,7),2&i){let s;l.iGM(s=l.CRH())&&(r._text=s.first)}},inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}})}return n})(),Ad=(()=>{class n extends Bg{constructor(t,i,r,s){super(t,i,r,s)}static#e=this.\u0275fac=function(i){return new(i||n)(l.Y36(l.SBq),l.Y36(l.sBO),l.Y36(Id,8),l.Y36(Td,8))};static#t=this.\u0275cmp=l.Xpm({type:n,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(i,r){1&i&&l.NdJ("click",function(){return r._selectViaInteraction()})("keydown",function(o){return r._handleKeydown(o)}),2&i&&(l.Ikx("id",r.id),l.uIk("aria-selected",r.selected)("aria-disabled",r.disabled.toString()),l.ekj("mdc-list-item--selected",r.selected)("mat-mdc-option-multiple",r.multiple)("mat-mdc-option-active",r.active)("mdc-list-item--disabled",r.disabled))},exportAs:["matOption"],features:[l.qOj],ngContentSelectors:bg,decls:8,vars:5,consts:[["class","mat-mdc-option-pseudo-checkbox","aria-hidden","true",3,"disabled","state",4,"ngIf"],[1,"mdc-list-item__primary-text"],["text",""],["class","mat-mdc-option-pseudo-checkbox","state","checked","aria-hidden","true","appearance","minimal",3,"disabled",4,"ngIf"],["class","cdk-visually-hidden",4,"ngIf"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"]],template:function(i,r){1&i&&(l.F$t(xg),l.YNc(0,gg,1,2,"mat-pseudo-checkbox",0),l.Hsn(1),l.TgZ(2,"span",1,2),l.Hsn(4,1),l.qZA(),l.YNc(5,yg,1,1,"mat-pseudo-checkbox",3),l.YNc(6,vg,2,1,"span",4),l._UZ(7,"div",5)),2&i&&(l.Q6J("ngIf",r.multiple),l.xp6(5),l.Q6J("ngIf",!r.multiple&&r.selected&&!r.hideSingleSelectionIndicator),l.xp6(1),l.Q6J("ngIf",r.group&&r.group._inert),l.xp6(1),l.Q6J("matRippleTrigger",r._getHostElement())("matRippleDisabled",r.disabled||r.disableRipple))},dependencies:[Mg,G.O5,Og],styles:['.mat-mdc-option{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color);font-family:var(--mat-option-label-text-font);line-height:var(--mat-option-label-text-line-height);font-size:var(--mat-option-label-text-size);letter-spacing:var(--mat-option-label-text-tracking);font-weight:var(--mat-option-label-text-weight);min-height:48px}.mat-mdc-option:focus{outline:none}[dir=rtl] .mat-mdc-option,.mat-mdc-option[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color)}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color)}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color)}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple){background-color:var(--mat-option-selected-state-layer-color)}.mat-mdc-option.mdc-list-item{align-items:center}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}.cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{right:auto;left:16px}.mat-mdc-option-active .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return n})(),Cd=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({imports:[Fg,G.ez,Ye,Vg]})}return n})();var vi=D(3019),qg=D(940);class Gg{constructor(e){this._box=e,this._destroyed=new ie.x,this._resizeSubject=new ie.x,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(t=>this._resizeSubject.next(t)))}observe(e){return this._elementObservables.has(e)||this._elementObservables.set(e,new xn.y(t=>{const i=this._resizeSubject.subscribe(t);return this._resizeObserver?.observe(e,{box:this._box}),()=>{this._resizeObserver?.unobserve(e),i.unsubscribe(),this._elementObservables.delete(e)}}).pipe((0,ct.h)(t=>t.some(i=>i.target===e)),(0,qg.d)({bufferSize:1,refCount:!0}),(0,Ge.R)(this._destroyed))),this._elementObservables.get(e)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}}let jg=(()=>{class n{constructor(){this._observers=new Map,this._ngZone=(0,l.f3M)(l.R0b)}ngOnDestroy(){for(const[,t]of this._observers)t.destroy();this._observers.clear()}observe(t,i){const r=i?.box||"content-box";return this._observers.has(r)||this._observers.set(r,new Gg(r)),this._observers.get(r).observe(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var he=D(6825);let Hg=(()=>{class n{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Zg=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({providers:[Hg]})}return n})();const Kg=["notch"],$g=["matFormFieldNotchedOutline",""],Wg=["*"],Yg=["textField"],Qg=["iconPrefixContainer"],Xg=["textPrefixContainer"];function Jg(n,e){1&n&&l._UZ(0,"span",19)}function ey(n,e){if(1&n&&(l.TgZ(0,"label",17),l.Hsn(1,1),l.YNc(2,Jg,1,0,"span",18),l.qZA()),2&n){const t=l.oxw(2);l.Q6J("floating",t._shouldLabelFloat())("monitorResize",t._hasOutline())("id",t._labelId),l.uIk("for",t._control.id),l.xp6(2),l.Q6J("ngIf",!t.hideRequiredMarker&&t._control.required)}}function ty(n,e){if(1&n&&l.YNc(0,ey,3,5,"label",16),2&n){const t=l.oxw();l.Q6J("ngIf",t._hasFloatingLabel())}}function ny(n,e){1&n&&l._UZ(0,"div",20)}function iy(n,e){}function ry(n,e){if(1&n&&l.YNc(0,iy,0,0,"ng-template",22),2&n){l.oxw(2);const t=l.MAs(1);l.Q6J("ngTemplateOutlet",t)}}function sy(n,e){if(1&n&&(l.TgZ(0,"div",21),l.YNc(1,ry,1,1,"ng-template",9),l.qZA()),2&n){const t=l.oxw();l.Q6J("matFormFieldNotchedOutlineOpen",t._shouldLabelFloat()),l.xp6(1),l.Q6J("ngIf",!t._forceDisplayInfixLabel())}}function oy(n,e){1&n&&(l.TgZ(0,"div",23,24),l.Hsn(2,2),l.qZA())}function ay(n,e){1&n&&(l.TgZ(0,"div",25,26),l.Hsn(2,3),l.qZA())}function ly(n,e){}function cy(n,e){if(1&n&&l.YNc(0,ly,0,0,"ng-template",22),2&n){l.oxw();const t=l.MAs(1);l.Q6J("ngTemplateOutlet",t)}}function dy(n,e){1&n&&(l.TgZ(0,"div",27),l.Hsn(1,4),l.qZA())}function uy(n,e){1&n&&(l.TgZ(0,"div",28),l.Hsn(1,5),l.qZA())}function hy(n,e){1&n&&l._UZ(0,"div",29)}function fy(n,e){if(1&n&&(l.TgZ(0,"div",30),l.Hsn(1,6),l.qZA()),2&n){const t=l.oxw();l.Q6J("@transitionMessages",t._subscriptAnimationState)}}function my(n,e){if(1&n&&(l.TgZ(0,"mat-hint",34),l._uU(1),l.qZA()),2&n){const t=l.oxw(2);l.Q6J("id",t._hintLabelId),l.xp6(1),l.Oqu(t.hintLabel)}}function py(n,e){if(1&n&&(l.TgZ(0,"div",31),l.YNc(1,my,2,2,"mat-hint",32),l.Hsn(2,7),l._UZ(3,"div",33),l.Hsn(4,8),l.qZA()),2&n){const t=l.oxw();l.Q6J("@transitionMessages",t._subscriptAnimationState),l.xp6(1),l.Q6J("ngIf",t.hintLabel)}}const _y=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],gy=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];let Ao=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=l.lG2({type:n,selectors:[["mat-label"]]})}return n})(),yy=0;const Sd=new l.OlP("MatError");let vy=(()=>{class n{constructor(t,i){this.id="mat-mdc-error-"+yy++,t||i.nativeElement.setAttribute("aria-live","polite")}static#e=this.\u0275fac=function(i){return new(i||n)(l.$8M("aria-live"),l.Y36(l.SBq))};static#t=this.\u0275dir=l.lG2({type:n,selectors:[["mat-error"],["","matError",""]],hostAttrs:["aria-atomic","true",1,"mat-mdc-form-field-error","mat-mdc-form-field-bottom-align"],hostVars:1,hostBindings:function(i,r){2&i&&l.Ikx("id",r.id)},inputs:{id:"id"},features:[l._Bn([{provide:Sd,useExisting:n}])]})}return n})(),xy=0,Rd=(()=>{class n{constructor(){this.align="start",this.id="mat-mdc-hint-"+xy++}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=l.lG2({type:n,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(i,r){2&i&&(l.Ikx("id",r.id),l.uIk("align",null),l.ekj("mat-mdc-form-field-hint-end","end"===r.align))},inputs:{align:"align",id:"id"}})}return n})();const by=new l.OlP("MatPrefix"),Ey=new l.OlP("MatSuffix"),Pd=new l.OlP("FloatingLabelParent");let Dd=(()=>{class n{get floating(){return this._floating}set floating(t){this._floating=t,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(t){this._monitorResize=t,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(t){this._elementRef=t,this._floating=!1,this._monitorResize=!1,this._resizeObserver=(0,l.f3M)(jg),this._ngZone=(0,l.f3M)(l.R0b),this._parent=(0,l.f3M)(Pd),this._resizeSubscription=new lt.w0}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return function wy(n){if(null!==n.offsetParent)return n.scrollWidth;const t=n.cloneNode(!0);t.style.setProperty("position","absolute"),t.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(t);const i=t.scrollWidth;return t.remove(),i}(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}static#e=this.\u0275fac=function(i){return new(i||n)(l.Y36(l.SBq))};static#t=this.\u0275dir=l.lG2({type:n,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(i,r){2&i&&l.ekj("mdc-floating-label--float-above",r.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"}})}return n})();const kd="mdc-line-ripple--active",Lr="mdc-line-ripple--deactivating";let Md=(()=>{class n{constructor(t,i){this._elementRef=t,this._handleTransitionEnd=r=>{const s=this._elementRef.nativeElement.classList,o=s.contains(Lr);"opacity"===r.propertyName&&o&&s.remove(kd,Lr)},i.runOutsideAngular(()=>{t.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){const t=this._elementRef.nativeElement.classList;t.remove(Lr),t.add(kd)}deactivate(){this._elementRef.nativeElement.classList.add(Lr)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}static#e=this.\u0275fac=function(i){return new(i||n)(l.Y36(l.SBq),l.Y36(l.R0b))};static#t=this.\u0275dir=l.lG2({type:n,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]})}return n})(),Fd=(()=>{class n{constructor(t,i){this._elementRef=t,this._ngZone=i,this.open=!1}ngAfterViewInit(){const t=this._elementRef.nativeElement.querySelector(".mdc-floating-label");t?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),"function"==typeof requestAnimationFrame&&(t.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>t.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(t){this._notch.nativeElement.style.width=this.open&&t?`calc(${t}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`:""}static#e=this.\u0275fac=function(i){return new(i||n)(l.Y36(l.SBq),l.Y36(l.R0b))};static#t=this.\u0275cmp=l.Xpm({type:n,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(i,r){if(1&i&&l.Gf(Kg,5),2&i){let s;l.iGM(s=l.CRH())&&(r._notch=s.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(i,r){2&i&&l.ekj("mdc-notched-outline--notched",r.open)},inputs:{open:["matFormFieldNotchedOutlineOpen","open"]},attrs:$g,ngContentSelectors:Wg,decls:5,vars:0,consts:[[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],["notch",""],[1,"mdc-notched-outline__trailing"]],template:function(i,r){1&i&&(l.F$t(),l._UZ(0,"div",0),l.TgZ(1,"div",1,2),l.Hsn(3),l.qZA(),l._UZ(4,"div",3))},encapsulation:2,changeDetection:0})}return n})();const Iy={transitionMessages:(0,he.X$)("transitionMessages",[(0,he.SB)("enter",(0,he.oB)({opacity:1,transform:"translateY(0%)"})),(0,he.eR)("void => enter",[(0,he.oB)({opacity:0,transform:"translateY(-5px)"}),(0,he.jt)("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let Co=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=l.lG2({type:n})}return n})();const So=new l.OlP("MatFormField"),Ty=new l.OlP("MAT_FORM_FIELD_DEFAULT_OPTIONS");let Od=0,Sy=(()=>{class n{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(t){this._hideRequiredMarker=Te(t)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||"auto"}set floatLabel(t){t!==this._floatLabel&&(this._floatLabel=t,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(t){const i=this._appearance;this._appearance=t||this._defaults?.appearance||"fill","outline"===this._appearance&&this._appearance!==i&&(this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||"fixed"}set subscriptSizing(t){this._subscriptSizing=t||this._defaults?.subscriptSizing||"fixed"}get hintLabel(){return this._hintLabel}set hintLabel(t){this._hintLabel=t,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(t){this._explicitFormFieldControl=t}constructor(t,i,r,s,o,a,c,d){this._elementRef=t,this._changeDetectorRef=i,this._ngZone=r,this._dir=s,this._platform=o,this._defaults=a,this._animationMode=c,this._hideRequiredMarker=!1,this.color="primary",this._appearance="fill",this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId="mat-mdc-form-field-label-"+Od++,this._hintLabelId="mat-mdc-hint-"+Od++,this._subscriptAnimationState="",this._destroyed=new ie.x,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,a&&(a.appearance&&(this.appearance=a.appearance),this._hideRequiredMarker=!!a?.hideRequiredMarker,a.color&&(this.color=a.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){const t=this._control;t.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${t.controlType}`),t.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),t.ngControl&&t.ngControl.valueChanges&&t.ngControl.valueChanges.pipe((0,Ge.R)(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(t=>!t._isText),this._hasTextPrefix=!!this._prefixChildren.find(t=>t._isText),this._hasIconSuffix=!!this._suffixChildren.find(t=>!t._isText),this._hasTextSuffix=!!this._suffixChildren.find(t=>t._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),(0,vi.T)(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||null===this._isFocused)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,Ge.R)(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe((0,Ge.R)(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return"always"===this.floatLabel}_hasOutline(){return"outline"===this.appearance}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(t){const i=this._control?this._control.ngControl:null;return i&&i[t]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){this._hasOutline()&&this._floatingLabel&&this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth()):this._notchedOutline?._setNotchWidth(0)}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_syncDescribedByIds(){if(this._control){let t=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&t.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const i=this._hintChildren?this._hintChildren.find(s=>"start"===s.align):null,r=this._hintChildren?this._hintChildren.find(s=>"end"===s.align):null;i?t.push(i.id):this._hintLabel&&t.push(this._hintLabelId),r&&t.push(r.id)}else this._errorChildren&&t.push(...this._errorChildren.map(i=>i.id));this._control.setDescribedByIds(t)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;const t=this._floatingLabel.element;if(!this._iconPrefixContainer&&!this._textPrefixContainer)return void(t.style.transform="");if(!this._isAttachedToDom())return void(this._needsOutlineLabelOffsetUpdateOnStable=!0);const i=this._iconPrefixContainer?.nativeElement,r=this._textPrefixContainer?.nativeElement,s=i?.getBoundingClientRect().width??0,o=r?.getBoundingClientRect().width??0;t.style.transform=`var(\n        --mat-mdc-form-field-label-transform,\n        translateY(-50%) translateX(calc(${"rtl"===this._dir.value?"-1":"1"} * (${s+o}px + var(--mat-mdc-form-field-label-offset-x, 0px))))\n    )`}_isAttachedToDom(){const t=this._elementRef.nativeElement;if(t.getRootNode){const i=t.getRootNode();return i&&i!==t}return document.documentElement.contains(t)}static#e=this.\u0275fac=function(i){return new(i||n)(l.Y36(l.SBq),l.Y36(l.sBO),l.Y36(l.R0b),l.Y36(Vr),l.Y36(Ke),l.Y36(Ty,8),l.Y36(l.QbO,8),l.Y36(G.K0))};static#t=this.\u0275cmp=l.Xpm({type:n,selectors:[["mat-form-field"]],contentQueries:function(i,r,s){if(1&i&&(l.Suo(s,Ao,5),l.Suo(s,Ao,7),l.Suo(s,Co,5),l.Suo(s,by,5),l.Suo(s,Ey,5),l.Suo(s,Sd,5),l.Suo(s,Rd,5)),2&i){let o;l.iGM(o=l.CRH())&&(r._labelChildNonStatic=o.first),l.iGM(o=l.CRH())&&(r._labelChildStatic=o.first),l.iGM(o=l.CRH())&&(r._formFieldControl=o.first),l.iGM(o=l.CRH())&&(r._prefixChildren=o),l.iGM(o=l.CRH())&&(r._suffixChildren=o),l.iGM(o=l.CRH())&&(r._errorChildren=o),l.iGM(o=l.CRH())&&(r._hintChildren=o)}},viewQuery:function(i,r){if(1&i&&(l.Gf(Yg,5),l.Gf(Qg,5),l.Gf(Xg,5),l.Gf(Dd,5),l.Gf(Fd,5),l.Gf(Md,5)),2&i){let s;l.iGM(s=l.CRH())&&(r._textField=s.first),l.iGM(s=l.CRH())&&(r._iconPrefixContainer=s.first),l.iGM(s=l.CRH())&&(r._textPrefixContainer=s.first),l.iGM(s=l.CRH())&&(r._floatingLabel=s.first),l.iGM(s=l.CRH())&&(r._notchedOutline=s.first),l.iGM(s=l.CRH())&&(r._lineRipple=s.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(i,r){2&i&&l.ekj("mat-mdc-form-field-label-always-float",r._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",r._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",r._hasIconSuffix)("mat-form-field-invalid",r._control.errorState)("mat-form-field-disabled",r._control.disabled)("mat-form-field-autofilled",r._control.autofilled)("mat-form-field-no-animations","NoopAnimations"===r._animationMode)("mat-form-field-appearance-fill","fill"==r.appearance)("mat-form-field-appearance-outline","outline"==r.appearance)("mat-form-field-hide-placeholder",r._hasFloatingLabel()&&!r._shouldLabelFloat())("mat-focused",r._control.focused)("mat-primary","accent"!==r.color&&"warn"!==r.color)("mat-accent","accent"===r.color)("mat-warn","warn"===r.color)("ng-untouched",r._shouldForward("untouched"))("ng-touched",r._shouldForward("touched"))("ng-pristine",r._shouldForward("pristine"))("ng-dirty",r._shouldForward("dirty"))("ng-valid",r._shouldForward("valid"))("ng-invalid",r._shouldForward("invalid"))("ng-pending",r._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[l._Bn([{provide:So,useExisting:n},{provide:Pd,useExisting:n}])],ngContentSelectors:gy,decls:18,vars:23,consts:[["labelTemplate",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],["textField",""],["class","mat-mdc-form-field-focus-overlay",4,"ngIf"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen",4,"ngIf"],["class","mat-mdc-form-field-icon-prefix",4,"ngIf"],["class","mat-mdc-form-field-text-prefix",4,"ngIf"],[1,"mat-mdc-form-field-infix"],[3,"ngIf"],["class","mat-mdc-form-field-text-suffix",4,"ngIf"],["class","mat-mdc-form-field-icon-suffix",4,"ngIf"],["matFormFieldLineRipple","",4,"ngIf"],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align",3,"ngSwitch"],["class","mat-mdc-form-field-error-wrapper",4,"ngSwitchCase"],["class","mat-mdc-form-field-hint-wrapper",4,"ngSwitchCase"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id",4,"ngIf"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true","class","mat-mdc-form-field-required-marker mdc-floating-label--required",4,"ngIf"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-focus-overlay"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-icon-prefix"],["iconPrefixContainer",""],[1,"mat-mdc-form-field-text-prefix"],["textPrefixContainer",""],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id",4,"ngIf"],[1,"mat-mdc-form-field-hint-spacer"],[3,"id"]],template:function(i,r){1&i&&(l.F$t(_y),l.YNc(0,ty,1,1,"ng-template",null,0,l.W1O),l.TgZ(2,"div",1,2),l.NdJ("click",function(o){return r._control.onContainerClick(o)}),l.YNc(4,ny,1,0,"div",3),l.TgZ(5,"div",4),l.YNc(6,sy,2,2,"div",5),l.YNc(7,oy,3,0,"div",6),l.YNc(8,ay,3,0,"div",7),l.TgZ(9,"div",8),l.YNc(10,cy,1,1,"ng-template",9),l.Hsn(11),l.qZA(),l.YNc(12,dy,2,0,"div",10),l.YNc(13,uy,2,0,"div",11),l.qZA(),l.YNc(14,hy,1,0,"div",12),l.qZA(),l.TgZ(15,"div",13),l.YNc(16,fy,2,1,"div",14),l.YNc(17,py,5,2,"div",15),l.qZA()),2&i&&(l.xp6(2),l.ekj("mdc-text-field--filled",!r._hasOutline())("mdc-text-field--outlined",r._hasOutline())("mdc-text-field--no-label",!r._hasFloatingLabel())("mdc-text-field--disabled",r._control.disabled)("mdc-text-field--invalid",r._control.errorState),l.xp6(2),l.Q6J("ngIf",!r._hasOutline()&&!r._control.disabled),l.xp6(2),l.Q6J("ngIf",r._hasOutline()),l.xp6(1),l.Q6J("ngIf",r._hasIconPrefix),l.xp6(1),l.Q6J("ngIf",r._hasTextPrefix),l.xp6(2),l.Q6J("ngIf",!r._hasOutline()||r._forceDisplayInfixLabel()),l.xp6(2),l.Q6J("ngIf",r._hasTextSuffix),l.xp6(1),l.Q6J("ngIf",r._hasIconSuffix),l.xp6(1),l.Q6J("ngIf",!r._hasOutline()),l.xp6(1),l.ekj("mat-mdc-form-field-subscript-dynamic-size","dynamic"===r.subscriptSizing),l.Q6J("ngSwitch",r._getDisplayedMessages()),l.xp6(1),l.Q6J("ngSwitchCase","error"),l.xp6(1),l.Q6J("ngSwitchCase","hint"))},dependencies:[G.O5,G.tP,G.RF,G.n9,Rd,Dd,Fd,Md],styles:['.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px, var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px, var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 96px / 0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px * 2)}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-text-field--filled{--mdc-filled-text-field-active-indicator-height:1px;--mdc-filled-text-field-focus-active-indicator-height:2px;--mdc-filled-text-field-container-shape:4px;border-top-left-radius:var(--mdc-filled-text-field-container-shape);border-top-right-radius:var(--mdc-filled-text-field-container-shape);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-caret-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-focus-label-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-focus-label-text-color)}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font);font-size:var(--mdc-filled-text-field-label-text-size);font-weight:var(--mdc-filled-text-field-label-text-weight);letter-spacing:var(--mdc-filled-text-field-label-text-tracking)}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color)}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color)}.mdc-text-field--filled .mdc-line-ripple::before{border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--outlined{--mdc-outlined-text-field-outline-width:1px;--mdc-outlined-text-field-focus-outline-width:2px;--mdc-outlined-text-field-container-shape:4px}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-caret-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-focus-label-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-focus-label-text-color)}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font);font-size:var(--mdc-outlined-text-field-label-text-size);font-weight:var(--mdc-outlined-text-field-label-text-weight);letter-spacing:var(--mdc-outlined-text-field-label-text-tracking)}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px, var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px, var(--mdc-outlined-text-field-container-shape))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px, calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px, var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px, calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px, var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px, var(--mdc-outlined-text-field-container-shape))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px, var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px, calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px, calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-hover-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-focus-outline-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-hover-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-focus-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font);line-height:var(--mat-form-field-container-text-line-height);font-size:var(--mat-form-field-container-text-size);letter-spacing:var(--mat-form-field-container-text-tracking);font-weight:var(--mat-form-field-container-text-weight)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size) * var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:12px;box-sizing:content-box}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[Iy.transitionMessages]},changeDetection:0})}return n})(),Br=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({imports:[Ye,G.ez,Zg,Ye]})}return n})();const Ry=new l.OlP("MAT_INPUT_VALUE_ACCESSOR"),Py=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let Dy=0;const ky=gd(class{constructor(n,e,t,i){this._defaultErrorStateMatcher=n,this._parentForm=e,this._parentFormGroup=t,this.ngControl=i,this.stateChanges=new ie.x}});let My=(()=>{class n extends ky{get disabled(){return this._disabled}set disabled(t){this._disabled=Te(t),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(t){this._id=t||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(N.kI.required)??!1}set required(t){this._required=Te(t)}get type(){return this._type}set type(t){this._type=t||"text",this._validateType(),!this._isTextarea&&td().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(t){t!==this.value&&(this._inputValueAccessor.value=t,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(t){this._readonly=Te(t)}constructor(t,i,r,s,o,a,c,d,u,h){super(a,s,o,r),this._elementRef=t,this._platform=i,this._autofillMonitor=d,this._formField=h,this._uid="mat-input-"+Dy++,this.focused=!1,this.stateChanges=new ie.x,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(g=>td().has(g)),this._iOSKeyupListener=g=>{const v=g.target;!v.value&&0===v.selectionStart&&0===v.selectionEnd&&(v.setSelectionRange(1,1),v.setSelectionRange(0,0))};const f=this._elementRef.nativeElement,m=f.nodeName.toLowerCase();this._inputValueAccessor=c||f,this._previousNativeValue=this.value,this.id=this.id,i.IOS&&u.runOutsideAngular(()=>{t.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===m,this._isTextarea="textarea"===m,this._isInFormField=!!h,this._isNativeSelect&&(this.controlType=f.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(t=>{this.autofilled=t.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),null!==this.ngControl.disabled&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(t){this._elementRef.nativeElement.focus(t)}_focusChanged(t){t!==this.focused&&(this.focused=t,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){const t=this._elementRef.nativeElement.value;this._previousNativeValue!==t&&(this._previousNativeValue=t,this.stateChanges.next())}_dirtyCheckPlaceholder(){const t=this._getPlaceholder();if(t!==this._previousPlaceholder){const i=this._elementRef.nativeElement;this._previousPlaceholder=t,t?i.setAttribute("placeholder",t):i.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){Py.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let t=this._elementRef.nativeElement.validity;return t&&t.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const t=this._elementRef.nativeElement,i=t.options[0];return this.focused||t.multiple||!this.empty||!!(t.selectedIndex>-1&&i&&i.label)}return this.focused||!this.empty}setDescribedByIds(t){t.length?this._elementRef.nativeElement.setAttribute("aria-describedby",t.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const t=this._elementRef.nativeElement;return this._isNativeSelect&&(t.multiple||t.size>1)}static#e=this.\u0275fac=function(i){return new(i||n)(l.Y36(l.SBq),l.Y36(Ke),l.Y36(N.a5,10),l.Y36(N.F,8),l.Y36(N.sg,8),l.Y36(yd),l.Y36(Ry,10),l.Y36(I_),l.Y36(l.R0b),l.Y36(So,8))};static#t=this.\u0275dir=l.lG2({type:n,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(i,r){1&i&&l.NdJ("focus",function(){return r._focusChanged(!0)})("blur",function(){return r._focusChanged(!1)})("input",function(){return r._onInput()}),2&i&&(l.Ikx("id",r.id)("disabled",r.disabled)("required",r.required),l.uIk("name",r.name||null)("readonly",r.readonly&&!r._isNativeSelect||null)("aria-invalid",r.empty&&r.required?null:r.errorState)("aria-required",r.required)("id",r.id),l.ekj("mat-input-server",r._isServer)("mat-mdc-form-field-textarea-control",r._isInFormField&&r._isTextarea)("mat-mdc-form-field-input-control",r._isInFormField)("mdc-text-field__input",r._isInFormField)("mat-mdc-native-select-inline",r._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[l._Bn([{provide:Co,useExisting:n}]),l.qOj,l.TTD]})}return n})(),Fy=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({imports:[Ye,Br,Br,T_,Ye]})}return n})();var Ro=D(2096),Ld=D(4829),Oy=D(1631),Vy=D(4266),Ht=D(4674),Ny=D(7400);const Ly=["addListener","removeListener"],By=["addEventListener","removeEventListener"],zy=["on","off"];function Po(n,e,t,i){if((0,Ht.m)(t)&&(i=t,t=void 0),i)return Po(n,e,t).pipe((0,Ny.Z)(i));const[r,s]=function Gy(n){return(0,Ht.m)(n.addEventListener)&&(0,Ht.m)(n.removeEventListener)}(n)?By.map(o=>a=>n[o](e,a,t)):function Uy(n){return(0,Ht.m)(n.addListener)&&(0,Ht.m)(n.removeListener)}(n)?Ly.map(Bd(n,e)):function qy(n){return(0,Ht.m)(n.on)&&(0,Ht.m)(n.off)}(n)?zy.map(Bd(n,e)):[];if(!r&&(0,Vy.z)(n))return(0,Oy.z)(o=>Po(o,e,t))((0,Ld.Xf)(n));if(!r)throw new TypeError("Invalid event target");return new xn.y(o=>{const a=(...c)=>o.next(1<c.length?c:c[0]);return r(a),()=>s(a)})}function Bd(n,e){return t=>i=>n[t](e,i)}var zd=D(1954);const xi={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=xi;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new lt.w0(()=>t?.(r))},requestAnimationFrame(...n){const{delegate:e}=xi;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=xi;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0};var Ud=D(2631);new class Hy extends Ud.v{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class jy extends zd.o{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=xi.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(xi.cancelAnimationFrame(t),e._scheduled=void 0)}});let Do,Ky=1;const zr={};function qd(n){return n in zr&&(delete zr[n],!0)}const $y={setImmediate(n){const e=Ky++;return zr[e]=!0,Do||(Do=Promise.resolve()),Do.then(()=>qd(e)&&n()),e},clearImmediate(n){qd(n)}},{setImmediate:Wy,clearImmediate:Yy}=$y,Ur={setImmediate(...n){const{delegate:e}=Ur;return(e?.setImmediate||Wy)(...n)},clearImmediate(n){const{delegate:e}=Ur;return(e?.clearImmediate||Yy)(n)},delegate:void 0};new class Xy extends Ud.v{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class Qy extends zd.o{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=Ur.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(Ur.clearImmediate(t),e._scheduled===t&&(e._scheduled=void 0))}});var tv=D(671);function Gd(n,e=Mr.z){return function ev(n){return(0,Fr.e)((e,t)=>{let i=!1,r=null,s=null,o=!1;const a=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const d=r;r=null,t.next(d)}o&&t.complete()},c=()=>{s=null,o&&t.complete()};e.subscribe((0,_i.x)(t,d=>{i=!0,r=d,s||(0,Ld.Xf)(n(d)).subscribe(s=(0,_i.x)(t,a,c))},()=>{o=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>function iv(n=0,e,t=Mr.P){let i=-1;return null!=e&&((0,tv.K)(e)?t=e:i=e),new xn.y(r=>{let s=function nv(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(n,e))}let sv=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new ie.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new xn.y(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(Gd(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):(0,Ro.of)()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe((0,ct.h)(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=hi(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Po(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(l.R0b),l.LFG(Ke),l.LFG(G.K0,8))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ko=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new ie.x,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(Gd(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(Ke),l.LFG(l.R0b),l.LFG(G.K0,8))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Mo=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({})}return n})(),jd=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({imports:[gi,Mo,gi,Mo]})}return n})();class Fo{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class lv extends Fo{constructor(e,t,i,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}}class Hd extends Fo{constructor(e,t,i,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class cv extends Fo{constructor(e){super(),this.element=e instanceof l.SBq?e.nativeElement:e}}class dv{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof lv?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof Hd?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof cv?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class uv extends dv{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=o=>{const a=o.element,c=this._document.createComment("dom-portal");a.parentNode.insertBefore(c,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{c.parentNode&&c.parentNode.replaceChild(a,c)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||l.zs3.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let hv=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({})}return n})();const Zd=b_();class fv{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=de(-this._previousScrollPosition.left),e.style.top=de(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),Zd&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),Zd&&(i.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class mv{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe((0,ct.h)(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class Kd{enable(){}disable(){}attach(){}}function Oo(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function $d(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class pv{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();Oo(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let _v=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new Kd,this.close=o=>new mv(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new fv(this._viewportRuler,this._document),this.reposition=o=>new pv(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(sv),l.LFG(ko),l.LFG(l.R0b),l.LFG(G.K0))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class Wd{constructor(e){if(this.scrollStrategy=new Kd,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class gv{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let Yd=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(G.K0))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),yv=(()=>{class n extends Yd{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(r)):a.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(G.K0),l.LFG(l.R0b,8))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),vv=(()=>{class n extends Yd{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=vo(s)},this._clickListener=s=>{const o=vo(s),a="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const c=this._attachedOverlays.slice();for(let d=c.length-1;d>-1;d--){const u=c[d];if(u._outsidePointerEvents.observers.length<1||!u.hasAttached())continue;if(u.overlayElement.contains(o)||u.overlayElement.contains(a))break;const h=u._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>h.next(s)):h.next(s)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(G.K0),l.LFG(Ke),l.LFG(l.R0b,8))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Qd=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||xo()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(t),xo()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(G.K0),l.LFG(Ke))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class xv{constructor(e,t,i,r,s,o,a,c,d,u=!1){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=c,this._outsideClickDispatcher=d,this._animationsDisabled=u,this._backdropElement=null,this._backdropClick=new ie.x,this._attachments=new ie.x,this._detachments=new ie.x,this._locationChanges=lt.w0.EMPTY,this._backdropClickHandler=h=>this._backdropClick.next(h),this._backdropTransitionendHandler=h=>{this._disposeBackdrop(h.target)},this._keydownEvents=new ie.x,this._outsidePointerEvents=new ie.x,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe((0,Or.q)(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=de(this._config.width),e.height=de(this._config.height),e.minWidth=de(this._config.minWidth),e.minHeight=de(this._config.minHeight),e.maxWidth=de(this._config.maxWidth),e.maxHeight=de(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){const r=Dr(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe((0,Ge.R)((0,vi.T)(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const Xd="cdk-overlay-connected-position-bounding-box",bv=/([A-Za-z%]+)$/;class Ev{get positions(){return this._preferredPositions}constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new ie.x,this._resizeSubscription=lt.w0.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(Xd),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let o;for(let a of this._preferredPositions){let c=this._getOriginPoint(e,r,a),d=this._getOverlayPoint(c,t,a),u=this._getOverlayFit(d,t,i,a);if(u.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,c);this._canFitWithFlexibleDimensions(u,d,i)?s.push({position:a,origin:c,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(c,a)}):(!o||o.overlayFit.visibleArea<u.visibleArea)&&(o={overlayFit:u,overlayPoint:d,originPoint:c,position:a,overlayRect:t})}if(s.length){let a=null,c=-1;for(const d of s){const u=d.boundingBoxRect.width*d.boundingBoxRect.height*(d.position.weight||1);u>c&&(c=u,a=d)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Zt(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Xd),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r,s;if("center"==i.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r="start"==i.originX?o:a}return t.left<0&&(r-=t.left),s="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=eu(t);let{x:o,y:a}=e,c=this._getOffset(r,"x"),d=this._getOffset(r,"y");c&&(o+=c),d&&(a+=d);let f=0-a,m=a+s.height-i.height,g=this._subtractOverflows(s.width,0-o,o+s.width-i.width),v=this._subtractOverflows(s.height,f,m),b=g*v;return{visibleArea:b,isCompletelyWithinViewport:s.width*s.height===b,fitsInViewportVertically:v===s.height,fitsInViewportHorizontally:g==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,o=Jd(this._overlayRef.getConfig().minHeight),a=Jd(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=o&&o<=r)&&(e.fitsInViewportHorizontally||null!=a&&a<=s)}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=eu(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),c=Math.max(s.top-i.top-e.y,0),d=Math.max(s.left-i.left-e.x,0);let u=0,h=0;return u=r.width<=s.width?d||-o:e.x<this._viewportMargin?s.left-i.left-e.x:0,h=r.height<=s.height?c||-a:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:u,y:h},{x:e.x+u,y:e.y+h}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new gv(e,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,o,a,u,h,f;if("top"===t.overlayY)o=e.y,s=i.height-o+this._viewportMargin;else if("bottom"===t.overlayY)a=i.height-e.y+2*this._viewportMargin,s=i.height-a+this._viewportMargin;else{const m=Math.min(i.bottom-e.y+i.top,e.y),g=this._lastBoundingBoxSize.height;s=2*m,o=e.y-m,s>g&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-g/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)f=i.width-e.x+this._viewportMargin,u=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)h=e.x,u=i.right-e.x;else{const m=Math.min(i.right-e.x+i.left,e.x),g=this._lastBoundingBoxSize.width;u=2*m,h=e.x-m,u>g&&!this._isInitialRender&&!this._growAfterOpen&&(h=e.x-g/2)}return{top:o,left:h,bottom:a,right:f,width:u,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=de(i.height),r.top=de(i.top),r.bottom=de(i.bottom),r.width=de(i.width),r.left=de(i.left),r.right=de(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=de(s)),o&&(r.maxWidth=de(o))}this._lastBoundingBoxSize=i,Zt(this._boundingBox.style,r)}_resetBoundingBoxStyles(){Zt(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Zt(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const u=this._viewportRuler.getViewportScrollPosition();Zt(i,this._getExactOverlayY(t,e,u)),Zt(i,this._getExactOverlayX(t,e,u))}else i.position="static";let a="",c=this._getOffset(t,"x"),d=this._getOffset(t,"y");c&&(a+=`translateX(${c}px) `),d&&(a+=`translateY(${d}px)`),i.transform=a.trim(),o.maxHeight&&(r?i.maxHeight=de(o.maxHeight):s&&(i.maxHeight="")),o.maxWidth&&(r?i.maxWidth=de(o.maxWidth):s&&(i.maxWidth="")),Zt(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=de(s.y),r}_getExactOverlayX(e,t,i){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=de(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:$d(e,i),isOriginOutsideView:Oo(e,i),isOverlayClipped:$d(t,i),isOverlayOutsideView:Oo(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&Dr(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof l.SBq)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function Zt(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function Jd(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(bv);return t&&"px"!==t?null:parseFloat(e)}return n||null}function eu(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const tu="cdk-global-overlay-wrapper";class wv{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(tu),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=i,c=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),d=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a),u=this._xPosition,h=this._xOffset,f="rtl"===this._overlayRef.getConfig().direction;let m="",g="",v="";c?v="flex-start":"center"===u?(v="center",f?g=h:m=h):f?"left"===u||"end"===u?(v="flex-end",m=h):("right"===u||"start"===u)&&(v="flex-start",g=h):"left"===u||"start"===u?(v="flex-start",m=h):("right"===u||"end"===u)&&(v="flex-end",g=h),e.position=this._cssPosition,e.marginLeft=c?"0":m,e.marginTop=d?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=c?"0":g,t.justifyContent=v,t.alignItems=d?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(tu),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let Iv=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new wv}flexibleConnectedTo(t){return new Ev(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(ko),l.LFG(G.K0),l.LFG(Ke),l.LFG(Qd))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Tv=0,qr=(()=>{class n{constructor(t,i,r,s,o,a,c,d,u,h,f,m){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=c,this._document=d,this._directionality=u,this._location=h,this._outsideClickDispatcher=f,this._animationsModuleType=m}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),o=new Wd(t);return o.direction=o.direction||this._directionality.value,new xv(s,i,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+Tv++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(l.z2F)),new uv(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(_v),l.LFG(Qd),l.LFG(l._Vd),l.LFG(Iv),l.LFG(yv),l.LFG(l.zs3),l.LFG(l.R0b),l.LFG(G.K0),l.LFG(Vr),l.LFG(G.Ye),l.LFG(vv),l.LFG(l.QbO,8))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Av=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],nu=new l.OlP("cdk-connected-overlay-scroll-strategy");let Vo=(()=>{class n{constructor(t){this.elementRef=t}static#e=this.\u0275fac=function(i){return new(i||n)(l.Y36(l.SBq))};static#t=this.\u0275dir=l.lG2({type:n,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0})}return n})(),iu=(()=>{class n{get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(t){this._hasBackdrop=Te(t)}get lockPosition(){return this._lockPosition}set lockPosition(t){this._lockPosition=Te(t)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(t){this._flexibleDimensions=Te(t)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(t){this._growAfterOpen=Te(t)}get push(){return this._push}set push(t){this._push=Te(t)}constructor(t,i,r,s,o){this._overlay=t,this._dir=o,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=lt.w0.EMPTY,this._attachSubscription=lt.w0.EMPTY,this._detachSubscription=lt.w0.EMPTY,this._positionSubscription=lt.w0.EMPTY,this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.backdropClick=new l.vpe,this.positionChange=new l.vpe,this.attach=new l.vpe,this.detach=new l.vpe,this.overlayKeydown=new l.vpe,this.overlayOutsideClick=new l.vpe,this._templatePortal=new Hd(i,r),this._scrollStrategyFactory=s,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(t){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),t.origin&&this.open&&this._position.apply()),t.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=Av);const t=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=t.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=t.detachments().subscribe(()=>this.detach.emit()),t.keydownEvents().subscribe(i=>{this.overlayKeydown.next(i),27===i.keyCode&&!this.disableClose&&!pi(i)&&(i.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(i=>{this.overlayOutsideClick.next(i)})}_buildConfig(){const t=this._position=this.positionStrategy||this._createPositionStrategy(),i=new Wd({direction:this._dir,positionStrategy:t,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(i.width=this.width),(this.height||0===this.height)&&(i.height=this.height),(this.minWidth||0===this.minWidth)&&(i.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(i.minHeight=this.minHeight),this.backdropClass&&(i.backdropClass=this.backdropClass),this.panelClass&&(i.panelClass=this.panelClass),i}_updatePositionStrategy(t){const i=this.positions.map(r=>({originX:r.originX,originY:r.originY,overlayX:r.overlayX,overlayY:r.overlayY,offsetX:r.offsetX||this.offsetX,offsetY:r.offsetY||this.offsetY,panelClass:r.panelClass||void 0}));return t.setOrigin(this._getFlexibleConnectedPositionStrategyOrigin()).withPositions(i).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const t=this._overlay.position().flexibleConnectedTo(this._getFlexibleConnectedPositionStrategyOrigin());return this._updatePositionStrategy(t),t}_getFlexibleConnectedPositionStrategyOrigin(){return this.origin instanceof Vo?this.origin.elementRef:this.origin}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(t=>{this.backdropClick.emit(t)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(function av(n,e=!1){return(0,Fr.e)((t,i)=>{let r=0;t.subscribe((0,_i.x)(i,s=>{const o=n(s,r++);(o||e)&&i.next(s),!o&&i.complete()}))})}(()=>this.positionChange.observers.length>0)).subscribe(t=>{this.positionChange.emit(t),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)(l.Y36(qr),l.Y36(l.Rgc),l.Y36(l.s_b),l.Y36(nu),l.Y36(Vr,8))};static#t=this.\u0275dir=l.lG2({type:n,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:["cdkConnectedOverlayOrigin","origin"],positions:["cdkConnectedOverlayPositions","positions"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:["cdkConnectedOverlayOpen","open"],disableClose:["cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[l.TTD]})}return n})();const Sv={provide:nu,deps:[qr],useFactory:function Cv(n){return()=>n.scrollStrategies.reposition()}};let Rv=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({providers:[qr,Sv],imports:[gi,hv,jd,jd]})}return n})();class Pv{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(e=!1,t,i=!0,r){this._multiple=e,this._emitChanges=i,this.compareWith=r,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new ie.x,t&&t.length&&(e?t.forEach(s=>this._markSelected(s)):this._markSelected(t[0]),this._selectedToEmit.length=0)}select(...e){this._verifyValueAssignment(e),e.forEach(i=>this._markSelected(i));const t=this._hasQueuedChanges();return this._emitChangeEvent(),t}deselect(...e){this._verifyValueAssignment(e),e.forEach(i=>this._unmarkSelected(i));const t=this._hasQueuedChanges();return this._emitChangeEvent(),t}setSelection(...e){this._verifyValueAssignment(e);const t=this.selected,i=new Set(e);e.forEach(s=>this._markSelected(s)),t.filter(s=>!i.has(s)).forEach(s=>this._unmarkSelected(s));const r=this._hasQueuedChanges();return this._emitChangeEvent(),r}toggle(e){return this.isSelected(e)?this.deselect(e):this.select(e)}clear(e=!0){this._unmarkAll();const t=this._hasQueuedChanges();return e&&this._emitChangeEvent(),t}isSelected(e){return this._selection.has(this._getConcreteValue(e))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(e){this._multiple&&this.selected&&this._selected.sort(e)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(e){e=this._getConcreteValue(e),this.isSelected(e)||(this._multiple||this._unmarkAll(),this.isSelected(e)||this._selection.add(e),this._emitChanges&&this._selectedToEmit.push(e))}_unmarkSelected(e){e=this._getConcreteValue(e),this.isSelected(e)&&(this._selection.delete(e),this._emitChanges&&this._deselectedToEmit.push(e))}_unmarkAll(){this.isEmpty()||this._selection.forEach(e=>this._unmarkSelected(e))}_verifyValueAssignment(e){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(e){if(this.compareWith){for(let t of this._selection)if(this.compareWith(e,t))return t;return e}return e}}var Dv=D(4911),ru=D(4664),su=D(3997);const kv=["trigger"],Mv=["panel"];function Fv(n,e){if(1&n&&(l.TgZ(0,"span",10),l._uU(1),l.qZA()),2&n){const t=l.oxw();l.xp6(1),l.Oqu(t.placeholder)}}function Ov(n,e){if(1&n&&(l.TgZ(0,"span",14),l._uU(1),l.qZA()),2&n){const t=l.oxw(2);l.xp6(1),l.Oqu(t.triggerValue)}}function Vv(n,e){1&n&&l.Hsn(0,0,["*ngSwitchCase","true"])}function Nv(n,e){if(1&n&&(l.TgZ(0,"span",11),l.YNc(1,Ov,2,1,"span",12),l.YNc(2,Vv,1,0,"ng-content",13),l.qZA()),2&n){const t=l.oxw();l.Q6J("ngSwitch",!!t.customTrigger),l.xp6(2),l.Q6J("ngSwitchCase",!0)}}function Lv(n,e){if(1&n){const t=l.EpF();l.O4$(),l.kcU(),l.TgZ(0,"div",15,16),l.NdJ("@transformPanel.done",function(r){l.CHM(t);const s=l.oxw();return l.KtG(s._panelDoneAnimatingStream.next(r.toState))})("keydown",function(r){l.CHM(t);const s=l.oxw();return l.KtG(s._handleKeydown(r))}),l.Hsn(2,1),l.qZA()}if(2&n){const t=l.oxw();l.Gre("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",t._getPanelTheme(),""),l.Q6J("ngClass",t.panelClass)("@transformPanel","showing"),l.uIk("id",t.id+"-panel")("aria-multiselectable",t.multiple)("aria-label",t.ariaLabel||null)("aria-labelledby",t._getPanelAriaLabelledby())}}const Bv=[[["mat-select-trigger"]],"*"],zv=["mat-select-trigger","*"],Uv={transformPanelWrap:(0,he.X$)("transformPanelWrap",[(0,he.eR)("* => void",(0,he.IO)("@transformPanel",[(0,he.pV)()],{optional:!0}))]),transformPanel:(0,he.X$)("transformPanel",[(0,he.SB)("void",(0,he.oB)({opacity:0,transform:"scale(1, 0.8)"})),(0,he.eR)("void => showing",(0,he.jt)("120ms cubic-bezier(0, 0, 0.2, 1)",(0,he.oB)({opacity:1,transform:"scale(1, 1)"}))),(0,he.eR)("* => void",(0,he.jt)("100ms linear",(0,he.oB)({opacity:0})))])};let ou=0;const au=new l.OlP("mat-select-scroll-strategy"),Gv=new l.OlP("MAT_SELECT_CONFIG"),jv={provide:au,deps:[qr],useFactory:function qv(n){return()=>n.scrollStrategies.reposition()}},Hv=new l.OlP("MatSelectTrigger");class Zv{constructor(e,t){this.source=e,this.value=t}}const Kv=Tg(Ag(Ig(gd(class{constructor(n,e,t,i,r){this._elementRef=n,this._defaultErrorStateMatcher=e,this._parentForm=t,this._parentFormGroup=i,this.ngControl=r,this.stateChanges=new ie.x}}))));let $v=(()=>{class n extends Kv{get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(t){this._placeholder=t,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(N.kI.required)??!1}set required(t){this._required=Te(t),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(t){this._multiple=Te(t)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(t){this._disableOptionCentering=Te(t)}get compareWith(){return this._compareWith}set compareWith(t){this._compareWith=t,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(t){this._assignValue(t)&&this._onChange(t)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(t){this._typeaheadDebounceInterval=Jc(t)}get id(){return this._id}set id(t){this._id=t||this._uid,this.stateChanges.next()}constructor(t,i,r,s,o,a,c,d,u,h,f,m,g,v){super(o,s,c,d,h),this._viewportRuler=t,this._changeDetectorRef=i,this._ngZone=r,this._dir=a,this._parentFormField=u,this._liveAnnouncer=g,this._defaultOptions=v,this._panelOpen=!1,this._compareWith=(b,C)=>b===C,this._uid="mat-select-"+ou++,this._triggerAriaLabelledBy=null,this._destroy=new ie.x,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+ou++,this._panelDoneAnimatingStream=new ie.x,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this._multiple=!1,this._disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.optionSelectionChanges=(0,Dv.P)(()=>{const b=this.options;return b?b.changes.pipe((0,bn.O)(b),(0,ru.w)(()=>(0,vi.T)(...b.map(C=>C.onSelectionChange)))):this._ngZone.onStable.pipe((0,Or.q)(1),(0,ru.w)(()=>this.optionSelectionChanges))}),this.openedChange=new l.vpe,this._openedStream=this.openedChange.pipe((0,ct.h)(b=>b),(0,De.U)(()=>{})),this._closedStream=this.openedChange.pipe((0,ct.h)(b=>!b),(0,De.U)(()=>{})),this.selectionChange=new l.vpe,this.valueChange=new l.vpe,this._trackedModal=null,this.ngControl&&(this.ngControl.valueAccessor=this),null!=v?.typeaheadDebounceInterval&&(this._typeaheadDebounceInterval=v.typeaheadDebounceInterval),this._scrollStrategyFactory=m,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(f)||0,this.id=this.id}ngOnInit(){this._selectionModel=new Pv(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe((0,su.x)(),(0,Ge.R)(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen))}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe((0,Ge.R)(this._destroy)).subscribe(t=>{t.added.forEach(i=>i.select()),t.removed.forEach(i=>i.deselect())}),this.options.changes.pipe((0,bn.O)(null),(0,Ge.R)(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const t=this._getTriggerAriaLabelledby(),i=this.ngControl;if(t!==this._triggerAriaLabelledBy){const r=this._elementRef.nativeElement;this._triggerAriaLabelledBy=t,t?r.setAttribute("aria-labelledby",t):r.removeAttribute("aria-labelledby")}i&&(this._previousControl!==i.control&&(void 0!==this._previousControl&&null!==i.disabled&&i.disabled!==this.disabled&&(this.disabled=i.disabled),this._previousControl=i.control),this.updateErrorState())}ngOnChanges(t){(t.disabled||t.userAriaDescribedBy)&&this.stateChanges.next(),t.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._clearFromModal()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._applyModalPanelOwnership(),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())}_applyModalPanelOwnership(){const t=this._elementRef.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!t)return;const i=`${this.id}-panel`;this._trackedModal&&dd(this._trackedModal,"aria-owns",i),function $_(n,e,t){const i=ud(n,e);i.some(r=>r.trim()==t.trim())||(i.push(t.trim()),n.setAttribute(e,i.join(" ")))}(t,"aria-owns",i),this._trackedModal=t}_clearFromModal(){this._trackedModal&&(dd(this._trackedModal,"aria-owns",`${this.id}-panel`),this._trackedModal=null)}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(t){this._assignValue(t)}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const t=this._selectionModel.selected.map(i=>i.viewValue);return this._isRtl()&&t.reverse(),t.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(t){this.disabled||(this.panelOpen?this._handleOpenKeydown(t):this._handleClosedKeydown(t))}_handleClosedKeydown(t){const i=t.keyCode,r=40===i||38===i||37===i||39===i,s=13===i||32===i,o=this._keyManager;if(!o.isTyping()&&s&&!pi(t)||(this.multiple||t.altKey)&&r)t.preventDefault(),this.open();else if(!this.multiple){const a=this.selected;o.onKeydown(t);const c=this.selected;c&&a!==c&&this._liveAnnouncer.announce(c.viewValue,1e4)}}_handleOpenKeydown(t){const i=this._keyManager,r=t.keyCode,s=40===r||38===r,o=i.isTyping();if(s&&t.altKey)t.preventDefault(),this.close();else if(o||13!==r&&32!==r||!i.activeItem||pi(t))if(!o&&this._multiple&&65===r&&t.ctrlKey){t.preventDefault();const a=this.options.some(c=>!c.disabled&&!c.selected);this.options.forEach(c=>{c.disabled||(a?c.select():c.deselect())})}else{const a=i.activeItemIndex;i.onKeydown(t),this._multiple&&s&&t.shiftKey&&i.activeItem&&i.activeItemIndex!==a&&i.activeItem._selectViaInteraction()}else t.preventDefault(),i.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe((0,Or.q)(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(t){if(this.options.forEach(i=>i.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&t)Array.isArray(t),t.forEach(i=>this._selectOptionByValue(i)),this._sortValues();else{const i=this._selectOptionByValue(t);i?this._keyManager.updateActiveItem(i):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(t){const i=this.options.find(r=>{if(this._selectionModel.isSelected(r))return!1;try{return null!=r.value&&this._compareWith(r.value,t)}catch{return!1}});return i&&this._selectionModel.select(i),i}_assignValue(t){return!!(t!==this._value||this._multiple&&Array.isArray(t))&&(this.options&&this._setSelectionByValue(t),this._value=t,!0)}_skipPredicate(t){return t.disabled}_initKeyManager(){this._keyManager=new X_(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]).skipPredicate(this._skipPredicate),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const t=(0,vi.T)(this.options.changes,this._destroy);this.optionSelectionChanges.pipe((0,Ge.R)(t)).subscribe(i=>{this._onSelect(i.source,i.isUserInput),i.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),(0,vi.T)(...this.options.map(i=>i._stateChanges)).pipe((0,Ge.R)(t)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(t,i){const r=this._selectionModel.isSelected(t);null!=t.value||this._multiple?(r!==t.selected&&(t.selected?this._selectionModel.select(t):this._selectionModel.deselect(t)),i&&this._keyManager.setActiveItem(t),this.multiple&&(this._sortValues(),i&&this.focus())):(t.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(t.value)),r!==this._selectionModel.isSelected(t)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const t=this.options.toArray();this._selectionModel.sort((i,r)=>this.sortComparator?this.sortComparator(i,r,t):t.indexOf(i)-t.indexOf(r)),this.stateChanges.next()}}_propagateChanges(t){let i=null;i=this.multiple?this.selected.map(r=>r.value):this.selected?this.selected.value:t,this._value=i,this.valueChange.emit(i),this._onChange(i),this.selectionChange.emit(this._getChangeEvent(i)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){if(this._keyManager)if(this.empty){let t=-1;for(let i=0;i<this.options.length;i++)if(!this.options.get(i).disabled){t=i;break}this._keyManager.setActiveItem(t)}else this._keyManager.setActiveItem(this._selectionModel.selected[0])}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(t){this._elementRef.nativeElement.focus(t)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const t=this._parentFormField?.getLabelId();return this.ariaLabelledby?(t?t+" ":"")+this.ariaLabelledby:t}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;const t=this._parentFormField?.getLabelId();let i=(t?t+" ":"")+this._valueId;return this.ariaLabelledby&&(i+=" "+this.ariaLabelledby),i}_panelDoneAnimating(t){this.openedChange.emit(t)}setDescribedByIds(t){t.length?this._elementRef.nativeElement.setAttribute("aria-describedby",t.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty||this._focused&&!!this._placeholder}static#e=this.\u0275fac=function(i){return new(i||n)(l.Y36(ko),l.Y36(l.sBO),l.Y36(l.R0b),l.Y36(yd),l.Y36(l.SBq),l.Y36(Vr,8),l.Y36(N.F,8),l.Y36(N.sg,8),l.Y36(So,8),l.Y36(N.a5,10),l.$8M("tabindex"),l.Y36(au),l.Y36(dg),l.Y36(Gv,8))};static#t=this.\u0275dir=l.lG2({type:n,viewQuery:function(i,r){if(1&i&&(l.Gf(kv,5),l.Gf(Mv,5),l.Gf(iu,5)),2&i){let s;l.iGM(s=l.CRH())&&(r.trigger=s.first),l.iGM(s=l.CRH())&&(r.panel=s.first),l.iGM(s=l.CRH())&&(r._overlayDir=s.first)}},inputs:{userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",placeholder:"placeholder",required:"required",multiple:"multiple",disableOptionCentering:"disableOptionCentering",compareWith:"compareWith",value:"value",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:"typeaheadDebounceInterval",sortComparator:"sortComparator",id:"id"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},features:[l.qOj,l.TTD]})}return n})(),Wv=(()=>{class n extends $v{constructor(){super(...arguments),this.panelWidth=this._defaultOptions&&typeof this._defaultOptions.panelWidth<"u"?this._defaultOptions.panelWidth:"auto",this._positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}],this._hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1,this._skipPredicate=t=>!this.panelOpen&&t.disabled}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}ngOnInit(){super.ngOnInit(),this._viewportRuler.change().pipe((0,Ge.R)(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._changeDetectorRef.detectChanges())})}open(){this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin()),this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),super.open(),this.stateChanges.next()}close(){super.close(),this.stateChanges.next()}_scrollOptionIntoView(t){const i=this.options.toArray()[t];if(i){const r=this.panel.nativeElement,s=function zg(n,e,t){if(t.length){let i=e.toArray(),r=t.toArray(),s=0;for(let o=0;o<n+1;o++)i[o].group&&i[o].group===r[s]&&s++;return s}return 0}(t,this.options,this.optionGroups),o=i._getHostElement();r.scrollTop=0===t&&1===s?0:function Ug(n,e,t,i){return n<t?n:n+e>t+i?Math.max(0,n-i+e):t}(o.offsetTop,o.offsetHeight,r.scrollTop,r.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(t){return new Zv(this,t)}_getOverlayWidth(t){return"auto"===this.panelWidth?(t instanceof Vo?t.elementRef:t||this._elementRef).nativeElement.getBoundingClientRect().width:null===this.panelWidth?"":this.panelWidth}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(t){this._hideSingleSelectionIndicator=Te(t),this._syncParentProperties()}_syncParentProperties(){if(this.options)for(const t of this.options)t._changeDetectorRef.markForCheck()}static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=l.n5z(n)))(r||n)}}();static#t=this.\u0275cmp=l.Xpm({type:n,selectors:[["mat-select"]],contentQueries:function(i,r,s){if(1&i&&(l.Suo(s,Hv,5),l.Suo(s,Ad,5),l.Suo(s,Td,5)),2&i){let o;l.iGM(o=l.CRH())&&(r.customTrigger=o.first),l.iGM(o=l.CRH())&&(r.options=o),l.iGM(o=l.CRH())&&(r.optionGroups=o)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","listbox","ngSkipHydration","",1,"mat-mdc-select"],hostVars:19,hostBindings:function(i,r){1&i&&l.NdJ("keydown",function(o){return r._handleKeydown(o)})("focus",function(){return r._onFocus()})("blur",function(){return r._onBlur()}),2&i&&(l.uIk("id",r.id)("tabindex",r.tabIndex)("aria-controls",r.panelOpen?r.id+"-panel":null)("aria-expanded",r.panelOpen)("aria-label",r.ariaLabel||null)("aria-required",r.required.toString())("aria-disabled",r.disabled.toString())("aria-invalid",r.errorState)("aria-activedescendant",r._getAriaActiveDescendant()),l.ekj("mat-mdc-select-disabled",r.disabled)("mat-mdc-select-invalid",r.errorState)("mat-mdc-select-required",r.required)("mat-mdc-select-empty",r.empty)("mat-mdc-select-multiple",r.multiple))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",panelWidth:"panelWidth",hideSingleSelectionIndicator:"hideSingleSelectionIndicator"},exportAs:["matSelect"],features:[l._Bn([{provide:Co,useExisting:n},{provide:Id,useExisting:n}]),l.qOj],ngContentSelectors:zv,decls:11,vars:10,consts:[["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],[1,"mat-mdc-select-value",3,"ngSwitch"],["class","mat-mdc-select-placeholder mat-mdc-select-min-line",4,"ngSwitchCase"],["class","mat-mdc-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false","aria-hidden","true"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth","backdropClick","attach","detach"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text",3,"ngSwitch"],["class","mat-mdc-select-min-line",4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"ngClass","keydown"],["panel",""]],template:function(i,r){if(1&i&&(l.F$t(Bv),l.TgZ(0,"div",0,1),l.NdJ("click",function(){return r.toggle()}),l.TgZ(3,"div",2),l.YNc(4,Fv,2,1,"span",3),l.YNc(5,Nv,3,2,"span",4),l.qZA(),l.TgZ(6,"div",5)(7,"div",6),l.O4$(),l.TgZ(8,"svg",7),l._UZ(9,"path",8),l.qZA()()()(),l.YNc(10,Lv,3,9,"ng-template",9),l.NdJ("backdropClick",function(){return r.close()})("attach",function(){return r._onAttached()})("detach",function(){return r.close()})),2&i){const s=l.MAs(1);l.xp6(3),l.Q6J("ngSwitch",r.empty),l.uIk("id",r._valueId),l.xp6(1),l.Q6J("ngSwitchCase",!0),l.xp6(1),l.Q6J("ngSwitchCase",!1),l.xp6(5),l.Q6J("cdkConnectedOverlayPanelClass",r._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",r._scrollStrategy)("cdkConnectedOverlayOrigin",r._preferredOverlayOrigin||s)("cdkConnectedOverlayOpen",r.panelOpen)("cdkConnectedOverlayPositions",r._positions)("cdkConnectedOverlayWidth",r._overlayWidth)}},dependencies:[G.mk,G.RF,G.n9,G.ED,iu,Vo],styles:['.mat-mdc-select{display:inline-block;width:100%;outline:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-select-enabled-trigger-text-color);font-family:var(--mat-select-trigger-text-font);line-height:var(--mat-select-trigger-text-line-height);font-size:var(--mat-select-trigger-text-size);font-weight:var(--mat-select-trigger-text-weight);letter-spacing:var(--mat-select-trigger-text-tracking)}.mat-mdc-select-disabled{color:var(--mat-select-disabled-trigger-text-color)}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:translateY(-8px)}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-select-arrow{width:10px;height:5px;position:relative;color:var(--mat-select-enabled-arrow-color)}.mat-mdc-form-field.mat-focused .mat-mdc-select-arrow{color:var(--mat-select-focused-arrow-color)}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-invalid .mat-mdc-select-arrow{color:var(--mat-select-invalid-arrow-color)}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-disabled .mat-mdc-select-arrow{color:var(--mat-select-disabled-arrow-color)}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:GrayText}div.mat-mdc-select-panel{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12);width:100%;max-height:275px;outline:0;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-select-panel-background-color)}.cdk-high-contrast-active div.mat-mdc-select-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) div.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above div.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);color:var(--mat-select-placeholder-text-color)}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper{cursor:pointer}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}'],encapsulation:2,data:{animation:[Uv.transformPanel]},changeDetection:0})}return n})(),Yv=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=l.oAB({type:n});static#n=this.\u0275inj=l.cJS({providers:[jv],imports:[G.ez,Rv,Cd,Ye,Mo,Br,Cd,Ye]})}return n})();var lu=D(9862);let cu=(()=>{class n{constructor(t){this.http=t,this.apiUrl="https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent",this.apiKey="AIzaSyC_L958W5m-lKzjmHsBiUsg8vg0UuW78Ic"}generateContent(t){const i=(new lu.WM).set("Content-Type","application/json").set("x-goog-api-key",this.apiKey);return this.http.post(this.apiUrl,{contents:[{role:"user",parts:[{text:t}]}]},{headers:i})}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(lu.eN))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var du=D(872),Be=D(8326),Gr=D(7217),bt=D(981),jr=D(2459);function No(){return(0,Fr.e)((n,e)=>{let t,i=!1;n.subscribe((0,_i.x)(e,r=>{const s=t;t=r,i&&e.next([s,r]),i=!0}))})}var T,Lo=D(6699),Qv=(D(6365),D(3106)),y=D(5861),Hr=D(534),uu=D(4537),Qe=D(7879),j=D(9058),Xv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$e={},Bo=Bo||{},F=Xv||self;function Zr(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function bi(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var zo="closure_uid_"+(1e9*Math.random()>>>0),ex=0;function tx(n,e,t){return n.call.apply(n.bind,arguments)}function nx(n,e,t){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),n.apply(e,r)}}return function(){return n.apply(e,arguments)}}function Ae(n,e,t){return(Ae=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?tx:nx).apply(null,arguments)}function Kr(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var i=t.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function pe(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(i,r,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(i,o)}}function Et(){this.s=this.s,this.o=this.o}Et.prototype.s=!1,Et.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function Jv(n){Object.prototype.hasOwnProperty.call(n,zo)&&n[zo]||(n[zo]=++ex)}(this)},Et.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const hu=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function Uo(n){const e=n.length;if(0<e){const t=Array(e);for(let i=0;i<e;i++)t[i]=n[i];return t}return[]}function fu(n,e){for(let t=1;t<arguments.length;t++){const i=arguments[t];if(Zr(i)){const r=n.length||0,s=i.length||0;n.length=r+s;for(let o=0;o<s;o++)n[r+o]=i[o]}else n.push(i)}}function Ce(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Ce.prototype.h=function(){this.defaultPrevented=!0};var rx=function(){if(!F.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{const t=()=>{};F.addEventListener("test",t,e),F.removeEventListener("test",t,e)}catch{}return n}();function Ei(n){return/^[\s\xa0]*$/.test(n)}function $r(){var n=F.navigator;return n&&(n=n.userAgent)?n:""}function Xe(n){return-1!=$r().indexOf(n)}function qo(n){return qo[" "](n),n}qo[" "]=function(){};var jo,n,ox=Xe("Opera"),En=Xe("Trident")||Xe("MSIE"),mu=Xe("Edge"),Go=mu||En,pu=Xe("Gecko")&&!(-1!=$r().toLowerCase().indexOf("webkit")&&!Xe("Edge"))&&!(Xe("Trident")||Xe("MSIE"))&&!Xe("Edge"),ax=-1!=$r().toLowerCase().indexOf("webkit")&&!Xe("Edge");function _u(){var n=F.document;return n?n.documentMode:void 0}e:{var Ho="",Zo=(n=$r(),pu?/rv:([^\);]+)(\)|;)/.exec(n):mu?/Edge\/([\d\.]+)/.exec(n):En?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):ax?/WebKit\/(\S+)/.exec(n):ox?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(Zo&&(Ho=Zo?Zo[1]:""),En){var Ko=_u();if(null!=Ko&&Ko>parseFloat(Ho)){jo=String(Ko);break e}}jo=Ho}var lx=F.document&&En&&(_u()||parseInt(jo,10))||void 0;function wi(n,e){if(Ce.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(pu){e:{try{qo(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:cx[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&wi.$.h.call(this)}}pe(wi,Ce);var cx={2:"touch",3:"pen",4:"mouse"};wi.prototype.h=function(){wi.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Ii="closure_listenable_"+(1e6*Math.random()|0),dx=0;function ux(n,e,t,i,r){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!i,this.la=r,this.key=++dx,this.fa=this.ia=!1}function Wr(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function Wo(n,e,t){for(const i in n)e.call(t,n[i],i,n)}function yu(n){const e={};for(const t in n)e[t]=n[t];return e}const vu="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function xu(n,e){let t,i;for(let r=1;r<arguments.length;r++){for(t in i=arguments[r],i)n[t]=i[t];for(let s=0;s<vu.length;s++)t=vu[s],Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])}}function Yr(n){this.src=n,this.g={},this.h=0}function Yo(n,e){var t=e.type;if(t in n.g){var s,i=n.g[t],r=hu(i,e);(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(Wr(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Qo(n,e,t,i){for(var r=0;r<n.length;++r){var s=n[r];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==i)return r}return-1}Yr.prototype.add=function(n,e,t,i,r){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var o=Qo(n,e,i,r);return-1<o?(e=n[o],t||(e.ia=!1)):((e=new ux(e,this.src,s,!!i,r)).ia=t,n.push(e)),e};var Xo="closure_lm_"+(1e6*Math.random()|0),Jo={};function bu(n,e,t,i,r){if(i&&i.once)return wu(n,e,t,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)bu(n,e[s],t,i,r);return null}return t=ia(t),n&&n[Ii]?n.O(e,t,bi(i)?!!i.capture:!!i,r):Eu(n,e,t,!1,i,r)}function Eu(n,e,t,i,r,s){if(!e)throw Error("Invalid event type");var o=bi(r)?!!r.capture:!!r,a=ta(n);if(a||(n[Xo]=a=new Yr(n)),(t=a.add(e,t,i,o,s)).proxy)return t;if(i=function fx(){const e=mx;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=i,i.src=n,i.listener=t,n.addEventListener)rx||(r=o),void 0===r&&(r=!1),n.addEventListener(e.toString(),i,r);else if(n.attachEvent)n.attachEvent(Tu(e.toString()),i);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(i)}return t}function wu(n,e,t,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)wu(n,e[s],t,i,r);return null}return t=ia(t),n&&n[Ii]?n.P(e,t,bi(i)?!!i.capture:!!i,r):Eu(n,e,t,!0,i,r)}function Iu(n,e,t,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)Iu(n,e[s],t,i,r);else i=bi(i)?!!i.capture:!!i,t=ia(t),n&&n[Ii]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Qo(s=n.g[e],t,i,r))&&(Wr(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=ta(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Qo(e,t,i,r)),(t=-1<n?e[n]:null)&&ea(t))}function ea(n){if("number"!=typeof n&&n&&!n.fa){var e=n.src;if(e&&e[Ii])Yo(e.i,n);else{var t=n.type,i=n.proxy;e.removeEventListener?e.removeEventListener(t,i,n.capture):e.detachEvent?e.detachEvent(Tu(t),i):e.addListener&&e.removeListener&&e.removeListener(i),(t=ta(e))?(Yo(t,n),0==t.h&&(t.src=null,e[Xo]=null)):Wr(n)}}}function Tu(n){return n in Jo?Jo[n]:Jo[n]="on"+n}function mx(n,e){if(n.fa)n=!0;else{e=new wi(e,this);var t=n.listener,i=n.la||n.src;n.ia&&ea(n),n=t.call(i,e)}return n}function ta(n){return(n=n[Xo])instanceof Yr?n:null}var na="__closure_events_fn_"+(1e9*Math.random()>>>0);function ia(n){return"function"==typeof n?n:(n[na]||(n[na]=function(e){return n.handleEvent(e)}),n[na])}function _e(){Et.call(this),this.i=new Yr(this),this.S=this,this.J=null}function xe(n,e){var t,i=n.J;if(i)for(t=[];i;i=i.J)t.push(i);if(n=n.S,i=e.type||e,"string"==typeof e)e=new Ce(e,n);else if(e instanceof Ce)e.target=e.target||n;else{var r=e;xu(e=new Ce(i,n),r)}if(r=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];r=Qr(o,i,!0,e)&&r}if(r=Qr(o=e.g=n,i,!0,e)&&r,r=Qr(o,i,!1,e)&&r,t)for(s=0;s<t.length;s++)r=Qr(o=e.g=t[s],i,!1,e)&&r}function Qr(n,e,t,i){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var a=o.listener,c=o.la||o.src;o.ia&&Yo(n.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}pe(_e,Et),_e.prototype[Ii]=!0,_e.prototype.removeEventListener=function(n,e,t,i){Iu(this,n,e,t,i)},_e.prototype.N=function(){if(_e.$.N.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],i=0;i<t.length;i++)Wr(t[i]);delete n.g[e],n.h--}}this.J=null},_e.prototype.O=function(n,e,t,i){return this.i.add(String(n),e,!1,t,i)},_e.prototype.P=function(n,e,t,i){return this.i.add(String(n),e,!0,t,i)};var ra=F.JSON.stringify;function _x(){var n=sa;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var Au=new class px{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new yx,n=>n.reset());class yx{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function vx(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function xx(n){F.setTimeout(()=>{throw n},0)}let Ti,Ai=!1,sa=new class gx{constructor(){this.h=this.g=null}add(e,t){const i=Au.get();i.set(e,t),this.h?this.h.next=i:this.g=i,this.h=i}},Cu=()=>{const n=F.Promise.resolve(void 0);Ti=()=>{n.then(bx)}};var bx=()=>{for(var n;n=_x();){try{n.h.call(n.g)}catch(t){xx(t)}var e=Au;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Ai=!1};function Xr(n,e){_e.call(this),this.h=n||1,this.g=e||F,this.j=Ae(this.qb,this),this.l=Date.now()}function oa(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function aa(n,e,t){if("function"==typeof n)t&&(n=Ae(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Ae(n.handleEvent,n)}return 2147483647<Number(e)?-1:F.setTimeout(n,e||0)}function Su(n){n.g=aa(()=>{n.g=null,n.i&&(n.i=!1,Su(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}pe(Xr,_e),(T=Xr.prototype).ga=!1,T.T=null,T.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),xe(this,"tick"),this.ga&&(oa(this),this.start()))}},T.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},T.N=function(){Xr.$.N.call(this),oa(this),delete this.g};class Ex extends Et{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Su(this)}N(){super.N(),this.g&&(F.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ci(n){Et.call(this),this.h=n,this.g={}}pe(Ci,Et);var Ru=[];function Pu(n,e,t,i){Array.isArray(t)||(t&&(Ru[0]=t.toString()),t=Ru);for(var r=0;r<t.length;r++){var s=bu(e,t[r],i||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function Du(n){Wo(n.g,function(e,t){this.g.hasOwnProperty(t)&&ea(e)},n),n.g={}}function Jr(){this.g=!0}function wn(n,e,t,i){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Ax(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var i=t[n];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return ra(t)}catch{return e}}(n,t)+(i?" "+i:"")})}Ci.prototype.N=function(){Ci.$.N.call(this),Du(this)},Ci.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Jr.prototype.Ea=function(){this.g=!1},Jr.prototype.info=function(){};var Kt={},ku=null;function es(){return ku=ku||new _e}function Mu(n){Ce.call(this,Kt.Ta,n)}function Si(n){const e=es();xe(e,new Mu(e))}function Fu(n,e){Ce.call(this,Kt.STAT_EVENT,n),this.stat=e}function ke(n){const e=es();xe(e,new Fu(e,n))}function Ou(n,e){Ce.call(this,Kt.Ua,n),this.size=e}function Ri(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return F.setTimeout(function(){n()},e)}Kt.Ta="serverreachability",pe(Mu,Ce),Kt.STAT_EVENT="statevent",pe(Fu,Ce),Kt.Ua="timingevent",pe(Ou,Ce);var ts={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Vu={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function la(){}function Lu(){}la.prototype.h=null;var ua,Pi={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ca(){Ce.call(this,"d")}function da(){Ce.call(this,"c")}function ns(){}function Di(n,e,t,i){this.l=n,this.j=e,this.m=t,this.W=i||1,this.U=new Ci(this),this.P=Cx,this.V=new Xr(n=Go?125:void 0),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Bu}function Bu(){this.i=null,this.g="",this.h=!1}pe(ca,Ce),pe(da,Ce),pe(ns,la),ns.prototype.g=function(){return new XMLHttpRequest},ns.prototype.i=function(){return{}},ua=new ns;var Cx=45e3,zu={},ha={};function fa(n,e,t){n.L=1,n.A=os(dt(e)),n.u=t,n.S=!0,Uu(n,null)}function Uu(n,e){n.G=Date.now(),ki(n),n.B=dt(n.A);var t=n.B,i=n.W;Array.isArray(i)||(i=[String(i)]),Qu(t.i,"t",i),n.o=0,t=n.l.J,n.h=new Bu,n.g=bh(n.l,t?e:null,!n.u),0<n.O&&(n.M=new Ex(Ae(n.Pa,n,n.g),n.O)),Pu(n.U,n.g,"readystatechange",n.nb),e=n.I?yu(n.I):{},n.u?(n.v||(n.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.B,n.v,n.u,e)):(n.v="GET",n.g.ha(n.B,n.v,null,e)),Si(),function wx(n,e,t,i,r,s){n.info(function(){if(n.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var d=a[c].split("=");if(1<d.length){var u=d[0];d=d[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+d+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+t+"\n"+o})}(n.j,n.v,n.B,n.m,n.W,n.u)}function qu(n){return!!n.g&&"GET"==n.v&&2!=n.L&&n.l.Ha}function Gu(n,e,t){let r,i=!0;for(;!n.J&&n.o<t.length;){if(r=Sx(n,t),r==ha){4==e&&(n.s=4,ke(14),i=!1),wn(n.j,n.m,null,"[Incomplete Response]");break}if(r==zu){n.s=4,ke(15),wn(n.j,n.m,t,"[Invalid Chunk]"),i=!1;break}wn(n.j,n.m,r,null),ma(n,r)}qu(n)&&0!=n.o&&(n.h.g=n.h.g.slice(n.o),n.o=0),4!=e||0!=t.length||n.h.h||(n.s=1,ke(16),i=!1),n.i=n.i&&i,i?0<t.length&&!n.ba&&(n.ba=!0,(e=n.l).g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),ba(e),e.M=!0,ke(11))):(wn(n.j,n.m,t,"[Invalid Chunked Response]"),$t(n),Mi(n))}function Sx(n,e){var t=n.o,i=e.indexOf("\n",t);return-1==i?ha:(t=Number(e.substring(t,i)),isNaN(t)?zu:(i+=1)+t>e.length?ha:(e=e.slice(i,i+t),n.o=i+t,e))}function ki(n){n.Y=Date.now()+n.P,ju(n,n.P)}function ju(n,e){if(null!=n.C)throw Error("WatchDog timer not null");n.C=Ri(Ae(n.lb,n),e)}function is(n){n.C&&(F.clearTimeout(n.C),n.C=null)}function Mi(n){0==n.l.H||n.J||gh(n.l,n)}function $t(n){is(n);var e=n.M;e&&"function"==typeof e.sa&&e.sa(),n.M=null,oa(n.V),Du(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function ma(n,e){try{var t=n.l;if(0!=t.H&&(t.g==n||pa(t.i,n)))if(!n.K&&pa(t.i,n)&&3==t.H){try{var i=t.Ja.g.parse(e)}catch{i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<n.G))break e;hs(t),ds(t)}xa(t),ke(18)}}else t.Fa=r[1],0<t.Fa-t.V&&37500>r[2]&&t.G&&0==t.A&&!t.v&&(t.v=Ri(Ae(t.ib,t),6e3));if(1>=eh(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Yt(t,11)}else if((n.K||t.g==n)&&hs(t),!Ei(e))for(r=t.Ja.g.parse(e),e=0;e<r.length;e++){let d=r[e];if(t.V=d[0],d=d[1],2==t.H)if("c"==d[0]){t.K=d[1],t.pa=d[2];const u=d[3];null!=u&&(t.ra=u,t.l.info("VER="+t.ra));const h=d[4];null!=h&&(t.Ga=h,t.l.info("SVER="+t.Ga));const f=d[5];null!=f&&"number"==typeof f&&0<f&&(t.L=i=1.5*f,t.l.info("backChannelRequestTimeoutMs_="+i)),i=t;const m=n.g;if(m){const g=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(g){var s=i.i;s.g||-1==g.indexOf("spdy")&&-1==g.indexOf("quic")&&-1==g.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(_a(s,s.h),s.h=null))}if(i.F){const v=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(i.Da=v,Q(i.I,i.F,v))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms"));var o=n;if((i=t).wa=xh(i,i.J?i.pa:null,i.Y),o.K){th(i.i,o);var a=o,c=i.L;c&&a.setTimeout(c),a.C&&(is(a),ki(a)),i.g=o}else ph(i);0<t.j.length&&us(t)}else"stop"!=d[0]&&"close"!=d[0]||Yt(t,7);else 3==t.H&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?Yt(t,7):va(t):"noop"!=d[0]&&t.h&&t.h.Aa(d),t.A=0)}Si()}catch{}}function Hu(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(Zr(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function Px(n){if(n.ta&&"function"==typeof n.ta)return n.ta();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Zr(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const i in n)e[t++]=i;return e}}}(n),i=function Rx(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(Zr(n)){for(var e=[],t=n.length,i=0;i<t;i++)e.push(n[i]);return e}for(i in e=[],t=0,n)e[t++]=n[i];return e}(n),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],t&&t[s],n)}(T=Di.prototype).setTimeout=function(n){this.P=n},T.nb=function(n){n=n.target;const e=this.M;e&&3==Je(n)?e.l():this.Pa(n)},T.Pa=function(n){try{if(n==this.g)e:{const u=Je(this.g);var e=this.g.Ia();if(this.g.da(),!(3>u)&&(3!=u||Go||this.g&&(this.h.h||this.g.ja()||ch(this.g)))){this.J||4!=u||7==e||Si(),is(this);var t=this.g.da();this.ca=t;t:if(qu(this)){var i=ch(this.g);n="";var r=i.length,s=4==Je(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){$t(this),Mi(this);var o="";break t}this.h.i=new F.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,n+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.length=0,this.h.g+=n,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==t,function Ix(n,e,t,i,r,s,o){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+t+"\n"+s+" "+o})}(this.j,this.v,this.B,this.m,this.W,u,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ei(a)){var d=a;break t}}d=null}if(!(t=d)){this.i=!1,this.s=3,ke(12),$t(this),Mi(this);break e}wn(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ma(this,t)}this.S?(Gu(this,u,o),Go&&this.i&&3==u&&(Pu(this.U,this.V,"tick",this.mb),this.V.start())):(wn(this.j,this.m,o,null),ma(this,o)),4==u&&$t(this),this.i&&!this.J&&(4==u?gh(this.l,this):(this.i=!1,ki(this)))}else(function $x(n){const e={};n=(n.g&&2<=Je(n)&&n.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<n.length;i++){if(Ei(n[i]))continue;var t=vx(n[i]);const r=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[r]||[];e[r]=s,s.push(t)}!function hx(n,e){for(const t in n)e.call(void 0,n[t],t,n)}(e,function(i){return i.join(", ")})})(this.g),400==t&&0<o.indexOf("Unknown SID")?(this.s=3,ke(12)):(this.s=0,ke(13)),$t(this),Mi(this)}}}catch{}},T.mb=function(){if(this.g){var n=Je(this.g),e=this.g.ja();this.o<e.length&&(is(this),Gu(this,n,e),this.i&&4!=n&&ki(this))}},T.cancel=function(){this.J=!0,$t(this)},T.lb=function(){this.C=null;const n=Date.now();0<=n-this.Y?(function Tx(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.B),2!=this.L&&(Si(),ke(17)),$t(this),this.s=2,Mi(this)):ju(this,this.Y-n)};var Zu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wt(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Wt){this.h=n.h,rs(this,n.j),this.s=n.s,this.g=n.g,ss(this,n.m),this.l=n.l;var e=n.i,t=new Vi;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Ku(this,t),this.o=n.o}else n&&(e=String(n).match(Zu))?(this.h=!1,rs(this,e[1]||"",!0),this.s=Fi(e[2]||""),this.g=Fi(e[3]||"",!0),ss(this,e[4]),this.l=Fi(e[5]||"",!0),Ku(this,e[6]||"",!0),this.o=Fi(e[7]||"")):(this.h=!1,this.i=new Vi(null,this.h))}function dt(n){return new Wt(n)}function rs(n,e,t){n.j=t?Fi(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function ss(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Ku(n,e,t){e instanceof Vi?(n.i=e,function Nx(n,e){e&&!n.j&&(wt(n),n.i=null,n.g.forEach(function(t,i){var r=i.toLowerCase();i!=r&&(Wu(this,i),Qu(this,r,t))},n)),n.j=e}(n.i,n.h)):(t||(e=Oi(e,Ox)),n.i=new Vi(e,n.h))}function Q(n,e,t){n.i.set(e,t)}function os(n){return Q(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Fi(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Oi(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,kx),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function kx(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Wt.prototype.toString=function(){var n=[],e=this.j;e&&n.push(Oi(e,$u,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(Oi(e,$u,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(Oi(t,"/"==t.charAt(0)?Fx:Mx,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",Oi(t,Vx)),n.join("")};var $u=/[#\/\?@]/g,Mx=/[#\?:]/g,Fx=/[#\?]/g,Ox=/[#\?@]/g,Vx=/#/g;function Vi(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function wt(n){n.g||(n.g=new Map,n.h=0,n.i&&function Dx(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var i=n[t].indexOf("="),r=null;if(0<=i){var s=n[t].substring(0,i);r=n[t].substring(i+1)}else s=n[t];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Wu(n,e){wt(n),e=In(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function Yu(n,e){return wt(n),e=In(n,e),n.g.has(e)}function Qu(n,e,t){Wu(n,e),0<t.length&&(n.i=null,n.g.set(In(n,e),Uo(t)),n.h+=t.length)}function In(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function Xu(n){this.l=n||Bx,n=F.PerformanceNavigationTiming?0<(n=F.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(F.g&&F.g.Ka&&F.g.Ka()&&F.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(T=Vi.prototype).add=function(n,e){wt(this),this.i=null,n=In(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},T.forEach=function(n,e){wt(this),this.g.forEach(function(t,i){t.forEach(function(r){n.call(e,r,i,this)},this)},this)},T.ta=function(){wt(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let i=0;i<e.length;i++){const r=n[i];for(let s=0;s<r.length;s++)t.push(e[i])}return t},T.Z=function(n){wt(this);let e=[];if("string"==typeof n)Yu(this,n)&&(e=e.concat(this.g.get(In(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},T.set=function(n,e){return wt(this),this.i=null,Yu(this,n=In(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},T.get=function(n,e){return n&&0<(n=this.Z(n)).length?String(n[0]):e},T.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var i=e[t];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),n.push(r)}}return this.i=n.join("&")};var Bx=10;function Ju(n){return!!n.h||!!n.g&&n.g.size>=n.j}function eh(n){return n.h?1:n.g?n.g.size:0}function pa(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function _a(n,e){n.g?n.g.add(e):n.h=e}function th(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function nh(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return Uo(n.i)}Xu.prototype.cancel=function(){if(this.i=nh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}};var zx=class{stringify(n){return F.JSON.stringify(n,void 0)}parse(n){return F.JSON.parse(n,void 0)}};function Ux(){this.g=new zx}function qx(n,e,t){const i=t||"";try{Hu(n,function(r,s){let o=r;bi(r)&&(o=ra(r)),e.push(i+s+"="+encodeURIComponent(o))})}catch(r){throw e.push(i+"type="+encodeURIComponent("_badmap")),r}}function as(n,e,t,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch{}}function Ni(n){this.l=n.ec||null,this.j=n.ob||!1}function ls(n,e){_e.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=ga,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}pe(Ni,la),Ni.prototype.g=function(){return new ls(this.l,this.j)},Ni.prototype.i=function(n){return function(){return n}}({}),pe(ls,_e);var ga=0;function ih(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function Li(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Bi(n)}function Bi(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(T=ls.prototype).open=function(n,e){if(this.readyState!=ga)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Bi(this)},T.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||F).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},T.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Li(this)),this.readyState=ga},T.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Bi(this)),this.g&&(this.readyState=3,Bi(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof F.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ih(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},T.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Li(this):Bi(this),3==this.readyState&&ih(this)}},T.Za=function(n){this.g&&(this.response=this.responseText=n,Li(this))},T.Ya=function(n){this.g&&(this.response=n,Li(this))},T.ka=function(){this.g&&Li(this)},T.setRequestHeader=function(n,e){this.v.append(n,e)},T.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},T.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(ls.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var jx=F.JSON.parse;function re(n){_e.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=rh,this.L=this.M=!1}pe(re,_e);var rh="",Hx=/^https?$/i,Zx=["POST","PUT"];function sh(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,oh(n),cs(n)}function oh(n){n.F||(n.F=!0,xe(n,"complete"),xe(n,"error"))}function ah(n){if(n.h&&typeof Bo<"u"&&(!n.C[1]||4!=Je(n)||2!=n.da()))if(n.v&&4==Je(n))aa(n.La,0,n);else if(xe(n,"readystatechange"),4==Je(n)){n.h=!1;try{const o=n.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var i;if(i=0===o){var r=String(n.I).match(Zu)[1]||null;!r&&F.self&&F.self.location&&(r=F.self.location.protocol.slice(0,-1)),i=!Hx.test(r?r.toLowerCase():"")}t=i}if(t)xe(n,"complete"),xe(n,"success");else{n.m=6;try{var s=2<Je(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",oh(n)}}finally{cs(n)}}}function cs(n,e){if(n.g){lh(n);const t=n.g,i=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||xe(n,"ready");try{t.onreadystatechange=i}catch{}}}function lh(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(F.clearTimeout(n.A),n.A=null)}function Je(n){return n.g?n.g.readyState:0}function ch(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case rh:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function dh(n){let e="";return Wo(n,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}function ya(n,e,t){e:{for(i in t){var i=!1;break e}i=!0}i||(t=dh(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Q(n,e,t))}function zi(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function uh(n){this.Ga=0,this.j=[],this.l=new Jr,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=zi("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=zi("baseRetryDelayMs",5e3,n),this.hb=zi("retryDelaySeedMs",1e4,n),this.eb=zi("forwardChannelMaxRetries",2,n),this.xa=zi("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new Xu(n&&n.concurrentRequestLimit),this.Ja=new Ux,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function va(n){if(hh(n),3==n.H){var e=n.W++,t=dt(n.I);if(Q(t,"SID",n.K),Q(t,"RID",e),Q(t,"TYPE","terminate"),Ui(n,t),(e=new Di(n,n.l,e)).L=2,e.A=os(dt(t)),t=!1,F.navigator&&F.navigator.sendBeacon)try{t=F.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&F.Image&&((new Image).src=e.A,t=!0),t||(e.g=bh(e.l,null),e.g.ha(e.A)),e.G=Date.now(),ki(e)}vh(n)}function ds(n){n.g&&(ba(n),n.g.cancel(),n.g=null)}function hh(n){ds(n),n.u&&(F.clearTimeout(n.u),n.u=null),hs(n),n.i.cancel(),n.m&&("number"==typeof n.m&&F.clearTimeout(n.m),n.m=null)}function us(n){if(!Ju(n.i)&&!n.m){n.m=!0;var e=n.Na;Ti||Cu(),Ai||(Ti(),Ai=!0),sa.add(e,n),n.C=0}}function fh(n,e){var t;t=e?e.m:n.W++;const i=dt(n.I);Q(i,"SID",n.K),Q(i,"RID",t),Q(i,"AID",n.V),Ui(n,i),n.o&&n.s&&ya(i,n.o,n.s),t=new Di(n,n.l,t,n.C+1),null===n.o&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=mh(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),_a(n.i,t),fa(t,i,e)}function Ui(n,e){n.na&&Wo(n.na,function(t,i){Q(e,i,t)}),n.h&&Hu({},function(t,i){Q(e,i,t)})}function mh(n,e,t){t=Math.min(n.j.length,t);var i=n.h?Ae(n.h.Va,n.h,n):null;e:{var r=n.j;let s=-1;for(;;){const o=["count="+t];-1==s?0<t?(s=r[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<t;c++){let d=r[c].g;const u=r[c].map;if(d-=s,0>d)s=Math.max(0,r[c].g-100),a=!1;else try{qx(u,o,"req"+d+"_")}catch{i&&i(u)}}if(a){i=o.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,i}function ph(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Ti||Cu(),Ai||(Ti(),Ai=!0),sa.add(e,n),n.A=0}}function xa(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=Ri(Ae(n.Ma,n),yh(n,n.A)),n.A++,0))}function ba(n){null!=n.B&&(F.clearTimeout(n.B),n.B=null)}function _h(n){n.g=new Di(n,n.l,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var e=dt(n.wa);Q(e,"RID","rpc"),Q(e,"SID",n.K),Q(e,"AID",n.V),Q(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&Q(e,"TO",n.qa),Q(e,"TYPE","xmlhttp"),Ui(n,e),n.o&&n.s&&ya(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.A=os(dt(e)),t.u=null,t.S=!0,Uu(t,n)}function hs(n){null!=n.v&&(F.clearTimeout(n.v),n.v=null)}function gh(n,e){var t=null;if(n.g==e){hs(n),ba(n),n.g=null;var i=2}else{if(!pa(n.i,e))return;t=e.F,th(n.i,e),i=1}if(0!=n.H)if(e.i)if(1==i){t=e.u?e.u.length:0,e=Date.now()-e.G;var r=n.C;xe(i=es(),new Ou(i,t)),us(n)}else ph(n);else if(3==(r=e.s)||0==r&&0<e.ca||!(1==i&&function Wx(n,e){return!(eh(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.j=e.F.concat(n.j),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=Ri(Ae(n.Na,n,e),yh(n,n.C)),n.C++,0)))}(n,e)||2==i&&xa(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),r){case 1:Yt(n,5);break;case 4:Yt(n,10);break;case 3:Yt(n,6);break;default:Yt(n,2)}}function yh(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Yt(n,e){if(n.l.info("Error code "+e),2==e){var t=null;n.h&&(t=null);var i=Ae(n.pb,n);t||(t=new Wt("//www.google.com/images/cleardot.gif"),F.location&&"http"==F.location.protocol||rs(t,"https"),os(t)),function Gx(n,e){const t=new Jr;if(F.Image){const i=new Image;i.onload=Kr(as,t,i,"TestLoadImage: loaded",!0,e),i.onerror=Kr(as,t,i,"TestLoadImage: error",!1,e),i.onabort=Kr(as,t,i,"TestLoadImage: abort",!1,e),i.ontimeout=Kr(as,t,i,"TestLoadImage: timeout",!1,e),F.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else e(!1)}(t.toString(),i)}else ke(2);n.H=0,n.h&&n.h.za(e),vh(n),hh(n)}function vh(n){if(n.H=0,n.ma=[],n.h){const e=nh(n.i);(0!=e.length||0!=n.j.length)&&(fu(n.ma,e),fu(n.ma,n.j),n.i.i.length=0,Uo(n.j),n.j.length=0),n.h.ya()}}function xh(n,e,t){var i=t instanceof Wt?dt(t):new Wt(t);if(""!=i.g)e&&(i.g=e+"."+i.g),ss(i,i.m);else{var r=F.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new Wt(null);i&&rs(s,i),e&&(s.g=e),r&&ss(s,r),t&&(s.l=t),i=s}return e=n.Da,(t=n.F)&&e&&Q(i,t,e),Q(i,"VER",n.ra),Ui(n,i),i}function bh(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new re(n.Ha&&!n.va?new Ni({ob:t}):n.va)).Oa(n.J),e}function Eh(){}function fs(){if(En&&!(10<=Number(lx)))throw Error("Environmental error: no available transport.")}function ze(n,e){_e.call(this),this.g=new uh(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!Ei(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ei(e)&&(this.g.F=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Tn(this)}function wh(n){ca.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function Ih(){da.call(this),this.status=1}function Tn(n){this.g=n}function We(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Ea(n,e,t){t||(t=0);var i=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)i[r]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(r=0;16>r;++r)i[r]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=n.g[3],o=(e=n.g[0])+(s^(t=n.g[1])&((r=n.g[2])^s))+i[0]+3614090360&4294967295;o=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=t+(o<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^s&(t^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(t^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(t^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(t^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(t^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(r^(t|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~t))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(r|~e))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(t|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~t))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(r|~e))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(t|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~t))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(r|~e))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=t+((o=e+(r^(t|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(e^(s|~t))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+i[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,n.g[2]=n.g[2]+r&4294967295,n.g[3]=n.g[3]+s&4294967295}function Z(n,e){this.h=e;for(var t=[],i=!0,r=n.length-1;0<=r;r--){var s=0|n[r];i&&s==e||(t[r]=s,i=!1)}this.g=t}(T=re.prototype).Oa=function(n){this.M=n},T.ha=function(n,e,t,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ua.g(),this.C=function Nu(n){return n.h||(n.h=n.i())}(this.u?this.u:ua),this.g.onreadystatechange=Ae(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){return void sh(this,s)}if(n=t||"",t=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)t.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const s of i.keys())t.set(s,i.get(s))}i=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),r=F.FormData&&n instanceof F.FormData,!(0<=hu(Zx,e))||i||r||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{lh(this),0<this.B&&((this.L=function Kx(n){return En&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ae(this.ua,this)):this.A=aa(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){sh(this,s)}},T.ua=function(){typeof Bo<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,xe(this,"timeout"),this.abort(8))},T.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,xe(this,"complete"),xe(this,"abort"),cs(this))},T.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),cs(this,!0)),re.$.N.call(this)},T.La=function(){this.s||(this.G||this.v||this.l?ah(this):this.kb())},T.kb=function(){ah(this)},T.isActive=function(){return!!this.g},T.da=function(){try{return 2<Je(this)?this.g.status:-1}catch{return-1}},T.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},T.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),jx(e)}},T.Ia=function(){return this.m},T.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(T=uh.prototype).ra=8,T.H=1,T.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const r=new Di(this,this.l,n);let s=this.s;if(this.U&&(s?(s=yu(s),xu(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var i=this.j[t];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=mh(this,r,e),Q(t=dt(this.I),"RID",n),Q(t,"CVER",22),this.F&&Q(t,"X-HTTP-Session-Id",this.F),Ui(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(dh(s)))+"&"+e:this.o&&ya(t,this.o,s)),_a(this.i,r),this.bb&&Q(t,"TYPE","init"),this.P?(Q(t,"$req",e),Q(t,"SID","null"),r.aa=!0,fa(r,t,null)):fa(r,t,e),this.H=2}}else 3==this.H&&(n?fh(this,n):0==this.j.length||Ju(this.i)||fh(this))},T.Ma=function(){if(this.u=null,_h(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=Ri(Ae(this.jb,this),n)}},T.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,ke(10),ds(this),_h(this))},T.ib=function(){null!=this.v&&(this.v=null,ds(this),xa(this),ke(19))},T.pb=function(n){n?(this.l.info("Successfully pinged google.com"),ke(2)):(this.l.info("Failed to ping google.com"),ke(1))},T.isActive=function(){return!!this.h&&this.h.isActive(this)},(T=Eh.prototype).Ba=function(){},T.Aa=function(){},T.za=function(){},T.ya=function(){},T.isActive=function(){return!0},T.Va=function(){},fs.prototype.g=function(n,e){return new ze(n,e)},pe(ze,_e),ze.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;ke(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=xh(n,null,n.Y),us(n)},ze.prototype.close=function(){va(this.g)},ze.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=ra(n),n=t);e.j.push(new class{constructor(n,e){this.g=n,this.map=e}}(e.fb++,n)),3==e.H&&us(e)},ze.prototype.N=function(){this.g.h=null,delete this.j,va(this.g),delete this.g,ze.$.N.call(this)},pe(wh,ca),pe(Ih,da),pe(Tn,Eh),Tn.prototype.Ba=function(){xe(this.g,"a")},Tn.prototype.Aa=function(n){xe(this.g,new wh(n))},Tn.prototype.za=function(n){xe(this.g,new Ih)},Tn.prototype.ya=function(){xe(this.g,"b")},pe(We,function Yx(){this.blockSize=-1}),We.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},We.prototype.j=function(n,e){void 0===e&&(e=n.length);for(var t=e-this.blockSize,i=this.m,r=this.h,s=0;s<e;){if(0==r)for(;s<=t;)Ea(this,n,s),s+=this.blockSize;if("string"==typeof n){for(;s<e;)if(i[r++]=n.charCodeAt(s++),r==this.blockSize){Ea(this,i),r=0;break}}else for(;s<e;)if(i[r++]=n[s++],r==this.blockSize){Ea(this,i),r=0;break}}this.h=r,this.i+=e},We.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=255&t,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var i=0;32>i;i+=8)n[t++]=this.g[e]>>>i&255;return n};var Qx={};function wa(n){return-128<=n&&128>n?function sx(n,e){var t=Qx;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}(n,function(e){return new Z([0|e],0>e?-1:0)}):new Z([0|n],0>n?-1:0)}function et(n){if(isNaN(n)||!isFinite(n))return An;if(0>n)return be(et(-n));for(var e=[],t=1,i=0;n>=t;i++)e[i]=n/t|0,t*=Ia;return new Z(e,0)}var Ia=4294967296,An=wa(0),Ta=wa(1),Ah=wa(16777216);function ut(n){if(0!=n.h)return!1;for(var e=0;e<n.g.length;e++)if(0!=n.g[e])return!1;return!0}function je(n){return-1==n.h}function be(n){for(var e=n.g.length,t=[],i=0;i<e;i++)t[i]=~n.g[i];return new Z(t,~n.h).add(Ta)}function ms(n,e){return n.add(be(e))}function ps(n,e){for(;(65535&n[e])!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function qi(n,e){this.g=n,this.h=e}function _s(n,e){if(ut(e))throw Error("division by zero");if(ut(n))return new qi(An,An);if(je(n))return e=_s(be(n),e),new qi(be(e.g),be(e.h));if(je(e))return e=_s(n,be(e)),new qi(be(e.g),e.h);if(30<n.g.length){if(je(n)||je(e))throw Error("slowDivide_ only works with positive integers.");for(var t=Ta,i=e;0>=i.X(n);)t=Ch(t),i=Ch(i);var r=Cn(t,1),s=Cn(i,1);for(i=Cn(i,2),t=Cn(t,2);!ut(i);){var o=s.add(i);0>=o.X(n)&&(r=r.add(t),s=o),i=Cn(i,1),t=Cn(t,1)}return e=ms(n,r.R(e)),new qi(r,e)}for(r=An;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,i-48),o=(s=et(t)).R(e);je(o)||0<o.X(n);)o=(s=et(t-=i)).R(e);ut(s)&&(s=Ta),r=r.add(s),n=ms(n,o)}return new qi(r,n)}function Ch(n){for(var e=n.g.length+1,t=[],i=0;i<e;i++)t[i]=n.D(i)<<1|n.D(i-1)>>>31;return new Z(t,n.h)}function Cn(n,e){var t=e>>5;e%=32;for(var i=n.g.length-t,r=[],s=0;s<i;s++)r[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new Z(r,n.h)}(T=Z.prototype).ea=function(){if(je(this))return-be(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var i=this.D(t);n+=(0<=i?i:Ia+i)*e,e*=Ia}return n},T.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(ut(this))return"0";if(je(this))return"-"+be(this).toString(n);for(var e=et(Math.pow(n,6)),t=this,i="";;){var r=_s(t,e).g,s=((0<(t=ms(t,r.R(e))).g.length?t.g[0]:t.h)>>>0).toString(n);if(ut(t=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},T.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},T.X=function(n){return je(n=ms(this,n))?-1:ut(n)?0:1},T.abs=function(){return je(this)?be(this):this},T.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0,r=0;r<=e;r++){var s=i+(65535&this.D(r))+(65535&n.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(n.D(r)>>>16);i=o>>>16,t[r]=(o&=65535)<<16|(s&=65535)}return new Z(t,-2147483648&t[t.length-1]?-1:0)},T.R=function(n){if(ut(this)||ut(n))return An;if(je(this))return je(n)?be(this).R(be(n)):be(be(this).R(n));if(je(n))return be(this.R(be(n)));if(0>this.X(Ah)&&0>n.X(Ah))return et(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],i=0;i<2*e;i++)t[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<n.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),a=n.D(r)>>>16,c=65535&n.D(r);t[2*i+2*r]+=o*c,ps(t,2*i+2*r),t[2*i+2*r+1]+=s*c,ps(t,2*i+2*r+1),t[2*i+2*r+1]+=o*a,ps(t,2*i+2*r+1),t[2*i+2*r+2]+=s*a,ps(t,2*i+2*r+2)}for(i=0;i<e;i++)t[i]=t[2*i+1]<<16|t[2*i];for(i=e;i<2*e;i++)t[i]=0;return new Z(t,0)},T.gb=function(n){return _s(this,n).h},T.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)&n.D(i);return new Z(t,this.h&n.h)},T.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)|n.D(i);return new Z(t,this.h|n.h)},T.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)^n.D(i);return new Z(t,this.h^n.h)},fs.prototype.createWebChannel=fs.prototype.g,ze.prototype.send=ze.prototype.u,ze.prototype.open=ze.prototype.m,ze.prototype.close=ze.prototype.close,ts.NO_ERROR=0,ts.TIMEOUT=8,ts.HTTP_ERROR=6,Vu.COMPLETE="complete",Lu.EventType=Pi,Pi.OPEN="a",Pi.CLOSE="b",Pi.ERROR="c",Pi.MESSAGE="d",_e.prototype.listen=_e.prototype.O,re.prototype.listenOnce=re.prototype.P,re.prototype.getLastError=re.prototype.Sa,re.prototype.getLastErrorCode=re.prototype.Ia,re.prototype.getStatus=re.prototype.da,re.prototype.getResponseJson=re.prototype.Wa,re.prototype.getResponseText=re.prototype.ja,re.prototype.send=re.prototype.ha,re.prototype.setWithCredentials=re.prototype.Oa,We.prototype.digest=We.prototype.l,We.prototype.reset=We.prototype.reset,We.prototype.update=We.prototype.j,Z.prototype.add=Z.prototype.add,Z.prototype.multiply=Z.prototype.R,Z.prototype.modulo=Z.prototype.gb,Z.prototype.compare=Z.prototype.X,Z.prototype.toNumber=Z.prototype.ea,Z.prototype.toString=Z.prototype.toString,Z.prototype.getBits=Z.prototype.D,Z.fromNumber=et,Z.fromString=function Th(n,e){if(0==n.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==n.charAt(0))return be(Th(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=et(Math.pow(e,8)),i=An,r=0;r<n.length;r+=8){var s=Math.min(8,n.length-r),o=parseInt(n.substring(r,r+s),e);8>s?(s=et(Math.pow(e,s)),i=i.R(s).add(et(o))):i=(i=i.R(t)).add(et(o))}return i};var Xx=$e.createWebChannelTransport=function(){return new fs},Jx=$e.getStatEventTarget=function(){return es()},Aa=$e.ErrorCode=ts,eb=$e.EventType=Vu,tb=$e.Event=Kt,Sh=$e.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},nb=$e.FetchXmlHttpFactory=Ni,gs=$e.WebChannel=Lu,ib=$e.XhrIo=re,rb=$e.Md5=We,Sn=$e.Integer=Z;const Rh="@firebase/firestore";class ge{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ge.UNAUTHENTICATED=new ge(null),ge.GOOGLE_CREDENTIALS=new ge("google-credentials-uid"),ge.FIRST_PARTY=new ge("first-party-uid"),ge.MOCK_USER=new ge("mock-user");let Rn="10.11.1";const It=new Qe.Yd("@firebase/firestore");function Pn(){return It.logLevel}function E(n,...e){if(It.logLevel<=Qe.in.DEBUG){const t=e.map(Ca);It.debug(`Firestore (${Rn}): ${n}`,...t)}}function ae(n,...e){if(It.logLevel<=Qe.in.ERROR){const t=e.map(Ca);It.error(`Firestore (${Rn}): ${n}`,...t)}}function Ve(n,...e){if(It.logLevel<=Qe.in.WARN){const t=e.map(Ca);It.warn(`Firestore (${Rn}): ${n}`,...t)}}function Ca(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function A(n="Unexpected state"){const e=`FIRESTORE (${Rn}) INTERNAL ASSERTION FAILED: `+n;throw ae(e),new Error(e)}function S(n,e){n||A()}function w(n,e){return n}const _={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class x extends j.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class fe{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Ph{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ab{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ge.UNAUTHENTICATED))}shutdown(){}}class lb{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class cb{constructor(e){this.t=e,this.currentUser=ge.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var i=this;let r=this.i;const s=d=>this.i!==r?(r=this.i,t(d)):Promise.resolve();let o=new fe;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new fe,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const d=o;e.enqueueRetryable((0,y.Z)(function*(){yield d.promise,yield s(i.currentUser)}))},c=d=>{E("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(d=>c(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?c(d):(E("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new fe)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(E("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(S("string"==typeof i.accessToken),new Ph(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return S(null===e||"string"==typeof e),new ge(e)}}class db{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=ge.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class ub{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new db(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ge.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Dh{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class hb{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const i=s=>{null!=s.error&&E("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,E("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{E("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?r(s):E("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(S("string"==typeof t.token),this.R=t.token,new Dh(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function fb(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class kh{static newId(){const t=62*Math.floor(256/62);let i="";for(;i.length<20;){const r=fb(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[s]%62))}return i}}function M(n,e){return n<e?-1:n>e?1:0}function Dn(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}function Mh(n){return n+"\0"}class te{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(_.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(_.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new x(_.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(_.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return te.fromMillis(Date.now())}static fromDate(e){return te.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new te(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?M(this.nanoseconds,e.nanoseconds):M(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class P{constructor(e){this.timestamp=e}static fromTimestamp(e){return new P(e)}static min(){return new P(new te(0,0))}static max(){return new P(new te(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Gi{constructor(e,t,i){void 0===t?t=0:t>e.length&&A(),void 0===i?i=e.length-t:i>e.length-t&&A(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return 0===Gi.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Gi?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class B extends Gi{construct(e,t,i){return new B(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new x(_.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new B(t)}static emptyPath(){return new B([])}}const mb=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class X extends Gi{construct(e,t,i){return new X(e,t,i)}static isValidIdentifier(e){return mb.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),X.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new X(["__name__"])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(0===i.length)throw new x(_.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if("\\"===a){if(r+1===e.length)throw new x(_.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new x(_.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else"`"===a?(o=!o,r++):"."!==a||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new x(_.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new X(t)}static emptyPath(){return new X([])}}class I{constructor(e){this.path=e}static fromPath(e){return new I(B.fromString(e))}static fromName(e){return new I(B.fromString(e).popFirst(5))}static empty(){return new I(B.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===B.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return B.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new I(new B(e.slice()))}}class kn{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function Sa(n){return n.fields.find(e=>2===e.kind)}function Qt(n){return n.fields.filter(e=>2!==e.kind)}kn.UNKNOWN_ID=-1;class Xt{constructor(e,t){this.fieldPath=e,this.kind=t}}class Mn{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Mn(0,Ue.min())}}function Fh(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=P.fromTimestamp(1e9===i?new te(t+1,0):new te(t,i));return new Ue(r,I.empty(),e)}function Oh(n){return new Ue(n.readTime,n.key,-1)}class Ue{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ue(P.min(),I.empty(),-1)}static max(){return new Ue(P.max(),I.empty(),-1)}}function Ra(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=I.comparator(n.documentKey,e.documentKey),0!==t?t:M(n.largestBatchId,e.largestBatchId))}const Vh="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Nh{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Tt(n){return Pa.apply(this,arguments)}function Pa(){return Pa=(0,y.Z)(function*(n){if(n.code!==_.FAILED_PRECONDITION||n.message!==Vh)throw n;E("LocalStore","Unexpectedly lost primary lease")}),Pa.apply(this,arguments)}class p{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&A(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new p((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof p?t:p.resolve(t)}catch(t){return p.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):p.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):p.reject(t)}static resolve(e){return new p((t,i)=>{t(e)})}static reject(e){return new p((t,i)=>{i(e)})}static waitFor(e){return new p((t,i)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},c=>i(c))}),o=!0,s===r&&t()})}static or(e){let t=p.resolve(!1);for(const i of e)t=t.next(r=>r?p.resolve(r):i());return t}static forEach(e,t){const i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new p((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const d=c;t(e[d]).next(u=>{o[d]=u,++a,a===s&&i(o)},u=>r(u))}})}static doWhile(e,t){return new p((i,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):i()};s()})}}class ys{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new fe,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ji(e,t.error)):this.V.resolve()},this.transaction.onerror=i=>{const r=Da(i.target.error);this.V.reject(new ji(e,r))}}static open(e,t,i,r){try{return new ys(t,e.transaction(r,i))}catch(s){throw new ji(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(E("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new yb(t)}}class tt{constructor(e,t,i){this.name=e,this.version=t,this.p=i,12.2===tt.S((0,j.z$)())&&ae("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return E("SimpleDb","Removing database:",e),Jt(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,j.hl)())return!1;if(tt.C())return!0;const e=(0,j.z$)(),t=tt.S(e),i=0<t&&t<10,r=Lh(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.v)}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}M(e){var t=this;return(0,y.Z)(function*(){return t.db||(E("SimpleDb","Opening database:",t.name),t.db=yield new Promise((i,r)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=o=>{i(o.target.result)},s.onblocked=()=>{r(new ji(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;r("VersionError"===a.name?new x(_.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new x(_.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new ji(e,a))},s.onupgradeneeded=o=>{E("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',o.oldVersion),t.p.O(o.target.result,s.transaction,o.oldVersion,t.version).next(()=>{E("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.N&&(t.db.onversionchange=i=>t.N(i)),t.db})()}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,i,r){var s=this;return(0,y.Z)(function*(){const o="readonly"===t;let a=0;for(;;){++a;try{s.db=yield s.M(e);const c=ys.open(s.db,e,o?"readonly":"readwrite",i),d=r(c).next(u=>(c.g(),u)).catch(u=>(c.abort(u),p.reject(u))).toPromise();return d.catch(()=>{}),yield c.m,d}catch(c){const d=c,u="FirebaseError"!==d.name&&a<3;if(E("SimpleDb","Transaction failed with error:",d.message,"Retrying:",u),s.close(),!u)return Promise.reject(d)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}function Lh(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class gb{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Jt(this.B.delete())}}class ji extends x{constructor(e,t){super(_.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function At(n){return"IndexedDbTransactionError"===n.name}class yb{constructor(e){this.store=e}put(e,t){let i;return void 0!==t?(E("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(E("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Jt(i)}add(e){return E("SimpleDb","ADD",this.store.name,e,e),Jt(this.store.add(e))}get(e){return Jt(this.store.get(e)).next(t=>(void 0===t&&(t=null),E("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return E("SimpleDb","DELETE",this.store.name,e),Jt(this.store.delete(e))}count(){return E("SimpleDb","COUNT",this.store.name),Jt(this.store.count())}U(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if("function"==typeof r.getAll){const s=r.getAll(i.range);return new p((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{const s=this.cursor(i),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){const i=this.store.getAll(e,null===t?void 0:t);return new p((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}})}j(e,t){E("SimpleDb","DELETE ALL",this.store.name);const i=this.options(e,t);i.H=!1;const r=this.cursor(i);return this.W(r,(s,o,a)=>a.delete())}J(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.W(r,t)}Y(e){const t=this.cursor({});return new p((i,r)=>{t.onerror=s=>{const o=Da(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():i()}):i()}})}W(e,t){const i=[];return new p((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const c=new gb(a),d=t(a.primaryKey,a.value,c);if(d instanceof p){const u=d.catch(h=>(c.done(),p.reject(h)));i.push(u)}c.isDone?r():null===c.K?a.continue():a.continue(c.K)}}).next(()=>p.waitFor(i))}options(e,t){let i;return void 0!==e&&("string"==typeof e?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.H?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Jt(n){return new p((e,t)=>{n.onsuccess=i=>{e(i.target.result)},n.onerror=i=>{const r=Da(i.target.error);t(r)}})}let Bh=!1;function Da(n){const e=tt.S((0,j.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new x("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Bh||(Bh=!0,setTimeout(()=>{throw i},0)),i}}return n}class vb{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}X(e){var t=this;E("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,y.Z)(function*(){t.task=null;try{E("IndexBackfiller",`Documents written: ${yield t.Z.ee()}`)}catch(i){At(i)?E("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",i):yield Tt(i)}yield t.X(6e4)}))}}class xb{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){var t=this;return(0,y.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",i=>t.te(i,e))})()}te(e,t){const i=new Set;let r=t,s=!0;return p.doWhile(()=>!0===s&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!i.has(o))return E("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,r).next(a=>{r-=a,i.add(o)});s=!1})).next(()=>t-r)}ne(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(r,s)).next(a=>(E("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let i=e;return t.changes.forEach((r,s)=>{const o=Oh(s);Ra(o,i)>0&&(i=o)}),new Ue(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}let qe=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ie(r),this.se=r=>i.writeSequenceNumber(r))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Hi(n){return null==n}function Zi(n){return 0===n&&1/n==-1/0}function zh(n){return"number"==typeof n&&Number.isInteger(n)&&!Zi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Se(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Uh(e)),e=bb(n.get(t),e);return Uh(e)}function bb(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function Uh(n){return n+"\x01\x01"}function nt(n){const e=n.length;if(S(e>=2),2===e)return S("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),B.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf("\x01",s);switch((o<0||o>t)&&A(),n.charAt(o+1)){case"\x01":const a=n.substring(s,o);let c;0===r.length?c=a:(r+=a,c=r,r=""),i.push(c);break;case"\x10":r+=n.substring(s,o),r+="\0";break;case"\x11":r+=n.substring(s,o+1);break;default:A()}s=o+2}return new B(i)}const qh=["userId","batchId"];function vs(n,e){return[n,Se(e)]}function Gh(n,e,t){return[n,Se(e),t]}const Eb={},wb=["prefixPath","collectionGroup","readTime","documentId"],Ib=["prefixPath","collectionGroup","documentId"],Tb=["collectionGroup","readTime","prefixPath","documentId"],Ab=["canonicalId","targetId"],Cb=["targetId","path"],Sb=["path","targetId"],Rb=["collectionId","parent"],Pb=["indexId","uid"],Db=["uid","sequenceNumber"],kb=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Mb=["indexId","uid","orderedDocumentKey"],Fb=["userId","collectionPath","documentId"],Ob=["userId","collectionPath","largestBatchId"],Vb=["userId","collectionGroup","largestBatchId"],jh=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Nb=[...jh,"documentOverlays"],Hh=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Zh=Hh,Kh=[...Zh,"indexConfiguration","indexState","indexEntries"],Lb=Kh;class ka extends Nh{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function ye(n,e){const t=w(n);return tt.F(t._e,e)}function $h(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ct(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Wh(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class W{constructor(e,t){this.comparator=e,this.root=t||Ee.EMPTY}insert(e,t){return new W(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ee.BLACK,null,null))}remove(e){return new W(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ee.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(0===i)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(0===r)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xs(this.root,e,this.comparator,!1)}getReverseIterator(){return new xs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xs(this.root,e,this.comparator,!0)}}class xs{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ee{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??Ee.RED,this.left=r??Ee.EMPTY,this.right=s??Ee.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new Ee(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ee.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Ee.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ee.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ee.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw A();const e=this.left.check();if(e!==this.right.check())throw A();return e+(this.isRed()?0:1)}}Ee.EMPTY=null,Ee.RED=!0,Ee.BLACK=!1,Ee.EMPTY=new class{constructor(){this.size=0}get key(){throw A()}get value(){throw A()}get color(){throw A()}get left(){throw A()}get right(){throw A()}copy(e,t,i,r,s){return this}insert(e,t,i){return new Ee(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ${constructor(e){this.comparator=e,this.data=new W(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Yh(this.data.getIterator())}getIteratorFrom(e){return new Yh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof $)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(0!==this.comparator(r,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new $(this.comparator);return t.data=e,t}}class Yh{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Fn(n){return n.hasNext()?n.getNext():void 0}class Ne{constructor(e){this.fields=e,e.sort(X.comparator)}static empty(){return new Ne([])}unionWith(e){let t=new $(X.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Ne(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Dn(this.fields,e.fields,(t,i)=>t.isEqual(i))}}class Qh extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class me{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Qh("Invalid base64 string: "+s):s}}(e);return new me(t)}static fromUint8Array(e){const t=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new me(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return M(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}me.EMPTY_BYTE_STRING=new me("");const zb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ht(n){if(S(!!n),"string"==typeof n){let e=0;const t=zb.exec(n);if(S(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:se(n.seconds),nanos:se(n.nanos)}}function se(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function ft(n){return"string"==typeof n?me.fromBase64String(n):me.fromUint8Array(n)}function bs(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Es(n){const e=n.mapValue.fields.__previous_value__;return bs(e)?Es(e):e}function Ki(n){const e=ht(n.mapValue.fields.__local_write_time__.timestampValue);return new te(e.seconds,e.nanos)}class Ub{constructor(e,t,i,r,s,o,a,c,d){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d}}class St{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new St("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof St&&e.projectId===this.projectId&&e.database===this.database}}const Rt={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ws={nullValue:"NULL_VALUE"};function Pt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?bs(n)?4:tf(n)?9007199254740991:10:A()}function it(n,e){if(n===e)return!0;const t=Pt(n);if(t!==Pt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ki(n).isEqual(Ki(e));case 3:return function(r,s){if("string"==typeof r.timestampValue&&"string"==typeof s.timestampValue&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ht(r.timestampValue),a=ht(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return s=e,ft(n.bytesValue).isEqual(ft(s.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return se(r.geoPointValue.latitude)===se(s.geoPointValue.latitude)&&se(r.geoPointValue.longitude)===se(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return se(r.integerValue)===se(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=se(r.doubleValue),a=se(s.doubleValue);return o===a?Zi(o)===Zi(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Dn(n.arrayValue.values||[],e.arrayValue.values||[],it);case 10:return function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if($h(o)!==$h(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(void 0===a[c]||!it(o[c],a[c])))return!1;return!0}(n,e);default:return A()}var s}function $i(n,e){return void 0!==(n.values||[]).find(t=>it(t,e))}function Dt(n,e){if(n===e)return 0;const t=Pt(n),i=Pt(e);if(t!==i)return M(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return M(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=se(s.integerValue||s.doubleValue),c=se(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return Xh(n.timestampValue,e.timestampValue);case 4:return Xh(Ki(n),Ki(e));case 5:return M(n.stringValue,e.stringValue);case 6:return function(s,o){const a=ft(s),c=ft(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){const u=M(a[d],c[d]);if(0!==u)return u}return M(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=M(se(s.latitude),se(o.latitude));return 0!==a?a:M(se(s.longitude),se(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],c=o.values||[];for(let d=0;d<a.length&&d<c.length;++d){const u=Dt(a[d],c[d]);if(u)return u}return M(a.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Rt.mapValue&&o===Rt.mapValue)return 0;if(s===Rt.mapValue)return 1;if(o===Rt.mapValue)return-1;const a=s.fields||{},c=Object.keys(a),d=o.fields||{},u=Object.keys(d);c.sort(),u.sort();for(let h=0;h<c.length&&h<u.length;++h){const f=M(c[h],u[h]);if(0!==f)return f;const m=Dt(a[c[h]],d[u[h]]);if(0!==m)return m}return M(c.length,u.length)}(n.mapValue,e.mapValue);default:throw A()}}function Xh(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return M(n,e);const t=ht(n),i=ht(e),r=M(t.seconds,i.seconds);return 0!==r?r:M(t.nanos,i.nanos)}function On(n){return Ma(n)}function Ma(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const i=ht(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?ft(n.bytesValue).toBase64():"referenceValue"in n?I.fromName(n.referenceValue).toString():"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=Ma(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${Ma(t.fields[o])}`;return r+"}"}(n.mapValue):A()}function en(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Fa(n){return!!n&&"integerValue"in n}function Wi(n){return!!n&&"arrayValue"in n}function Jh(n){return!!n&&"nullValue"in n}function ef(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ts(n){return!!n&&"mapValue"in n}function Yi(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ct(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Yi(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Yi(n.arrayValue.values[t]);return e}return Object.assign({},n)}function tf(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function qb(n){return"nullValue"in n?ws:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?en(St.empty(),I.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:A()}function Gb(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?en(St.empty(),I.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Rt:A()}function nf(n,e){const t=Dt(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function rf(n,e){const t=Dt(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class we{constructor(e){this.value=e}static empty(){return new we({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Ts(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Yi(t)}setAll(e){let t=X.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=Yi(o):r.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());Ts(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return it(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Ts(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Ct(t,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new we(Yi(this.value))}}function sf(n){const e=[];return Ct(n.fields,(t,i)=>{const r=new X([t]);if(Ts(i)){const s=sf(i.mapValue).fields;if(0===s.length)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)}),new Ne(e)}class J{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new J(e,0,P.min(),P.min(),P.min(),we.empty(),0)}static newFoundDocument(e,t,i,r){return new J(e,1,t,P.min(),i,r,0)}static newNoDocument(e,t){return new J(e,2,t,P.min(),P.min(),we.empty(),0)}static newUnknownDocument(e,t){return new J(e,3,t,P.min(),P.min(),we.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(P.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=we.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=we.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=P.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof J&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new J(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class kt{constructor(e,t){this.position=e,this.inclusive=t}}function af(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(i=s.field.isKeyField()?I.comparator(I.fromName(o.referenceValue),t.key):Dt(o,t.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function lf(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!it(n.position[t],e.position[t]))return!1;return!0}class Qi{constructor(e,t="asc"){this.field=e,this.dir=t}}function jb(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class cf{}class z extends cf{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,i):new Hb(e,t,i):"array-contains"===t?new $b(e,i):"in"===t?new pf(e,i):"not-in"===t?new Wb(e,i):"array-contains-any"===t?new Yb(e,i):new z(e,t,i)}static createKeyFieldInFilter(e,t,i){return"in"===t?new Zb(e,i):new Kb(e,i)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Dt(t,this.value)):null!==t&&Pt(this.value)===Pt(t)&&this.matchesComparison(Dt(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return A()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class K extends cf{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new K(e,t)}matches(e){return Vn(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Vn(n){return"and"===n.op}function Oa(n){return"or"===n.op}function Va(n){return df(n)&&Vn(n)}function df(n){for(const e of n.filters)if(e instanceof K)return!1;return!0}function Na(n){if(n instanceof z)return n.field.canonicalString()+n.op.toString()+On(n.value);if(Va(n))return n.filters.map(e=>Na(e)).join(",");{const e=n.filters.map(t=>Na(t)).join(",");return`${n.op}(${e})`}}function uf(n,e){return n instanceof z?(i=n,(r=e)instanceof z&&i.op===r.op&&i.field.isEqual(r.field)&&it(i.value,r.value)):n instanceof K?function(i,r){return r instanceof K&&i.op===r.op&&i.filters.length===r.filters.length&&i.filters.reduce((s,o,a)=>s&&uf(o,r.filters[a]),!0)}(n,e):void A();var i,r}function hf(n,e){const t=n.filters.concat(e);return K.create(t,n.op)}function ff(n){return n instanceof z?`${(t=n).field.canonicalString()} ${t.op} ${On(t.value)}`:n instanceof K?function(t){return t.op.toString()+" {"+t.getFilters().map(ff).join(" ,")+"}"}(n):"Filter";var t}class Hb extends z{constructor(e,t,i){super(e,t,i),this.key=I.fromName(i.referenceValue)}matches(e){const t=I.comparator(e.key,this.key);return this.matchesComparison(t)}}class Zb extends z{constructor(e,t){super(e,"in",t),this.keys=mf(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Kb extends z{constructor(e,t){super(e,"not-in",t),this.keys=mf(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function mf(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(i=>I.fromName(i.referenceValue))}class $b extends z{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Wi(t)&&$i(t.arrayValue,this.value)}}class pf extends z{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&$i(this.value.arrayValue,t)}}class Wb extends z{constructor(e,t){super(e,"not-in",t)}matches(e){if($i(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!$i(this.value.arrayValue,t)}}class Yb extends z{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Wi(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>$i(this.value.arrayValue,i))}}class Qb{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function La(n,e=null,t=[],i=[],r=null,s=null,o=null){return new Qb(n,e,t,i,r,s,o)}function tn(n){const e=w(n);if(null===e.ue){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>Na(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>{return(s=i).field.canonicalString()+s.dir;var s}).join(","),Hi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>On(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>On(i)).join(",")),e.ue=t}return e.ue}function Xi(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!jb(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!uf(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!lf(n.startAt,e.startAt)&&lf(n.endAt,e.endAt)}function As(n){return I.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function Cs(n,e){return n.filters.filter(t=>t instanceof z&&t.field.isEqual(e))}function _f(n,e,t){let i=ws,r=!0;for(const s of Cs(n,e)){let o=ws,a=!0;switch(s.op){case"<":case"<=":o=qb(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=ws}nf({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];nf({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}return{value:i,inclusive:r}}function gf(n,e,t){let i=Rt,r=!0;for(const s of Cs(n,e)){let o=Rt,a=!0;switch(s.op){case">=":case">":o=Gb(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Rt}rf({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];rf({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}return{value:i,inclusive:r}}class mt{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null}}function yf(n,e,t,i,r,s,o,a){return new mt(n,e,t,i,r,s,o,a)}function Nn(n){return new mt(n)}function vf(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function Ba(n){return null!==n.collectionGroup}function Ln(n){const e=w(n);if(null===e.ce){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new $(X.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Qi(s,i))}),t.has(X.keyField().canonicalString())||e.ce.push(new Qi(X.keyField(),i))}return e.ce}function Me(n){const e=w(n);return e.le||(e.le=function xf(n,e){if("F"===n.limitType)return La(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>new Qi(r.field,"desc"===r.dir?"asc":"desc"));const t=n.endAt?new kt(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new kt(n.startAt.position,n.startAt.inclusive):null;return La(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}(e,Ln(n))),e.le}function za(n,e){const t=n.filters.concat([e]);return new mt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Ss(n,e,t){return new mt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ji(n,e){return Xi(Me(n),Me(e))&&n.limitType===e.limitType}function bf(n){return`${tn(Me(n))}|lt:${n.limitType}`}function Bn(n){return`Query(target=${function(t){let i=t.path.canonicalString();return null!==t.collectionGroup&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>ff(r)).join(", ")}]`),Hi(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>{return`${(o=r).field.canonicalString()} (${o.dir})`;var o}).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>On(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>On(r)).join(",")),`Target(${i})`}(Me(n))}; limitType=${n.limitType})`}function er(n,e){return e.isFoundDocument()&&function(i,r){const s=r.key.path;return null!==i.collectionGroup?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):I.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,e)&&function(i,r){for(const s of Ln(i))if(!s.field.isKeyField()&&null===r.data.field(s.field))return!1;return!0}(n,e)&&function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0}(n,e)&&(r=e,!((i=n).startAt&&!function(o,a,c){const d=af(o,a,c);return o.inclusive?d<=0:d<0}(i.startAt,Ln(i),r)||i.endAt&&!function(o,a,c){const d=af(o,a,c);return o.inclusive?d>=0:d>0}(i.endAt,Ln(i),r)));var i,r}function Ef(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wf(n){return(e,t)=>{let i=!1;for(const r of Ln(n)){const s=Xb(r,e,t);if(0!==s)return s;i=i||r.field.isKeyField()}return 0}}function Xb(n,e,t){const i=n.field.isKeyField()?I.comparator(e.key,t.key):function(s,o,a){const c=o.data.field(s),d=a.data.field(s);return null!==c&&null!==d?Dt(c,d):A()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return A()}}class pt{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0!==i)for(const[r,s]of i)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(void 0===r)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0===i)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return 1===i.length?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ct(this.inner,(t,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return Wh(this.inner)}size(){return this.innerSize}}const Jb=new W(I.comparator);function Le(){return Jb}const If=new W(I.comparator);function tr(...n){let e=If;for(const t of n)e=e.insert(t.key,t);return e}function Tf(n){let e=If;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function rt(){return nr()}function Af(){return nr()}function nr(){return new pt(n=>n.toString(),(n,e)=>n.isEqual(e))}const eE=new W(I.comparator),tE=new $(I.comparator);function V(...n){let e=tE;for(const t of n)e=e.add(t);return e}const nE=new $(M);function Ua(){return nE}function Cf(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Zi(e)?"-0":e}}function Sf(n){return{integerValue:""+n}}function Rf(n,e){return zh(e)?Sf(e):Cf(n,e)}class Rs{constructor(){this._=void 0}}function iE(n,e,t){return n instanceof zn?function(r,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&bs(s)&&(s=Es(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof nn?Df(n,e):n instanceof rn?kf(n,e):function(r,s){const o=Pf(r,s),a=Mf(o)+Mf(r.Pe);return Fa(o)&&Fa(r.Pe)?Sf(a):Cf(r.serializer,a)}(n,e)}function rE(n,e,t){return n instanceof nn?Df(n,e):n instanceof rn?kf(n,e):t}function Pf(n,e){return n instanceof Un?Fa(i=e)||(s=i)&&"doubleValue"in s?e:{integerValue:0}:null;var i,s}class zn extends Rs{}class nn extends Rs{constructor(e){super(),this.elements=e}}function Df(n,e){const t=Ff(e);for(const i of n.elements)t.some(r=>it(r,i))||t.push(i);return{arrayValue:{values:t}}}class rn extends Rs{constructor(e){super(),this.elements=e}}function kf(n,e){let t=Ff(e);for(const i of n.elements)t=t.filter(r=>!it(r,i));return{arrayValue:{values:t}}}class Un extends Rs{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Mf(n){return se(n.integerValue||n.doubleValue)}function Ff(n){return Wi(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class ir{constructor(e,t){this.field=e,this.transform=t}}class oE{constructor(e,t){this.version=e,this.transformResults=t}}class ne{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ne}static exists(e){return new ne(void 0,e)}static updateTime(e){return new ne(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ps(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class Ds{}function Of(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new Gn(n.key,ne.none()):new qn(n.key,n.data,ne.none());{const t=n.data,i=we.empty();let r=new $(X.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?i.delete(s):i.set(s,o),r=r.add(s)}return new _t(n.key,i,new Ne(r.toArray()),ne.none())}}function aE(n,e,t){n instanceof qn?function(r,s,o){const a=r.value.clone(),c=Lf(r.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof _t?function(r,s,o){if(!Ps(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=Lf(r.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Nf(r)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function rr(n,e,t,i){return n instanceof qn?function(s,o,a,c){if(!Ps(s.precondition,o))return a;const d=s.value.clone(),u=Bf(s.fieldTransforms,c,o);return d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(n,e,t,i):n instanceof _t?function(s,o,a,c){if(!Ps(s.precondition,o))return a;const d=Bf(s.fieldTransforms,c,o),u=o.data;return u.setAll(Nf(s)),u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null===a?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,i):(a=t,Ps(n.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a);var o,a}function lE(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=Pf(i.transform,r||null);null!=s&&(null===t&&(t=we.empty()),t.set(i.field,s))}return t||null}function Vf(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(i=n.fieldTransforms)&&void 0===r||i&&r&&Dn(i,r,(s,o)=>function sE(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(i=n.transform)instanceof nn&&r instanceof nn||i instanceof rn&&r instanceof rn?Dn(i.elements,r.elements,it):i instanceof Un&&r instanceof Un?it(i.Pe,r.Pe):i instanceof zn&&r instanceof zn);var i,r}(s,o))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var i,r}class qn extends Ds{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class _t extends Ds{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Nf(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function Lf(n,e,t){const i=new Map;S(n.length===t.length);for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,rE(o,a,t[r]))}return i}function Bf(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,iE(s,o,e))}return i}class Gn extends Ds{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qa extends Ds{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ga{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&aE(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=rr(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=rr(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=Af();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const c=Of(o,a);null!==c&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(P.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),V())}isEqual(e){return this.batchId===e.batchId&&Dn(this.mutations,e.mutations,(t,i)=>Vf(t,i))&&Dn(this.baseMutations,e.baseMutations,(t,i)=>Vf(t,i))}}class ja{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){S(e.mutations.length===i.length);let r=eE;const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new ja(e,t,i,r)}}class Ha{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class dE{constructor(e,t){this.count=e,this.unchangedNames=t}}var ue,U;function zf(n){switch(n){default:return A();case _.CANCELLED:case _.UNKNOWN:case _.DEADLINE_EXCEEDED:case _.RESOURCE_EXHAUSTED:case _.INTERNAL:case _.UNAVAILABLE:case _.UNAUTHENTICATED:return!1;case _.INVALID_ARGUMENT:case _.NOT_FOUND:case _.ALREADY_EXISTS:case _.PERMISSION_DENIED:case _.FAILED_PRECONDITION:case _.ABORTED:case _.OUT_OF_RANGE:case _.UNIMPLEMENTED:case _.DATA_LOSS:return!0}}function Uf(n){if(void 0===n)return ae("GRPC error has no .code"),_.UNKNOWN;switch(n){case ue.OK:return _.OK;case ue.CANCELLED:return _.CANCELLED;case ue.UNKNOWN:return _.UNKNOWN;case ue.DEADLINE_EXCEEDED:return _.DEADLINE_EXCEEDED;case ue.RESOURCE_EXHAUSTED:return _.RESOURCE_EXHAUSTED;case ue.INTERNAL:return _.INTERNAL;case ue.UNAVAILABLE:return _.UNAVAILABLE;case ue.UNAUTHENTICATED:return _.UNAUTHENTICATED;case ue.INVALID_ARGUMENT:return _.INVALID_ARGUMENT;case ue.NOT_FOUND:return _.NOT_FOUND;case ue.ALREADY_EXISTS:return _.ALREADY_EXISTS;case ue.PERMISSION_DENIED:return _.PERMISSION_DENIED;case ue.FAILED_PRECONDITION:return _.FAILED_PRECONDITION;case ue.ABORTED:return _.ABORTED;case ue.OUT_OF_RANGE:return _.OUT_OF_RANGE;case ue.UNIMPLEMENTED:return _.UNIMPLEMENTED;case ue.DATA_LOSS:return _.DATA_LOSS;default:return A()}}(U=ue||(ue={}))[U.OK=0]="OK",U[U.CANCELLED=1]="CANCELLED",U[U.UNKNOWN=2]="UNKNOWN",U[U.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",U[U.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",U[U.NOT_FOUND=5]="NOT_FOUND",U[U.ALREADY_EXISTS=6]="ALREADY_EXISTS",U[U.PERMISSION_DENIED=7]="PERMISSION_DENIED",U[U.UNAUTHENTICATED=16]="UNAUTHENTICATED",U[U.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",U[U.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",U[U.ABORTED=10]="ABORTED",U[U.OUT_OF_RANGE=11]="OUT_OF_RANGE",U[U.UNIMPLEMENTED=12]="UNIMPLEMENTED",U[U.INTERNAL=13]="INTERNAL",U[U.UNAVAILABLE=14]="UNAVAILABLE",U[U.DATA_LOSS=15]="DATA_LOSS";function qf(){return new TextEncoder}const uE=new Sn([4294967295,4294967295],0);function Gf(n){const e=qf().encode(n),t=new rb;return t.update(e),new Uint8Array(t.digest())}function jf(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Sn([t,i],0),new Sn([r,s],0)]}class Za{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new sr(`Invalid padding: ${t}`);if(i<0)throw new sr(`Invalid hash count: ${i}`);if(e.length>0&&0===this.hashCount)throw new sr(`Invalid hash count: ${i}`);if(0===e.length&&0!==t)throw new sr(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Sn.fromNumber(this.Ie)}Ee(e,t,i){let r=e.add(t.multiply(Sn.fromNumber(i)));return 1===r.compare(uE)&&(r=new Sn([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=Gf(e),[i,r]=jf(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(i,r,s);if(!this.de(o))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Za(s,r,t);return i.forEach(a=>o.insert(a)),o}insert(e){if(0===this.Ie)return;const t=Gf(e),[i,r]=jf(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(i,r,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class sr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class or{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,ar.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new or(P.min(),r,new W(M),Le(),V())}}class ar{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new ar(i,t,V(),V(),V())}}class Ms{constructor(e,t,i,r){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=r}}class Hf{constructor(e,t){this.targetId=e,this.me=t}}class Zf{constructor(e,t,i=me.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class Kf{constructor(){this.fe=0,this.ge=Wf(),this.pe=me.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=V(),t=V(),i=V();return this.ge.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:A()}}),new ar(this.pe,this.ye,e,t,i)}ve(){this.we=!1,this.ge=Wf()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,S(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class hE{constructor(e){this.Le=e,this.Be=new Map,this.ke=Le(),this.qe=$f(),this.Qe=new W(M)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.ve(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:A()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((i,r)=>{this.ze(r)&&t(r)})}He(e){const t=e.targetId,i=e.me.count,r=this.Je(t);if(r){const s=r.target;if(As(s))if(0===i){const o=new I(s.path);this.Ue(t,o,J.newNoDocument(o,P.min()))}else S(1===i);else{const o=this.Ye(t);if(o!==i){const a=this.Ze(e),c=a?this.Xe(a,e,o):1;0!==c&&(this.je(t),this.Qe=this.Qe.insert(t,2===c?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=ft(i).toUint8Array()}catch(c){if(c instanceof Qh)return Ve("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Za(o,r,s)}catch(c){return Ve(c instanceof sr?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return 0===a.Ie?null:a}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){const i=this.Le.getRemoteKeysForTarget(t);let r=0;return i.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),r++)}),r}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&As(a.target)){const c=new I(a.target.path);null!==this.ke.get(c)||this.it(o,c)||this.Ue(o,c,J.newNoDocument(c,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let i=V();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{const d=this.Je(c);return!d||"TargetPurposeLimboResolution"===d.purpose||(a=!1,!1)}),a&&(i=i.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const r=new or(e,t,this.Qe,this.ke,i);return this.ke=Le(),this.qe=$f(),this.Qe=new W(M),r}$e(e,t){if(!this.ze(e))return;const i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Kf,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new $(M),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||E("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Kf),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function $f(){return new W(I.comparator)}function Wf(){return new W(I.comparator)}const fE={asc:"ASCENDING",desc:"DESCENDING"},mE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pE={and:"AND",or:"OR"};class _E{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ka(n,e){return n.useProto3Json||Hi(e)?e:{value:e}}function jn(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Yf(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function gE(n,e){return jn(n,e.toTimestamp())}function le(n){return S(!!n),P.fromTimestamp(function(t){const i=ht(t);return new te(i.seconds,i.nanos)}(n))}function $a(n,e){return Wa(n,e).canonicalString()}function Wa(n,e){const t=(r=n,new B(["projects",r.projectId,"databases",r.database])).child("documents");var r;return void 0===e?t:t.child(e)}function Qf(n){const e=B.fromString(n);return S(am(e)),e}function lr(n,e){return $a(n.databaseId,e.path)}function st(n,e){const t=Qf(e);if(t.get(1)!==n.databaseId.projectId)throw new x(_.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new x(_.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new I(em(t))}function Xf(n,e){return $a(n.databaseId,e)}function Jf(n){const e=Qf(n);return 4===e.length?B.emptyPath():em(e)}function Ya(n){return new B(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function em(n){return S(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function tm(n,e,t){return{name:lr(n,e),fields:t.value.mapValue.fields}}function nm(n,e,t){const i=st(n,e.name),r=le(e.updateTime),s=e.createTime?le(e.createTime):P.min(),o=new we({mapValue:{fields:e.fields}}),a=J.newFoundDocument(i,r,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function cr(n,e){let t;if(e instanceof qn)t={update:tm(n,e.key,e.value)};else if(e instanceof Gn)t={delete:lr(n,e.key)};else if(e instanceof _t)t={update:tm(n,e.key,e.data),updateMask:TE(e.fieldMask)};else{if(!(e instanceof qa))return A();t={verify:lr(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,o){const a=o.transform;if(a instanceof zn)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof nn)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof rn)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Un)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw A()}(0,i))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:gE(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:A()),t;var s}function Qa(n,e){const t=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?ne.updateTime(le(s.updateTime)):void 0!==s.exists?ne.exists(s.exists):ne.none():ne.none(),i=e.updateTransforms?e.updateTransforms.map(r=>function(o,a){let c=null;"setToServerValue"in a?(S("REQUEST_TIME"===a.setToServerValue),c=new zn):"appendMissingElements"in a?c=new nn(a.appendMissingElements.values||[]):"removeAllFromArray"in a?c=new rn(a.removeAllFromArray.values||[]):"increment"in a?c=new Un(o,a.increment):A();const d=X.fromServerFormat(a.fieldPath);return new ir(d,c)}(n,r)):[];var s;if(e.update){const r=st(n,e.update.name),s=new we({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new Ne((e.updateMask.fieldPaths||[]).map(u=>X.fromServerFormat(u)));return new _t(r,s,o,t,i)}return new qn(r,s,t,i)}if(e.delete){const r=st(n,e.delete);return new Gn(r,t)}if(e.verify){const r=st(n,e.verify);return new qa(r,t)}return A()}function im(n,e){return{documents:[Xf(n,e.path)]}}function Xa(n,e){const t={structuredQuery:{}},i=e.path;let r;null!==e.collectionGroup?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Xf(n,r);const s=function(d){if(0!==d.length)return om(K.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(d){if(0!==d.length)return d.map(u=>{return{field:Mt((f=u).field),direction:EE(f.dir)};var f})}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Ka(n,e.limit);return null!==a&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt={before:(d=e.startAt).inclusive,values:d.position}),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:r};var d}function rm(n){let e=Jf(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){S(1===i);const u=t.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=function(h){const f=sm(h);return f instanceof K&&Va(f)?f.getFilters():[f]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(f=>{return new Qi(Hn((g=f).field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction));var g}));let a=null;t.limit&&(a=function(h){let f;return f="object"==typeof h?h.value:h,Hi(f)?null:f}(t.limit));let c=null;var h;t.startAt&&(c=new kt((h=t.startAt).values||[],!!h.before));let d=null;return t.endAt&&(d=function(h){return new kt(h.values||[],!h.before)}(t.endAt)),yf(e,r,o,s,a,"F",c,d)}function sm(n){return void 0!==n.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Hn(t.unaryFilter.field);return z.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Hn(t.unaryFilter.field);return z.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Hn(t.unaryFilter.field);return z.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Hn(t.unaryFilter.field);return z.create(o,"!=",{nullValue:"NULL_VALUE"});default:return A()}}(n):void 0!==n.fieldFilter?z.create(Hn((t=n).fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return A()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==n.compositeFilter?function(t){return K.create(t.compositeFilter.filters.map(i=>sm(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return A()}}(t.compositeFilter.op))}(n):A();var t}function EE(n){return fE[n]}function wE(n){return mE[n]}function IE(n){return pE[n]}function Mt(n){return{fieldPath:n.canonicalString()}}function Hn(n){return X.fromServerFormat(n.fieldPath)}function om(n){return n instanceof z?function(t){if("=="===t.op){if(ef(t.value))return{unaryFilter:{field:Mt(t.field),op:"IS_NAN"}};if(Jh(t.value))return{unaryFilter:{field:Mt(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ef(t.value))return{unaryFilter:{field:Mt(t.field),op:"IS_NOT_NAN"}};if(Jh(t.value))return{unaryFilter:{field:Mt(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mt(t.field),op:wE(t.op),value:t.value}}}(n):n instanceof K?function(t){const i=t.getFilters().map(r=>om(r));return 1===i.length?i[0]:{compositeFilter:{op:IE(t.op),filters:i}}}(n):A()}function TE(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function am(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class gt{constructor(e,t,i,r,s=P.min(),o=P.min(),a=me.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new gt(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new gt(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class lm{constructor(e){this.ut=e}}function cm(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Fs(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document={name:lr(s=n.ut,(o=e).key),fields:o.data.value.mapValue.fields,updateTime:jn(s,o.version.toTimestamp()),createTime:jn(s,o.createTime.toTimestamp())};else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:sn(e.version)};else{if(!e.isUnknownDocument())return A();i.unknownDocument={path:t.path.toArray(),version:sn(e.version)}}var s,o;return i}function Fs(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function sn(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function on(n){const e=new te(n.seconds,n.nanoseconds);return P.fromTimestamp(e)}function an(n,e){const t=(e.baseMutations||[]).map(s=>Qa(n.ut,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const i=e.mutations.map(s=>Qa(n.ut,s)),r=te.fromMillis(e.localWriteTimeMs);return new Ga(e.batchId,r,t,i)}function dr(n){const e=on(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?on(n.lastLimboFreeSnapshotVersion):P.min();let i;return i=void 0!==n.query.documents?(S(1===(s=n.query).documents.length),Me(Nn(Jf(s.documents[0])))):function(s){return Me(rm(s))}(n.query),new gt(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,me.fromBase64String(n.resumeToken));var s}function dm(n,e){const t=sn(e.snapshotVersion),i=sn(e.lastLimboFreeSnapshotVersion);let r;r=As(e.target)?im(n.ut,e.target):Xa(n.ut,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:tn(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function Ja(n){const e=rm({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Ss(e,e.limit,"L"):e}function el(n,e){return new Ha(e.largestBatchId,Qa(n.ut,e.overlayMutation))}function um(n,e){const t=e.path.lastSegment();return[n,Se(e.path.popLast()),t]}function hm(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:sn(i.readTime),documentKey:Se(i.documentKey.path),largestBatchId:i.largestBatchId}}class CE{getBundleMetadata(e,t){return fm(e).get(t).next(i=>{if(i)return{id:(s=i).bundleId,createTime:on(s.createTime),version:s.version};var s})}saveBundleMetadata(e,t){return fm(e).put({bundleId:(r=t).id,createTime:sn(le(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return mm(e).get(t).next(i=>{if(i)return{name:(s=i).name,query:Ja(s.bundledQuery),readTime:on(s.readTime)};var s})}saveNamedQuery(e,t){return mm(e).put({name:(r=t).name,readTime:sn(le(r.readTime)),bundledQuery:r.bundledQuery});var r}}function fm(n){return ye(n,"bundles")}function mm(n){return ye(n,"namedQueries")}class Os{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){return new Os(e,t.uid||"")}getOverlay(e,t){return ur(e).get(um(this.userId,t)).next(i=>i?el(this.serializer,i):null)}getOverlays(e,t){const i=rt();return p.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){const r=[];return i.forEach((s,o)=>{const a=new Ha(t,o);r.push(this.lt(e,a))}),p.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach(o=>r.add(Se(o.getCollectionPath())));const s=[];return r.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(ur(e).j("collectionPathOverlayIndex",a))}),p.waitFor(s)}getOverlaysForCollection(e,t,i){const r=rt(),s=Se(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ur(e).U("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const d=el(this.serializer,c);r.set(d.getKey(),d)}return r})}getOverlaysForCollectionGroup(e,t,i,r){const s=rt();let o;const a=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ur(e).J({index:"collectionGroupOverlayIndex",range:a},(c,d,u)=>{const h=el(this.serializer,d);s.size()<r||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>s)}lt(e,t){return ur(e).put(function(r,s,o){const[a,c,d]=um(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:cr(r.ut,o.mutation)}}(this.serializer,this.userId,t))}}function ur(n){return ye(n,"documentOverlays")}class ln{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(se(e.integerValue));else if("doubleValue"in e){const i=se(e.doubleValue);isNaN(i)?this.Tt(t,13):(this.Tt(t,15),Zi(i)?t.Et(0):t.Et(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Tt(t,20),"string"==typeof i&&(i=ht(i)),t.dt(`${i.seconds||""}`),t.Et(i.nanos||0)}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(ft(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Tt(t,45),t.Et(i.latitude||0),t.Et(i.longitude||0)}else"mapValue"in e?tf(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):A()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const i=e.fields||{};this.Tt(t,55);for(const r of Object.keys(i))this.At(r,t),this.Pt(i[r],t)}yt(e,t){const i=e.values||[];this.Tt(t,50);for(const r of i)this.Pt(r,t)}ft(e,t){this.Tt(t,37),I.fromName(e).path.forEach(i=>{this.Tt(t,60),this.wt(i,t)})}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}function SE(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function pm(n){const e=64-function(i){let r=0;for(let s=0;s<8;++s){const o=SE(255&i[s]);if(r+=o,8!==o)break}return r}(n);return Math.ceil(e/8)}ln.St=new ln;class RE{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Dt(i.value),i=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ft(i.value),i=t.next();this.Mt()}xt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Dt(i);else if(i<2048)this.Dt(960|i>>>6),this.Dt(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.Dt(480|i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i);else{const r=t.codePointAt(0);this.Dt(240|r>>>18),this.Dt(128|63&r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r)}}this.Ct()}Ot(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ft(i);else if(i<2048)this.Ft(960|i>>>6),this.Ft(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i);else{const r=t.codePointAt(0);this.Ft(240|r>>>18),this.Ft(128|63&r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r)}}this.Mt()}Nt(e){const t=this.Lt(e),i=pm(t);this.Bt(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}kt(e){const t=this.Lt(e),i=pm(t);this.Bt(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Bt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Lt(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),i=0!=(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Dt(e){const t=255&e;0===t?(this.Qt(0),this.Qt(255)):255===t?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;0===t?(this.$t(0),this.$t(255)):255===t?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Bt(1),this.buffer[this.position++]=e}$t(e){this.Bt(1),this.buffer[this.position++]=~e}Bt(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class PE{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class DE{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class hr{constructor(){this.Wt=new RE,this.Gt=new PE(this.Wt),this.zt=new DE(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return 0===e?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class cn{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}Ht(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new cn(this.indexId,this.documentKey,this.arrayValue,i)}}function Ft(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=_m(n.arrayValue,e.arrayValue),0!==t?t:(t=_m(n.directionalValue,e.directionalValue),0!==t?t:I.comparator(n.documentKey,e.documentKey)))}function _m(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(0!==i)return i}return n.length-e.length}class gm{constructor(e){this.Jt=new $((t,i)=>X.comparator(t.field,i.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const i=t;i.isInequality()?this.Jt=this.Jt.add(i):this.Zt.push(i)}}get Xt(){return this.Jt.size>1}en(e){if(S(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=Sa(e);if(void 0!==t&&!this.tn(t))return!1;const i=Qt(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.tn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.Jt.size>0){const a=this.Jt.getIterator().getNext();if(!r.has(a.field.canonicalString())){const c=i[s];if(!this.nn(a,c)||!this.rn(this.Yt[o++],c))return!1}++s}for(;s<i.length;++s)if(o>=this.Yt.length||!this.rn(this.Yt[o++],i[s]))return!1;return!0}sn(){if(this.Xt)return null;let e=new $(X.comparator);const t=[];for(const i of this.Zt)if(!i.field.isKeyField())if("array-contains"===i.op||"array-contains-any"===i.op)t.push(new Xt(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Xt(i.field,0))}for(const i of this.Yt)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Xt(i.field,"asc"===i.dir?0:1)));return new kn(kn.UNKNOWN_ID,this.collectionId,t,Mn.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function ym(n){var e,t;if(S(n instanceof z||n instanceof K),n instanceof z){if(n instanceof pf){const r=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>z.create(n.field,"==",s)))||[];return K.create(r,"or")}return n}const i=n.filters.map(r=>ym(r));return K.create(i,n.op)}function kE(n){if(0===n.getFilters().length)return[];const e=il(ym(n));return S(vm(e)),tl(e)||nl(e)?[e]:e.getFilters()}function tl(n){return n instanceof z}function nl(n){return n instanceof K&&Va(n)}function vm(n){return tl(n)||nl(n)||function(t){if(t instanceof K&&Oa(t)){for(const i of t.getFilters())if(!tl(i)&&!nl(i))return!1;return!0}return!1}(n)}function il(n){if(S(n instanceof z||n instanceof K),n instanceof z)return n;if(1===n.filters.length)return il(n.filters[0]);const e=n.filters.map(i=>il(i));let t=K.create(e,n.op);return t=Vs(t),vm(t)?t:(S(t instanceof K),S(Vn(t)),S(t.filters.length>1),t.filters.reduce((i,r)=>rl(i,r)))}function rl(n,e){let t;return S(n instanceof z||n instanceof K),S(e instanceof z||e instanceof K),t=n instanceof z?e instanceof z?K.create([n,e],"and"):xm(n,e):e instanceof z?xm(e,n):function(r,s){if(S(r.filters.length>0&&s.filters.length>0),Vn(r)&&Vn(s))return hf(r,s.getFilters());const o=Oa(r)?r:s,a=Oa(r)?s:r,c=o.filters.map(d=>rl(d,a));return K.create(c,"or")}(n,e),Vs(t)}function xm(n,e){if(Vn(e))return hf(e,n.getFilters());{const t=e.filters.map(i=>rl(n,i));return K.create(t,"or")}}function Vs(n){if(S(n instanceof z||n instanceof K),n instanceof z)return n;const e=n.getFilters();if(1===e.length)return Vs(e[0]);if(df(n))return n;const t=e.map(r=>Vs(r)),i=[];return t.forEach(r=>{r instanceof z?i.push(r):r instanceof K&&(r.op===n.op?i.push(...r.filters):i.push(r))}),1===i.length?i[0]:K.create(i,n.op)}class ME{constructor(){this.on=new sl}addToCollectionParentIndex(e,t){return this.on.add(t),p.resolve()}getCollectionParents(e,t){return p.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return p.resolve()}deleteFieldIndex(e,t){return p.resolve()}deleteAllFieldIndexes(e){return p.resolve()}createTargetIndexes(e,t){return p.resolve()}getDocumentsMatchingTarget(e,t){return p.resolve(null)}getIndexType(e,t){return p.resolve(0)}getFieldIndexes(e,t){return p.resolve([])}getNextCollectionGroupToUpdate(e){return p.resolve(null)}getMinOffset(e,t){return p.resolve(Ue.min())}getMinOffsetFromCollectionGroup(e,t){return p.resolve(Ue.min())}updateCollectionGroup(e,t,i){return p.resolve()}updateIndexEntries(e,t){return p.resolve()}}class sl{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new $(B.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new $(B.comparator)).toArray()}}const Ns=new Uint8Array(0);class FE{constructor(e,t){this.databaseId=t,this._n=new sl,this.an=new pt(i=>tn(i),(i,r)=>Xi(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this._n.add(t)});const s={collectionId:i,parent:Se(r)};return bm(e).put(s)}return p.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[Mh(t),""],!1,!0);return bm(e).U(r).next(s=>{for(const o of s){if(o.collectionId!==t)break;i.push(nt(o.parent))}return i})}addFieldIndex(e,t){const i=fr(e),r={indexId:(a=t).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])};var a;delete r.indexId;const s=i.add(r);if(t.indexState){const o=Kn(e);return s.next(a=>{o.put(hm(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const i=fr(e),r=Kn(e),s=Zn(e);return i.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=fr(e),i=Zn(e),r=Kn(e);return t.j().next(()=>i.j()).next(()=>r.j())}createTargetIndexes(e,t){return p.forEach(this.un(t),i=>this.getIndexType(e,i).next(r=>{if(0===r||1===r){const s=new gm(i).sn();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const i=Zn(e);let r=!0;const s=new Map;return p.forEach(this.un(t),o=>this.cn(e,o).next(a=>{r&&(r=!!a),s.set(o,a)})).next(()=>{if(r){let o=V();const a=[];return p.forEach(s,(c,d)=>{var R;E("IndexedDbIndexManager",`Using index ${R=c,`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map(O=>`${O.fieldPath}:${O.kind}`).join(",")}`} to execute ${tn(t)}`);const u=function(R,O){const q=Sa(O);if(void 0===q)return null;for(const H of Cs(R,q.fieldPath))switch(H.op){case"array-contains-any":return H.value.arrayValue.values||[];case"array-contains":return[H.value]}return null}(d,c),h=function(R,O){const q=new Map;for(const H of Qt(O))for(const ce of Cs(R,H.fieldPath))switch(ce.op){case"==":case"in":q.set(H.fieldPath.canonicalString(),ce.value);break;case"not-in":case"!=":return q.set(H.fieldPath.canonicalString(),ce.value),Array.from(q.values())}return null}(d,c),f=function(R,O){const q=[];let H=!0;for(const ce of Qt(O)){const Ze=0===ce.kind?_f(R,ce.fieldPath,R.startAt):gf(R,ce.fieldPath,R.startAt);q.push(Ze.value),H&&(H=Ze.inclusive)}return new kt(q,H)}(d,c),m=function(R,O){const q=[];let H=!0;for(const ce of Qt(O)){const Ze=0===ce.kind?gf(R,ce.fieldPath,R.endAt):_f(R,ce.fieldPath,R.endAt);q.push(Ze.value),H&&(H=Ze.inclusive)}return new kt(q,H)}(d,c),g=this.ln(c,d,f),v=this.ln(c,d,m),b=this.hn(c,d,h),C=this.Pn(c.indexId,u,g,f.inclusive,v,m.inclusive,b);return p.forEach(C,k=>i.G(k,t.limit).next(R=>{R.forEach(O=>{const q=I.fromSegments(O.documentKey);o.has(q)||(o=o.add(q),a.push(q))})}))}).next(()=>a)}return p.resolve(null)})}un(e){let t=this.an.get(e);return t||(t=0===e.filters.length?[e]:kE(K.create(e.filters,"and")).map(i=>La(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,t),t)}Pn(e,t,i,r,s,o,a){const c=(null!=t?t.length:1)*Math.max(i.length,s.length),d=c/(null!=t?t.length:1),u=[];for(let h=0;h<c;++h){const f=t?this.In(t[h/d]):Ns,m=this.Tn(e,f,i[h%d],r),g=this.En(e,f,s[h%d],o),v=a.map(b=>this.Tn(e,f,b,!0));u.push(...this.createRange(m,g,v))}return u}Tn(e,t,i,r){const s=new cn(e,I.empty(),t,i);return r?s:s.Ht()}En(e,t,i,r){const s=new cn(e,I.empty(),t,i);return r?s.Ht():s}cn(e,t){const i=new gm(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let o=null;for(const a of s)i.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let i=2;const r=this.un(t);return p.forEach(r,s=>this.cn(e,s).next(o=>{o?0!==i&&o.fields.length<function(c){let d=new $(X.comparator),u=!1;for(const h of c.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||("array-contains"===f.op||"array-contains-any"===f.op?u=!0:d=d.add(f.field));for(const h of c.orderBy)h.field.isKeyField()||(d=d.add(h.field));return d.size+(u?1:0)}(s)&&(i=1):i=0})).next(()=>null!==t.limit&&r.length>1&&2===i?1:i)}dn(e,t){const i=new hr;for(const r of Qt(e)){const s=t.data.field(r.fieldPath);if(null==s)return null;const o=i.jt(r.kind);ln.St.ht(s,o)}return i.Ut()}In(e){const t=new hr;return ln.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const i=new hr;return ln.St.ht(en(this.databaseId,t),i.jt(function(s){const o=Qt(s);return 0===o.length?0:o[o.length-1].kind}(e))),i.Ut()}hn(e,t,i){if(null===i)return[];let r=[];r.push(new hr);let s=0;for(const o of Qt(e)){const a=i[s++];for(const c of r)if(this.Rn(t,o.fieldPath)&&Wi(a))r=this.Vn(r,o,a);else{const d=c.jt(o.kind);ln.St.ht(a,d)}}return this.mn(r)}ln(e,t,i){return this.hn(e,t,i.position)}mn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].Ut();return t}Vn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const a of r){const c=new hr;c.seed(a.Ut()),ln.St.ht(o,c.jt(t.kind)),s.push(c)}return s}Rn(e,t){return!!e.filters.find(i=>i instanceof z&&i.field.isEqual(t)&&("in"===i.op||"not-in"===i.op))}getFieldIndexes(e,t){const i=fr(e),r=Kn(e);return(t?i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):i.U()).next(s=>{const o=[];return p.forEach(s,a=>r.get([a.indexId,this.uid]).next(c=>{o.push(function(u,h){const f=h?new Mn(h.sequenceNumber,new Ue(on(h.readTime),new I(nt(h.documentKey)),h.largestBatchId)):Mn.empty(),m=u.fields.map(([g,v])=>new Xt(X.fromServerFormat(g),v));return new kn(u.indexId,u.collectionGroup,m,f)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==s?s:M(i.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){const r=fr(e),s=Kn(e);return this.fn(e).next(o=>r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>p.forEach(a,c=>s.put(hm(c.indexId,this.uid,o,i)))))}updateIndexEntries(e,t){const i=new Map;return p.forEach(t,(r,s)=>{const o=i.get(r.collectionGroup);return(o?p.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(a=>(i.set(r.collectionGroup,a),p.forEach(a,c=>this.gn(e,r,c).next(d=>{const u=this.pn(s,c);return d.isEqual(u)?p.resolve():this.yn(e,s,c,d,u)}))))})}wn(e,t,i,r){return Zn(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.An(i,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,i,r){return Zn(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.An(i,t.key),t.key.path.toArray()])}gn(e,t,i){const r=Zn(e);let s=new $(Ft);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.An(i,t)])},(o,a)=>{s=s.add(new cn(i.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,t){let i=new $(Ft);const r=this.dn(t,e);if(null==r)return i;const s=Sa(t);if(null!=s){const o=e.data.field(s.fieldPath);if(Wi(o))for(const a of o.arrayValue.values||[])i=i.add(new cn(t.indexId,e.key,this.In(a),r))}else i=i.add(new cn(t.indexId,e.key,Ns,r));return i}yn(e,t,i,r,s){E("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(c,d,u,h,f){const m=c.getIterator(),g=d.getIterator();let v=Fn(m),b=Fn(g);for(;v||b;){let C=!1,k=!1;if(v&&b){const R=u(v,b);R<0?k=!0:R>0&&(C=!0)}else null!=v?k=!0:C=!0;C?(h(b),b=Fn(g)):k?(f(v),v=Fn(m)):(v=Fn(m),b=Fn(g))}}(r,s,Ft,a=>{o.push(this.wn(e,t,i,a))},a=>{o.push(this.Sn(e,t,i,a))}),p.waitFor(o)}fn(e){let t=1;return Kn(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,s)=>{s.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((o,a)=>Ft(o,a)).filter((o,a,c)=>!a||0!==Ft(o,c[a-1]));const r=[];r.push(e);for(const o of i){const a=Ft(o,e),c=Ft(o,t);if(0===a)r[0]=e.Ht();else if(a>0&&c<0)r.push(o),r.push(o.Ht());else if(c>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.bn(r[o],r[o+1]))return[];s.push(IDBKeyRange.bound([r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,Ns,[]],[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,Ns,[]]))}return s}bn(e,t){return Ft(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Em)}getMinOffset(e,t){return p.mapArray(this.un(t),i=>this.cn(e,i).next(r=>r||A())).next(Em)}}function bm(n){return ye(n,"collectionParents")}function Zn(n){return ye(n,"indexEntries")}function fr(n){return ye(n,"indexConfiguration")}function Kn(n){return ye(n,"indexState")}function Em(n){S(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;Ra(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ue(e.readTime,e.documentKey,t)}const wm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Re{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new Re(e,Re.DEFAULT_COLLECTION_PERCENTILE,Re.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Im(n,e,t){const i=n.store("mutations"),r=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const c=i.J({range:o},(u,h,f)=>(a++,f.delete()));s.push(c.next(()=>{S(1===a)}));const d=[];for(const u of t.mutations){const h=Gh(e,u.key.path,t.batchId);s.push(r.delete(h)),d.push(u.key)}return p.waitFor(s).next(()=>d)}function Ls(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw A();e=n.noDocument}return JSON.stringify(e).length}Re.DEFAULT_COLLECTION_PERCENTILE=10,Re.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Re.DEFAULT=new Re(41943040,Re.DEFAULT_COLLECTION_PERCENTILE,Re.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Re.DISABLED=new Re(-1,0,0);class Bs{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Dn={}}static ct(e,t,i,r){S(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new Bs(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ot(e).J({index:"userMutationsIndex",range:i},(r,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,i,r){const s=$n(e),o=Ot(e);return o.add({}).next(a=>{S("number"==typeof a);const c=new Ga(a,t,i,r),d=function(m,g,v){const b=v.baseMutations.map(k=>cr(m.ut,k)),C=v.mutations.map(k=>cr(m.ut,k));return{userId:g,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:b,mutations:C}}(this.serializer,this.userId,c),u=[];let h=new $((f,m)=>M(f.canonicalString(),m.canonicalString()));for(const f of r){const m=Gh(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),u.push(o.put(d)),u.push(s.put(m,Eb))}return h.forEach(f=>{u.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Dn[a]=c.keys()}),p.waitFor(u).next(()=>c)})}lookupMutationBatch(e,t){return Ot(e).get(t).next(i=>i?(S(i.userId===this.userId),an(this.serializer,i)):null)}Cn(e,t){return this.Dn[t]?p.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){const r=i.keys();return this.Dn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Ot(e).J({index:"userMutationsIndex",range:r},(o,a,c)=>{a.userId===this.userId&&(S(a.batchId>=i),s=an(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return Ot(e).J({index:"userMutationsIndex",range:t,reverse:!0},(r,s,o)=>{i=s.batchId,o.done()}).next(()=>i)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ot(e).U("userMutationsIndex",t).next(i=>i.map(r=>an(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=vs(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return $n(e).J({range:r},(o,a,c)=>{const[d,u,h]=o,f=nt(u);if(d===this.userId&&t.path.isEqual(f))return Ot(e).get(h).next(m=>{if(!m)throw A();S(m.userId===this.userId),s.push(an(this.serializer,m))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new $(M);const r=[];return t.forEach(s=>{const o=vs(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=$n(e).J({range:a},(d,u,h)=>{const[f,m,g]=d,v=nt(m);f===this.userId&&s.path.isEqual(v)?i=i.add(g):h.done()});r.push(c)}),p.waitFor(r).next(()=>this.vn(e,i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=vs(this.userId,i),o=IDBKeyRange.lowerBound(s);let a=new $(M);return $n(e).J({range:o},(c,d,u)=>{const[h,f,m]=c,g=nt(f);h===this.userId&&i.isPrefixOf(g)?g.length===r&&(a=a.add(m)):u.done()}).next(()=>this.vn(e,a))}vn(e,t){const i=[],r=[];return t.forEach(s=>{r.push(Ot(e).get(s).next(o=>{if(null===o)throw A();S(o.userId===this.userId),i.push(an(this.serializer,o))}))}),p.waitFor(r).next(()=>i)}removeMutationBatch(e,t){return Im(e._e,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.Fn(t.batchId)}),p.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return p.resolve();const i=IDBKeyRange.lowerBound([this.userId]),r=[];return $n(e).J({range:i},(s,o,a)=>{if(s[0]===this.userId){const c=nt(s[1]);r.push(c)}else a.done()}).next(()=>{S(0===r.length)})})}containsKey(e,t){return Tm(e,this.userId,t)}Mn(e){return Am(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Tm(n,e,t){const i=vs(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return $n(n).J({range:s,H:!0},(a,c,d)=>{const[u,h,f]=a;u===e&&h===r&&(o=!0),d.done()}).next(()=>o)}function Ot(n){return ye(n,"mutations")}function $n(n){return ye(n,"documentMutations")}function Am(n){return ye(n,"mutationQueues")}class dn{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new dn(0)}static Nn(){return new dn(-1)}}class OE{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Ln(e).next(t=>{const i=new dn(t.highestTargetId);return t.highestTargetId=i.next(),this.Bn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(t=>P.fromTimestamp(new te(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.Ln(e).next(r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Bn(e,r)))}addTargetData(e,t){return this.kn(e,t).next(()=>this.Ln(e).next(i=>(i.targetCount+=1,this.qn(t,i),this.Bn(e,i))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Wn(e).delete(t.targetId)).next(()=>this.Ln(e)).next(i=>(S(i.targetCount>0),i.targetCount-=1,this.Bn(e,i)))}removeTargets(e,t,i){let r=0;const s=[];return Wn(e).J((o,a)=>{const c=dr(a);c.sequenceNumber<=t&&null===i.get(c.targetId)&&(r++,s.push(this.removeTargetData(e,c)))}).next(()=>p.waitFor(s)).next(()=>r)}forEachTarget(e,t){return Wn(e).J((i,r)=>{const s=dr(r);t(s)})}Ln(e){return Cm(e).get("targetGlobalKey").next(t=>(S(null!==t),t))}Bn(e,t){return Cm(e).put("targetGlobalKey",t)}kn(e,t){return Wn(e).put(dm(this.serializer,t))}qn(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.Ln(e).next(t=>t.targetCount)}getTargetData(e,t){const i=tn(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Wn(e).J({range:r,index:"queryTargetsIndex"},(o,a,c)=>{const d=dr(a);Xi(t,d.target)&&(s=d,c.done())}).next(()=>s)}addMatchingKeys(e,t,i){const r=[],s=Vt(e);return t.forEach(o=>{const a=Se(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(e,i,o))}),p.waitFor(r)}removeMatchingKeys(e,t,i){const r=Vt(e);return p.forEach(t,s=>{const o=Se(s.path);return p.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])})}removeMatchingKeysForTargetId(e,t){const i=Vt(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Vt(e);let s=V();return r.J({range:i,H:!0},(o,a,c)=>{const d=nt(o[1]),u=new I(d);s=s.add(u)}).next(()=>s)}containsKey(e,t){const i=Se(t.path),r=IDBKeyRange.bound([i],[Mh(i)],!1,!0);let s=0;return Vt(e).J({index:"documentTargetsIndex",H:!0,range:r},([o,a],c,d)=>{0!==o&&(s++,d.done())}).next(()=>s>0)}ot(e,t){return Wn(e).get(t).next(i=>i?dr(i):null)}}function Wn(n){return ye(n,"targets")}function Cm(n){return ye(n,"targetGlobal")}function Vt(n){return ye(n,"targetDocuments")}function Sm([n,e],[t,i]){const r=M(n,t);return 0===r?M(e,i):r}class VE{constructor(e){this.Qn=e,this.buffer=new $(Sm),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Sm(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Rm{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(e){var t=this;E("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,y.Z)(function*(){t.Wn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(i){At(i)?E("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",i):yield Tt(i)}yield t.Gn(3e5)}))}}class NE{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(0===t)return p.resolve(qe.oe);const i=new VE(t);return this.zn.forEachTarget(e,r=>i.Un(r.sequenceNumber)).next(()=>this.zn.Hn(e,r=>i.Un(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.zn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(E("LruGarbageCollector","Garbage collection skipped; disabled"),p.resolve(wm)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(E("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),wm):this.Jn(e,t))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let i,r,s,o,a,c,d;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(E("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,o=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(i=h,a=Date.now(),this.removeTargets(e,i,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,i))).next(h=>(d=Date.now(),Pn()<=Qe.in.DEBUG&&E("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-u}ms\n\tDetermined least recently used ${r} in `+(a-o)+`ms\n\tRemoved ${s} targets in `+(c-a)+`ms\n\tRemoved ${h} documents in `+(d-c)+`ms\nTotal Duration: ${d-u}ms`),p.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:h})))}}class LE{constructor(e,t){this.db=e,this.garbageCollector=function Pm(n,e){return new NE(n,e)}(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}Yn(e){let t=0;return this.Hn(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,(i,r)=>t(r))}addReference(e,t,i){return zs(e,i)}removeReference(e,t,i){return zs(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return zs(e,t)}Xn(e,t){return function(r,s){let o=!1;return Am(r).Y(a=>Tm(r,a,s).next(c=>(c&&(o=!0),p.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Zn(e,(o,a)=>{if(a<=t){const c=this.Xn(e,o).next(d=>{if(!d)return s++,i.getEntry(e,o).next(()=>(i.removeEntry(o,P.min()),Vt(e).delete([0,Se(o.path)])))});r.push(c)}}).next(()=>p.waitFor(r)).next(()=>i.apply(e)).next(()=>s)}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return zs(e,t)}Zn(e,t){const i=Vt(e);let r,s=qe.oe;return i.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:d})=>{0===o?(s!==qe.oe&&t(new I(nt(r)),s),s=d,r=c):s=qe.oe}).next(()=>{s!==qe.oe&&t(new I(nt(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function zs(n,e){return Vt(n).put((r=n.currentSequenceNumber,{targetId:0,path:Se(e.path),sequenceNumber:r}));var r}class Dm{constructor(){this.changes=new pt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,J.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return void 0!==i?p.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class BE{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return un(e).put(i)}removeEntry(e,t,i){return un(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Fs(o),a[a.length-1]]}(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.er(e,i)))}getEntry(e,t){let i=J.newInvalidDocument(t);return un(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(mr(t))},(r,s)=>{i=this.tr(t,s)}).next(()=>i)}nr(e,t){let i={size:0,document:J.newInvalidDocument(t)};return un(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(mr(t))},(r,s)=>{i={document:this.tr(t,s),size:Ls(s)}}).next(()=>i)}getEntries(e,t){let i=Le();return this.rr(e,t,(r,s)=>{const o=this.tr(r,s);i=i.insert(r,o)}).next(()=>i)}ir(e,t){let i=Le(),r=new W(I.comparator);return this.rr(e,t,(s,o)=>{const a=this.tr(s,o);i=i.insert(s,a),r=r.insert(s,Ls(o))}).next(()=>({documents:i,sr:r}))}rr(e,t,i){if(t.isEmpty())return p.resolve();let r=new $(Om);t.forEach(c=>r=r.add(c));const s=IDBKeyRange.bound(mr(r.first()),mr(r.last())),o=r.getIterator();let a=o.getNext();return un(e).J({index:"documentKeyIndex",range:s},(c,d,u)=>{const h=I.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&Om(a,h)<0;)i(a,null),a=o.getNext();a&&a.isEqual(h)&&(i(a,d),a=o.hasNext()?o.getNext():null),a?u.$(mr(a)):u.done()}).next(()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Fs(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return un(e).U(IDBKeyRange.bound(a,c,!0)).next(d=>{s?.incrementDocumentReadCount(d.length);let u=Le();for(const h of d){const f=this.tr(I.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(er(t,f)||r.has(f.key))&&(u=u.insert(f.key,f))}return u})}getAllFromCollectionGroup(e,t,i,r){let s=Le();const o=Fm(t,i),a=Fm(t,Ue.max());return un(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,d,u)=>{const h=this.tr(I.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);s=s.insert(h.key,h),s.size===r&&u.done()}).next(()=>s)}newChangeBuffer(e){return new zE(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Mm(e).get("remoteDocumentGlobalKey").next(t=>(S(!!t),t))}er(e,t){return Mm(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const i=function AE(n,e){let t;if(e.document)t=nm(n.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=I.fromSegments(e.noDocument.path),r=on(e.noDocument.readTime);t=J.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return A();{const i=I.fromSegments(e.unknownDocument.path),r=on(e.unknownDocument.version);t=J.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime(function(r){const s=new te(r[0],r[1]);return P.fromTimestamp(s)}(e.readTime)),t}(this.serializer,t);if(!i.isNoDocument()||!i.version.isEqual(P.min()))return i}return J.newInvalidDocument(e)}}function km(n){return new BE(n)}class zE extends Dm{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new pt(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){const t=[];let i=0,r=new $((s,o)=>M(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.ar.get(s);if(t.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){const c=cm(this._r.serializer,o);r=r.add(s.path.popLast());const d=Ls(c);i+=d-a.size,t.push(this._r.addEntry(e,s,c))}else if(i-=a.size,this.trackRemovals){const c=cm(this._r.serializer,o.convertToNoDocument(P.min()));t.push(this._r.addEntry(e,s,c))}}),r.forEach(s=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),t.push(this._r.updateMetadata(e,i)),p.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next(i=>(this.ar.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this._r.ir(e,t).next(({documents:i,sr:r})=>(r.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:i.get(s).readTime})}),i))}}function Mm(n){return ye(n,"remoteDocumentGlobal")}function un(n){return ye(n,"remoteDocumentsV14")}function mr(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Fm(n,e){const t=e.documentKey.path.toArray();return[n,Fs(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Om(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=M(t[s],i[s]),r)return r;return r=M(t.length,i.length),r||(r=M(t[t.length-2],i[i.length-2]),r||M(t[t.length-1],i[i.length-1]))}class UE{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Vm{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(null!==i&&rr(i.mutation,r,Ne.empty(),te.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,V()).next(()=>i))}getLocalViewOfDocuments(e,t,i=V()){const r=rt();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=tr();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const i=rt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,V()))}populateOverlays(e,t,i){const r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,i,r){let s=Le();const o=nr(),a=nr();return t.forEach((c,d)=>{const u=i.get(d.key);r.has(d.key)&&(void 0===u||u.mutation instanceof _t)?s=s.insert(d.key,d):void 0!==u?(o.set(d.key,u.mutation.getFieldMask()),rr(u.mutation,d,u.mutation.getFieldMask(),te.now())):o.set(d.key,Ne.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,u)=>o.set(d,u)),t.forEach((d,u)=>{var h;return a.set(d,new UE(u,null!==(h=o.get(d))&&void 0!==h?h:null))}),a))}recalculateAndSaveOverlays(e,t){const i=nr();let r=new W((o,a)=>o-a),s=V();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(c=>{const d=t.get(c);if(null===d)return;let u=i.get(c)||Ne.empty();u=a.applyToLocalView(d,u),i.set(c,u);const h=(r.get(a.batchId)||V()).add(c);r=r.insert(a.batchId,h)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),d=c.key,u=c.value,h=Af();u.forEach(f=>{if(!s.has(f)){const m=Of(t.get(f),i.get(f));null!==m&&h.set(f,m),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,h))}return p.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return I.isDocumentKey((o=t).path)&&null===o.collectionGroup&&0===o.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Ba(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r);var o}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):p.resolve(rt());let a=-1,c=s;return o.next(d=>p.forEach(d,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?p.resolve():this.remoteDocumentCache.getEntry(e,u).next(f=>{c=c.insert(u,f)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,V())).next(u=>({batchId:a,changes:Tf(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new I(t)).next(i=>{let r=tr();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=tr();return this.indexManager.getCollectionParents(e,s).next(a=>p.forEach(a,c=>{const d=(h=t,f=c.child(s),new mt(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt));var h,f;return this.getDocumentsMatchingCollectionQuery(e,d,i,r).next(u=>{u.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(o=>{s.forEach((c,d)=>{const u=d.getKey();null===o.get(u)&&(o=o.insert(u,J.newInvalidDocument(u)))});let a=tr();return o.forEach((c,d)=>{const u=s.get(c);void 0!==u&&rr(u.mutation,d,Ne.empty(),te.now()),er(t,d)&&(a=a.insert(c,d))}),a})}}class qE{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return p.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,{id:(r=t).id,version:r.version,createTime:le(r.createTime)}),p.resolve();var r}getNamedQuery(e,t){return p.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,{name:(r=t).name,query:Ja(r.bundledQuery),readTime:le(r.readTime)}),p.resolve();var r}}class GE{constructor(){this.overlays=new W(I.comparator),this.lr=new Map}getOverlay(e,t){return p.resolve(this.overlays.get(t))}getOverlays(e,t){const i=rt();return p.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.lt(e,t,s)}),p.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.lr.get(i);return void 0!==r&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(i)),p.resolve()}getOverlaysForCollection(e,t,i){const r=rt(),s=t.length+1,o=new I(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>i&&r.set(c.getKey(),c)}return p.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new W((d,u)=>d-u);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>i){let u=s.get(d.largestBatchId);null===u&&(u=rt(),s=s.insert(d.largestBatchId,u)),u.set(d.getKey(),d)}}const a=rt(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,u)=>a.set(d,u)),!(a.size()>=r)););return p.resolve(a)}lt(e,t,i){const r=this.overlays.get(i.key);if(null!==r){const o=this.lr.get(r.largestBatchId).delete(i.key);this.lr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new Ha(t,i));let s=this.lr.get(t);void 0===s&&(s=V(),this.lr.set(t,s)),this.lr.set(t,s.add(i.key))}}class ol{constructor(){this.hr=new $(ve.Pr),this.Ir=new $(ve.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const i=new ve(e,t);this.hr=this.hr.add(i),this.Ir=this.Ir.add(i)}Er(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.dr(new ve(e,t))}Ar(e,t){e.forEach(i=>this.removeReference(i,t))}Rr(e){const t=new I(new B([])),i=new ve(t,e),r=new ve(t,e+1),s=[];return this.Ir.forEachInRange([i,r],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new I(new B([])),i=new ve(t,e),r=new ve(t,e+1);let s=V();return this.Ir.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new ve(e,0),i=this.hr.firstAfterOrEqual(t);return null!==i&&e.isEqual(i.key)}}class ve{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return I.comparator(e.key,t.key)||M(e.gr,t.gr)}static Tr(e,t){return M(e.gr,t.gr)||I.comparator(e.key,t.key)}}class jE{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new $(ve.Pr)}checkEmpty(e){return p.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,i,r){const s=this.pr;this.pr++;const o=new Ga(s,t,i,r);this.mutationQueue.push(o);for(const a of r)this.yr=this.yr.add(new ve(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return p.resolve(o)}lookupMutationBatch(e,t){return p.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const r=this.Sr(t+1),s=r<0?0:r;return p.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return p.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return p.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new ve(t,0),r=new ve(t,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([i,r],o=>{const a=this.wr(o.gr);s.push(a)}),p.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new $(M);return t.forEach(r=>{const s=new ve(r,0),o=new ve(r,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{i=i.add(a.gr)})}),p.resolve(this.br(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;I.isDocumentKey(s)||(s=s.child(""));const o=new ve(new I(s),0);let a=new $(M);return this.yr.forEachWhile(c=>{const d=c.key.path;return!!i.isPrefixOf(d)&&(d.length===r&&(a=a.add(c.gr)),!0)},o),p.resolve(this.br(a))}br(e){const t=[];return e.forEach(i=>{const r=this.wr(i);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){S(0===this.Dr(t.batchId,"removed")),this.mutationQueue.shift();let i=this.yr;return p.forEach(t.mutations,r=>{const s=new ve(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.yr=i})}Fn(e){}containsKey(e,t){const i=new ve(t,0),r=this.yr.firstAfterOrEqual(i);return p.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return p.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class HE{constructor(e){this.Cr=e,this.docs=new W(I.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.Cr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return p.resolve(i?i.document.mutableCopy():J.newInvalidDocument(t))}getEntries(e,t){let i=Le();return t.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():J.newInvalidDocument(r))}),p.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=Le();const o=t.path,a=new I(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:d,value:{document:u}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Ra(Oh(u),i)<=0||(r.has(u.key)||er(t,u))&&(s=s.insert(u.key,u.mutableCopy()))}return p.resolve(s)}getAllFromCollectionGroup(e,t,i,r){A()}vr(e,t){return p.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new ZE(this)}getSize(e){return p.resolve(this.size)}}class ZE extends Dm{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this._r.addEntry(e,r)):this._r.removeEntry(i)}),p.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class KE{constructor(e){this.persistence=e,this.Fr=new pt(t=>tn(t),Xi),this.lastRemoteSnapshotVersion=P.min(),this.highestTargetId=0,this.Mr=0,this.Or=new ol,this.targetCount=0,this.Nr=dn.On()}forEachTarget(e,t){return this.Fr.forEach((i,r)=>t(r)),p.resolve()}getLastRemoteSnapshotVersion(e){return p.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return p.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),p.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Mr&&(this.Mr=t),p.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new dn(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,p.resolve()}updateTargetData(e,t){return this.kn(t),p.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,p.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=t&&null===i.get(a.targetId)&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),p.waitFor(s).next(()=>r)}getTargetCount(e){return p.resolve(this.targetCount)}getTargetData(e,t){const i=this.Fr.get(t)||null;return p.resolve(i)}addMatchingKeys(e,t,i){return this.Or.Er(t,i),p.resolve()}removeMatchingKeys(e,t,i){this.Or.Ar(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),p.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),p.resolve()}getMatchingKeysForTargetId(e,t){const i=this.Or.mr(t);return p.resolve(i)}containsKey(e,t){return p.resolve(this.Or.containsKey(t))}}class al{constructor(e,t){this.Lr={},this.overlays={},this.Br=new qe(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new KE(this),this.indexManager=new ME,this.remoteDocumentCache=new HE(i=>this.referenceDelegate.Qr(i)),this.serializer=new lm(t),this.Kr=new qE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new GE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Lr[e.toKey()];return i||(i=new jE(t,this.referenceDelegate),this.Lr[e.toKey()]=i),i}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,i){E("MemoryPersistence","Starting transaction:",e);const r=new $E(this.Br.next());return this.referenceDelegate.$r(),i(r).next(s=>this.referenceDelegate.Ur(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Wr(e,t){return p.or(Object.values(this.Lr).map(i=>()=>i.containsKey(e,t)))}}class $E extends Nh{constructor(e){super(),this.currentSequenceNumber=e}}class Us{constructor(e){this.persistence=e,this.Gr=new ol,this.zr=null}static jr(e){return new Us(e)}get Hr(){if(this.zr)return this.zr;throw A()}addReference(e,t,i){return this.Gr.addReference(i,t),this.Hr.delete(i.toString()),p.resolve()}removeReference(e,t,i){return this.Gr.removeReference(i,t),this.Hr.add(i.toString()),p.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),p.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(r=>this.Hr.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Hr.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return p.forEach(this.Hr,i=>{const r=I.fromPath(i);return this.Jr(e,r).next(s=>{s||t.removeEntry(r,P.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(i=>{i?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return p.or([()=>p.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class WE{constructor(e){this.serializer=e}O(e,t,i,r){const s=new ys("createOrUpgrade",t);var c;i<1&&r>=1&&(e.createObjectStore("owner"),(c=e).createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",qh,{unique:!0}),c.createObjectStore("documentMutations"),Nm(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=p.resolve();return i<3&&r>=3&&(0!==i&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),Nm(e)),o=o.next(()=>function(c){const d=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:P.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",u)}(s))),i<4&&r>=4&&(0!==i&&(o=o.next(()=>function(c,d){return d.store("mutations").U().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",qh,{unique:!0});const h=d.store("mutations"),f=u.map(m=>h.put(m));return p.waitFor(f)})}(e,s))),o=o.next(()=>{!function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),i<5&&r>=5&&(o=o.next(()=>this.Zr(s))),i<6&&r>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),i<7&&r>=7&&(o=o.next(()=>this.ei(s))),i<8&&r>=8&&(o=o.next(()=>this.ti(e,s))),i<9&&r>=9&&(o=o.next(()=>{!function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")}(e)})),i<10&&r>=10&&(o=o.next(()=>this.ni(s))),i<11&&r>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),i<12&&r>=12&&(o=o.next(()=>{!function(c){const d=c.createObjectStore("documentOverlays",{keyPath:Fb});d.createIndex("collectionPathOverlayIndex",Ob,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",Vb,{unique:!1})}(e)})),i<13&&r>=13&&(o=o.next(()=>function(c){const d=c.createObjectStore("remoteDocumentsV14",{keyPath:wb});d.createIndex("documentKeyIndex",Ib),d.createIndex("collectionGroupIndex",Tb)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(o=o.next(()=>this.ii(e,s))),i<15&&r>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:Pb}).createIndex("sequenceNumberIndex",Db,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:kb}).createIndex("documentKeyIndex",Mb,{unique:!1})}(e))),i<16&&r>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}Xr(e){let t=0;return e.store("remoteDocuments").J((i,r)=>{t+=Ls(r)}).next(()=>{const i={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}Zr(e){const t=e.store("mutationQueues"),i=e.store("mutations");return t.U().next(r=>p.forEach(r,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.U("userMutationsIndex",o).next(a=>p.forEach(a,c=>{S(c.userId===s.userId);const d=an(this.serializer,c);return Im(e,s.userId,d).next(()=>{})}))}))}ei(e){const t=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const s=[];return i.J((o,a)=>{const c=new B(o),d=[0,Se(c)];s.push(t.get(d).next(u=>u?p.resolve():t.put({targetId:0,path:Se(c),sequenceNumber:r.highestListenSequenceNumber})))}).next(()=>p.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:Rb});const i=t.store("collectionParents"),r=new sl,s=o=>{if(r.add(o)){const a=o.lastSegment(),c=o.popLast();return i.put({collectionId:a,parent:Se(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const c=new B(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],d)=>{const u=nt(a);return s(u.popLast())}))}ni(e){const t=e.store("targets");return t.J((i,r)=>{const s=dr(r),o=dm(this.serializer,s);return t.put(o)})}ri(e,t){const i=t.store("remoteDocuments"),r=[];return i.J((s,o)=>{const a=t.store("remoteDocumentsV14"),c=(h=o,h.document?new I(B.fromString(h.document.name).popFirst(5)):h.noDocument?I.fromSegments(h.noDocument.path):h.unknownDocument?I.fromSegments(h.unknownDocument.path):A()).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};var h;r.push(a.put(d))}).next(()=>p.waitFor(r))}ii(e,t){const i=t.store("mutations"),r=km(this.serializer),s=new al(Us.jr,this.serializer.ut);return i.U().next(o=>{const a=new Map;return o.forEach(c=>{var d;let u=null!==(d=a.get(c.userId))&&void 0!==d?d:V();an(this.serializer,c).keys().forEach(h=>u=u.add(h)),a.set(c.userId,u)}),p.forEach(a,(c,d)=>{const u=new ge(d),h=Os.ct(this.serializer,u),f=s.getIndexManager(u),m=Bs.ct(u,this.serializer,f,s.referenceDelegate);return new Vm(r,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new ka(t,qe.oe),c).next()})})}}function Nm(n){n.createObjectStore("targetDocuments",{keyPath:Cb}).createIndex("documentTargetsIndex",Sb,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Ab,{unique:!0}),n.createObjectStore("targetGlobal")}const ll="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class cl{constructor(e,t,i,r,s,o,a,c,d,u,h=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.si=s,this.window=o,this.document=a,this.oi=d,this._i=u,this.ai=h,this.Br=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=f=>Promise.resolve(),!cl.D())throw new x(_.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new LE(this,r),this.Ii=t+"main",this.serializer=new lm(c),this.Ti=new tt(this.Ii,this.ai,new WE(this.serializer)),this.qr=new OE(this.referenceDelegate,this.serializer),this.remoteDocumentCache=km(this.serializer),this.Kr=new CE,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===u&&ae("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new x(_.FAILED_PRECONDITION,ll);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Br=new qe(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){var t=this;return this.Pi=function(){var i=(0,y.Z)(function*(r){if(t.started)return e(r)});return function(r){return i.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(function(){var t=(0,y.Z)(function*(i){null===i.newVersion&&(yield e())});return function(i){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget((0,y.Z)(function*(){t.started&&(yield t.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Gs(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(t=>this.isPrimary&&!t?this.pi(e).next(()=>!1):!!t&&this.yi(e).next(()=>!0))).catch(e=>{if(At(e))return E("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return E("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return pr(e).get("owner").next(t=>p.resolve(this.wi(t)))}Si(e){return Gs(e).delete(this.clientId)}bi(){var e=this;return(0,y.Z)(function*(){if(e.isPrimary&&!e.Di(e.hi,18e5)){e.hi=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",i=>{const r=ye(i,"clientMetadata");return r.U().next(s=>{const o=e.Ci(s,18e5),a=s.filter(c=>-1===o.indexOf(c));return p.forEach(a,c=>r.delete(c.clientId)).next(()=>a)})}).catch(()=>[]);if(e.Ei)for(const i of t)e.Ei.removeItem(e.vi(i.clientId))}})()}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?p.resolve(!0):pr(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new x(_.FAILED_PRECONDITION,ll);return!1}}return!(!this.networkEnabled||!this.inForeground)||Gs(e).U().next(i=>void 0===this.Ci(i,5e3).find(r=>!(this.clientId===r.clientId||!(!this.networkEnabled&&r.networkEnabled||!this.inForeground&&r.inForeground&&this.networkEnabled===r.networkEnabled))))}).next(t=>(this.isPrimary!==t&&E("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,y.Z)(function*(){e.kr=!1,e.Mi(),e.li&&(e.li.cancel(),e.li=null),e.xi(),e.Oi(),yield e.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const i=new ka(t,qe.oe);return e.pi(i).next(()=>e.Si(i))}),e.Ti.close(),e.Ni()})()}Ci(e,t){return e.filter(i=>this.Di(i.updateTimeMs,t)&&!this.Fi(i.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>Gs(e).U().next(t=>this.Ci(t,18e5).map(i=>i.clientId)))}get started(){return this.kr}getMutationQueue(e,t){return Bs.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new FE(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Os.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,i){E("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",s=16===(c=this.ai)?Lb:15===c?Kh:14===c?Zh:13===c?Hh:12===c?Nb:11===c?jh:void A();var c;let o;return this.Ti.runTransaction(e,r,s,a=>(o=new ka(a,this.Br?this.Br.next():qe.oe),"readwrite-primary"===t?this.fi(o).next(c=>!!c||this.gi(o)).next(c=>{if(!c)throw ae(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new x(_.FAILED_PRECONDITION,Vh);return i(o)}).next(c=>this.yi(o).next(()=>c)):this.Bi(o).next(()=>i(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Bi(e){return pr(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)&&!this.wi(t)&&!(this._i||this.allowTabSynchronization&&t.allowTabSynchronization))throw new x(_.FAILED_PRECONDITION,ll)})}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return pr(e).put("owner",t)}static D(){return tt.D()}pi(e){const t=pr(e);return t.get("owner").next(i=>this.wi(i)?(E("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):p.resolve())}Di(e,t){const i=Date.now();return!(e<i-t||e>i&&(ae(`Detected an update time that is in the future: ${e} > ${i}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Mi();const t=/(?:Version|Mobile)\/1[456]/;(0,j.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const i=null!==(null===(t=this.Ei)||void 0===t?void 0:t.getItem(this.vi(e)));return E("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return ae("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){ae("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function pr(n){return ye(n,"owner")}function Gs(n){return ye(n,"clientMetadata")}function dl(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class ul{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.ki=i,this.qi=r}static Qi(e,t){let i=V(),r=V();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new ul(e,t.fromCache,i,r)}}class YE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Lm{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=(0,j.G6)()?8:Lh((0,j.z$)())>0?6:4}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.zi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,t,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new YE;return this.Hi(e,t,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,t,o,a.size)})}).next(()=>s.result)}Ji(e,t,i,r){return i.documentReadCount<this.Ui?(Pn()<=Qe.in.DEBUG&&E("QueryEngine","SDK will not create cache indexes for query:",Bn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),p.resolve()):(Pn()<=Qe.in.DEBUG&&E("QueryEngine","Query:",Bn(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Wi*r?(Pn()<=Qe.in.DEBUG&&E("QueryEngine","The SDK decides to create cache indexes for query:",Bn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Me(t))):p.resolve())}zi(e,t){if(vf(t))return p.resolve(null);let i=Me(t);return this.indexManager.getIndexType(e,i).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=Ss(t,null,"F"),i=Me(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const o=V(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(c=>{const d=this.Yi(t,a);return this.Zi(t,d,o,c.readTime)?this.zi(e,Ss(t,null,"F")):this.Xi(e,d,t,c)}))})))}ji(e,t,i,r){return vf(t)||r.isEqual(P.min())?p.resolve(null):this.Gi.getDocuments(e,i).next(s=>{const o=this.Yi(t,s);return this.Zi(t,o,i,r)?p.resolve(null):(Pn()<=Qe.in.DEBUG&&E("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Bn(t)),this.Xi(e,o,t,Fh(r,-1)).next(a=>a))})}Yi(e,t){let i=new $(wf(e));return t.forEach((r,s)=>{er(e,s)&&(i=i.add(s))}),i}Zi(e,t,i,r){if(null===e.limit)return!1;if(i.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Hi(e,t,i){return Pn()<=Qe.in.DEBUG&&E("QueryEngine","Using full collection scan to execute query:",Bn(t)),this.Gi.getDocumentsMatchingQuery(e,t,Ue.min(),i)}Xi(e,t,i,r){return this.Gi.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class QE{constructor(e,t,i,r){this.persistence=e,this.es=t,this.serializer=r,this.ts=new W(M),this.ns=new pt(s=>tn(s),Xi),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(i)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Vm(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function Bm(n,e,t,i){return new QE(n,e,t,i)}function zm(n,e){return hl.apply(this,arguments)}function hl(){return hl=(0,y.Z)(function*(n,e){const t=w(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.os(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{const o=[],a=[];let c=V();for(const d of r){o.push(d.batchId);for(const u of d.mutations)c=c.add(u.key)}for(const d of s){a.push(d.batchId);for(const u of d.mutations)c=c.add(u.key)}return t.localDocuments.getDocuments(i,c).next(d=>({_s:d,removedBatchIds:o,addedBatchIds:a}))})})}),hl.apply(this,arguments)}function Um(n){const e=w(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function qm(n,e,t){let i=V(),r=V();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=Le();return t.forEach((a,c)=>{const d=s.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(P.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||0===c.version.compareTo(d.version)&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):E("LocalStore","Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)}),{us:o,cs:r}})}function ew(n,e){const t=w(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Yn(n,e){const t=w(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.qr.getTargetData(i,e).next(s=>s?(r=s,p.resolve(r)):t.qr.allocateTargetId(i).next(o=>(r=new gt(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.qr.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=t.ts.get(i.targetId);return(null===r||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.ts=t.ts.insert(i.targetId,i),t.ns.set(e,i.targetId)),i})}function Qn(n,e,t){return fl.apply(this,arguments)}function fl(){return fl=(0,y.Z)(function*(n,e,t){const i=w(n),r=i.ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!At(o))throw o;E("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.ts=i.ts.remove(e),i.ns.delete(r.target)}),fl.apply(this,arguments)}function js(n,e,t){const i=w(n);let r=P.min(),s=V();return i.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,u){const h=w(c),f=h.ns.get(u);return void 0!==f?p.resolve(h.ts.get(f)):h.qr.getTargetData(d,u)}(i,o,Me(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>i.es.getDocumentsMatchingQuery(o,e,t?r:P.min(),t?s:V())).next(a=>(Hm(i,Ef(e),a),{documents:a,ls:s})))}function Gm(n,e){const t=w(n),i=w(t.qr),r=t.ts.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>i.ot(s,e).next(o=>o?o.target:null))}function jm(n,e){const t=w(n),i=t.rs.get(e)||P.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.ss.getAllFromCollectionGroup(r,e,Fh(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(Hm(t,e,r),r))}function Hm(n,e,t){let i=n.rs.get(e)||P.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.rs.set(e,i)}function ml(){return ml=(0,y.Z)(function*(n,e,t,i){const r=w(n);let s=V(),o=Le();for(const d of t){const u=e.hs(d.metadata.name);d.document&&(s=s.add(u));const h=e.Ps(d);h.setReadTime(e.Is(d.metadata.readTime)),o=o.insert(u,h)}const a=r.ss.newChangeBuffer({trackRemovals:!0}),c=yield Yn(r,(u=i,Me(Nn(B.fromString(`__bundle__/docs/${u}`)))));var u;return r.persistence.runTransaction("Apply bundle documents","readwrite",d=>qm(d,a,o).next(u=>(a.apply(d),u)).next(u=>r.qr.removeMatchingKeysForTargetId(d,c.targetId).next(()=>r.qr.addMatchingKeys(d,s,c.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(d,u.us,u.cs)).next(()=>u.us)))}),ml.apply(this,arguments)}function nw(n,e){return pl.apply(this,arguments)}function pl(){return pl=(0,y.Z)(function*(n,e,t=V()){const i=yield Yn(n,Me(Ja(e.bundledQuery))),r=w(n);return r.persistence.runTransaction("Save named query","readwrite",s=>{const o=le(e.readTime);if(i.snapshotVersion.compareTo(o)>=0)return r.Kr.saveNamedQuery(s,e);const a=i.withResumeToken(me.EMPTY_BYTE_STRING,o);return r.ts=r.ts.insert(a.targetId,a),r.qr.updateTargetData(s,a).next(()=>r.qr.removeMatchingKeysForTargetId(s,i.targetId)).next(()=>r.qr.addMatchingKeys(s,t,i.targetId)).next(()=>r.Kr.saveNamedQuery(s,e))})}),pl.apply(this,arguments)}function Zm(n,e){return`firestore_clients_${n}_${e}`}function Km(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function _l(n,e){return`firestore_targets_${n}_${e}`}class Hs{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static Ts(e,t,i){const r=JSON.parse(i);let s,o="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return o&&r.error&&(o="string"==typeof r.error.message&&"string"==typeof r.error.code,o&&(s=new x(r.error.code,r.error.message))),o?new Hs(e,t,r.state,s):(ae("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class _r{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Ts(e,t){const i=JSON.parse(t);let r,s="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return s&&i.error&&(s="string"==typeof i.error.message&&"string"==typeof i.error.code,s&&(r=new x(i.error.code,i.error.message))),s?new _r(e,i.state,r):(ae("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Zs{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const i=JSON.parse(t);let r="object"==typeof i&&i.activeTargetIds instanceof Array,s=Ua();for(let o=0;r&&o<i.activeTargetIds.length;++o)r=zh(i.activeTargetIds[o]),s=s.add(i.activeTargetIds[o]);return r?new Zs(e,s):(ae("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class gl{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new gl(t.clientId,t.onlineState):(ae("SharedClientState",`Failed to parse online state: ${e}`),null)}}class yl{constructor(){this.activeTargetIds=Ua()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vl{constructor(e,t,i,r,s){this.window=e,this.si=t,this.persistenceKey=i,this.Rs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new W(M),this.started=!1,this.ps=[];const o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=Zm(this.persistenceKey,this.Rs),this.ws=`firestore_sequence_number_${this.persistenceKey}`,this.gs=this.gs.insert(this.Rs,new yl),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=`firestore_online_state_${this.persistenceKey}`,this.vs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,y.Z)(function*(){const t=yield e.syncEngine.Li();for(const r of t){if(r===e.Rs)continue;const s=e.getItem(Zm(e.persistenceKey,r));if(s){const o=Zs.Ts(r,s);o&&(e.gs=e.gs.insert(o.clientId,o))}}e.Fs();const i=e.storage.getItem(e.Cs);if(i){const r=e.Ms(i);r&&e.xs(r)}for(const r of e.ps)e.fs(r);e.ps=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,i){this.Ns(e,t,i),this.Ls(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(_l(this.persistenceKey,e));if(i){const r=_r.Ts(e,i);r&&(t=r.state)}}return this.Bs.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Bs.As(e),this.Fs()}isLocalQueryTarget(e){return this.Bs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(_l(this.persistenceKey,e))}updateQueryState(e,t,i){this.ks(e,t,i)}handleUserChange(e,t,i){t.forEach(r=>{this.Ls(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return E("SharedClientState","READ",e,t),t}setItem(e,t){E("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){E("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){var t=this;const i=e;if(i.storageArea===this.storage){if(E("SharedClientState","EVENT",i.key,i.newValue),i.key===this.ys)return void ae("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((0,y.Z)(function*(){if(t.started){if(null!==i.key)if(t.Ss.test(i.key)){if(null==i.newValue){const r=t.Ks(i.key);return t.$s(r,null)}{const r=t.Us(i.key,i.newValue);if(r)return t.$s(r.clientId,r)}}else if(t.bs.test(i.key)){if(null!==i.newValue){const r=t.Ws(i.key,i.newValue);if(r)return t.Gs(r)}}else if(t.Ds.test(i.key)){if(null!==i.newValue){const r=t.zs(i.key,i.newValue);if(r)return t.js(r)}}else if(i.key===t.Cs){if(null!==i.newValue){const r=t.Ms(i.newValue);if(r)return t.xs(r)}}else if(i.key===t.ws){const r=function(o){let a=qe.oe;if(null!=o)try{const c=JSON.parse(o);S("number"==typeof c),a=c}catch(c){ae("SharedClientState","Failed to read sequence number from WebStorage",c)}return a}(i.newValue);r!==qe.oe&&t.sequenceNumberHandler(r)}else if(i.key===t.vs){const r=t.Hs(i.newValue);yield Promise.all(r.map(s=>t.syncEngine.Js(s)))}}else t.ps.push(i)}))}}get Bs(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Bs.Es())}Ns(e,t,i){const r=new Hs(this.currentUser,e,t,i),s=Km(this.persistenceKey,this.currentUser,e);this.setItem(s,r.Es())}Ls(e){const t=Km(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){this.storage.setItem(this.Cs,JSON.stringify({clientId:this.Rs,onlineState:e}))}ks(e,t,i){const r=_l(this.persistenceKey,e),s=new _r(e,t,i);this.setItem(r,s.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const i=this.Ks(e);return Zs.Ts(i,t)}Ws(e,t){const i=this.bs.exec(e),r=Number(i[1]);return Hs.Ts(new ge(void 0!==i[2]?i[2]:null),r,t)}zs(e,t){const i=this.Ds.exec(e),r=Number(i[1]);return _r.Ts(r,t)}Ms(e){return gl.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){var t=this;return(0,y.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Ys(e.batchId,e.state,e.error);E("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const i=t?this.gs.insert(e,t):this.gs.remove(e),r=this.Os(this.gs),s=this.Os(i),o=[],a=[];return s.forEach(c=>{r.has(c)||o.push(c)}),r.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=i})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=Ua();return e.forEach((i,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class $m{constructor(){this.eo=new yl,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,i){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new yl,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class iw{ro(e){}shutdown(){}}class Wm{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){E("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){E("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ks=null;function xl(){return null===Ks?Ks=268435456+Math.round(2147483648*Math.random()):Ks++,"0x"+Ks.toString(16)}const rw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class sw{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}Eo(e){this.Ao=e}onMessage(e){this.Ro=e}close(){this.lo()}send(e){this.co(e)}Vo(){this.Po()}mo(){this.To()}fo(e){this.Ao(e)}po(e){this.Ro(e)}}const Pe="WebChannelConnection";class ow extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.yo=i+"://"+t.host,this.wo=`projects/${r}/databases/${s}`,this.So="(default)"===this.databaseId.database?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get bo(){return!1}Do(t,i,r,s,o){const a=xl(),c=this.Co(t,i.toUriEncodedString());E("RestConnection",`Sending RPC '${t}' ${a}:`,c,r);const d={"google-cloud-resource-prefix":this.wo,"x-goog-request-params":this.So};return this.vo(d,s,o),this.Fo(t,c,d,r).then(u=>(E("RestConnection",`Received RPC '${t}' ${a}: `,u),u),u=>{throw Ve("RestConnection",`RPC '${t}' ${a} failed with error: `,u,"url: ",c,"request:",r),u})}Mo(t,i,r,s,o,a){return this.Do(t,i,r,s,o)}vo(t,i,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+Rn,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,o)=>t[o]=s),r&&r.headers.forEach((s,o)=>t[o]=s)}Co(t,i){return`${this.yo}/v1/${i}:${rw[t]}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Fo(e,t,i,r){const s=xl();return new Promise((o,a)=>{const c=new ib;c.setWithCredentials(!0),c.listenOnce(eb.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Aa.NO_ERROR:const u=c.getResponseJson();E(Pe,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case Aa.TIMEOUT:E(Pe,`RPC '${e}' ${s} timed out`),a(new x(_.DEADLINE_EXCEEDED,"Request time out"));break;case Aa.HTTP_ERROR:const h=c.getStatus();if(E(Pe,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);const m=f?.error;if(m&&m.status&&m.message){const g=function(b){const C=b.toLowerCase().replace(/_/g,"-");return Object.values(_).indexOf(C)>=0?C:_.UNKNOWN}(m.status);a(new x(g,m.message))}else a(new x(_.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new x(_.UNAVAILABLE,"Connection failed."));break;default:A()}}finally{E(Pe,`RPC '${e}' ${s} completed.`)}});const d=JSON.stringify(r);E(Pe,`RPC '${e}' ${s} sending request:`,r),c.send(t,"POST",d,i,15)})}xo(e,t,i){const r=xl(),s=[this.yo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Xx(),a=Jx(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;void 0!==d&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.xmlHttpFactory=new nb({})),this.vo(c.initMessageHeaders,t,i),c.encodeInitMessageHeaders=!0;const u=s.join("");E(Pe,`Creating RPC '${e}' stream ${r}: ${u}`,c);const h=o.createWebChannel(u,c);let f=!1,m=!1;const g=new sw({co:b=>{m?E(Pe,`Not sending because RPC '${e}' stream ${r} is closed:`,b):(f||(E(Pe,`Opening RPC '${e}' stream ${r} transport.`),h.open(),f=!0),E(Pe,`RPC '${e}' stream ${r} sending:`,b),h.send(b))},lo:()=>h.close()}),v=(b,C,k)=>{b.listen(C,R=>{try{k(R)}catch(O){setTimeout(()=>{throw O},0)}})};return v(h,gs.EventType.OPEN,()=>{m||(E(Pe,`RPC '${e}' stream ${r} transport opened.`),g.Vo())}),v(h,gs.EventType.CLOSE,()=>{m||(m=!0,E(Pe,`RPC '${e}' stream ${r} transport closed`),g.fo())}),v(h,gs.EventType.ERROR,b=>{m||(m=!0,Ve(Pe,`RPC '${e}' stream ${r} transport errored:`,b),g.fo(new x(_.UNAVAILABLE,"The operation could not be completed")))}),v(h,gs.EventType.MESSAGE,b=>{var C;if(!m){const k=b.data[0];S(!!k);const O=k.error||(null===(C=k[0])||void 0===C?void 0:C.error);if(O){E(Pe,`RPC '${e}' stream ${r} received error:`,O);const q=O.status;let H=function(eT){const y_=ue[eT];if(void 0!==y_)return Uf(y_)}(q),ce=O.message;void 0===H&&(H=_.INTERNAL,ce="Unknown error status: "+q+" with message "+O.message),m=!0,g.fo(new x(H,ce)),h.close()}else E(Pe,`RPC '${e}' stream ${r} received:`,k),g.po(k)}}),v(a,tb.STAT_EVENT,b=>{b.stat===Sh.PROXY?E(Pe,`RPC '${e}' stream ${r} detected buffering proxy`):b.stat===Sh.NOPROXY&&E(Pe,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{g.mo()},0),g}}function Ym(){return typeof window<"u"?window:null}function $s(){return typeof document<"u"?document:null}function gr(n){return new _E(n,!0)}class bl{constructor(e,t,i=1e3,r=1.5,s=6e4){this.si=e,this.timerId=t,this.Oo=i,this.No=r,this.Lo=s,this.Bo=0,this.ko=null,this.qo=Date.now(),this.reset()}reset(){this.Bo=0}Qo(){this.Bo=this.Lo}Ko(e){this.cancel();const t=Math.floor(this.Bo+this.$o()),i=Math.max(0,Date.now()-this.qo),r=Math.max(0,t-i);r>0&&E("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Bo} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.ko=this.si.enqueueAfterDelay(this.timerId,r,()=>(this.qo=Date.now(),e())),this.Bo*=this.No,this.Bo<this.Oo&&(this.Bo=this.Oo),this.Bo>this.Lo&&(this.Bo=this.Lo)}Uo(){null!==this.ko&&(this.ko.skipDelay(),this.ko=null)}cancel(){null!==this.ko&&(this.ko.cancel(),this.ko=null)}$o(){return(Math.random()-.5)*this.Bo}}class Qm{constructor(e,t,i,r,s,o,a,c){this.si=e,this.Wo=i,this.Go=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.zo=0,this.jo=null,this.Ho=null,this.stream=null,this.Jo=new bl(e,t)}Yo(){return 1===this.state||5===this.state||this.Zo()}Zo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Xo()}stop(){var e=this;return(0,y.Z)(function*(){e.Yo()&&(yield e.close(0))})()}e_(){this.state=0,this.Jo.reset()}t_(){this.Zo()&&null===this.jo&&(this.jo=this.si.enqueueAfterDelay(this.Wo,6e4,()=>this.n_()))}r_(e){this.i_(),this.stream.send(e)}n_(){var e=this;return(0,y.Z)(function*(){if(e.Zo())return e.close(0)})()}i_(){this.jo&&(this.jo.cancel(),this.jo=null)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}close(e,t){var i=this;return(0,y.Z)(function*(){i.i_(),i.s_(),i.Jo.cancel(),i.zo++,4!==e?i.Jo.reset():t&&t.code===_.RESOURCE_EXHAUSTED?(ae(t.toString()),ae("Using maximum backoff delay to prevent overloading the backend."),i.Jo.Qo()):t&&t.code===_.UNAUTHENTICATED&&3!==i.state&&(i.authCredentialsProvider.invalidateToken(),i.appCheckCredentialsProvider.invalidateToken()),null!==i.stream&&(i.o_(),i.stream.close(),i.stream=null),i.state=e,yield i.listener.Eo(t)})()}o_(){}auth(){this.state=1;const e=this.__(this.zo),t=this.zo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.zo===t&&this.a_(i,r)},i=>{e(()=>{const r=new x(_.UNKNOWN,"Fetching auth token failed: "+i.message);return this.u_(r)})})}a_(e,t){const i=this.__(this.zo);this.stream=this.c_(e,t),this.stream.ho(()=>{i(()=>this.listener.ho())}),this.stream.Io(()=>{i(()=>(this.state=2,this.Ho=this.si.enqueueAfterDelay(this.Go,1e4,()=>(this.Zo()&&(this.state=3),Promise.resolve())),this.listener.Io()))}),this.stream.Eo(r=>{i(()=>this.u_(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}Xo(){var e=this;this.state=5,this.Jo.Ko((0,y.Z)(function*(){e.state=0,e.start()}))}u_(e){return E("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}__(e){return t=>{this.si.enqueueAndForget(()=>this.zo===e?t():(E("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class aw extends Qm{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}c_(e,t){return this.connection.xo("Listen",e,t)}onMessage(e){this.Jo.reset();const t=function vE(n,e){let t;if("targetChange"in e){const i="NO_CHANGE"===(d=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===d?1:"REMOVE"===d?2:"CURRENT"===d?3:"RESET"===d?4:A(),r=e.targetChange.targetIds||[],s=function(d,u){return d.useProto3Json?(S(void 0===u||"string"==typeof u),me.fromBase64String(u||"")):(S(void 0===u||u instanceof Buffer||u instanceof Uint8Array),me.fromUint8Array(u||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const u=void 0===d.code?_.UNKNOWN:Uf(d.code);return new x(u,d.message||"")}(o);t=new Zf(i,r,s,a||null)}else if("documentChange"in e){const i=e.documentChange,r=st(n,i.document.name),s=le(i.document.updateTime),o=i.document.createTime?le(i.document.createTime):P.min(),a=new we({mapValue:{fields:i.document.fields}}),c=J.newFoundDocument(r,s,o,a);t=new Ms(i.targetIds||[],i.removedTargetIds||[],c.key,c)}else if("documentDelete"in e){const i=e.documentDelete,r=st(n,i.document),s=i.readTime?le(i.readTime):P.min(),o=J.newNoDocument(r,s);t=new Ms([],i.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const i=e.documentRemove,r=st(n,i.document);t=new Ms([],i.removedTargetIds||[],r,null)}else{if(!("filter"in e))return A();{const i=e.filter,{count:r=0,unchangedNames:s}=i,o=new dE(r,s);t=new Hf(i.targetId,o)}}var d;return t}(this.serializer,e),i=function(s){if(!("targetChange"in s))return P.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?P.min():o.readTime?le(o.readTime):P.min()}(e);return this.listener.l_(t,i)}h_(e){const t={};t.database=Ya(this.serializer),t.addTarget=function(s,o){let a;const c=o.target;if(a=As(c)?{documents:im(s,c)}:{query:Xa(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Yf(s,o.resumeToken);const d=Ka(s,o.expectedCount);null!==d&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(P.min())>0){a.readTime=jn(s,o.snapshotVersion.toTimestamp());const d=Ka(s,o.expectedCount);null!==d&&(a.expectedCount=d)}return a}(this.serializer,e);const i=function bE(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return A()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);i&&(t.labels=i),this.r_(t)}P_(e){const t={};t.database=Ya(this.serializer),t.removeTarget=e,this.r_(t)}}class lw extends Qm{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s,this.I_=!1}get T_(){return this.I_}start(){this.I_=!1,this.lastStreamToken=void 0,super.start()}o_(){this.I_&&this.E_([])}c_(e,t){return this.connection.xo("Write",e,t)}onMessage(e){if(S(!!e.streamToken),this.lastStreamToken=e.streamToken,this.I_){this.Jo.reset();const t=function xE(n,e){return n&&n.length>0?(S(void 0!==e),n.map(t=>function(r,s){let o=le(r.updateTime?r.updateTime:s);return o.isEqual(P.min())&&(o=le(s)),new oE(o,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),i=le(e.commitTime);return this.listener.d_(i,t)}return S(!e.writeResults||0===e.writeResults.length),this.I_=!0,this.listener.A_()}R_(){const e={};e.database=Ya(this.serializer),this.r_(e)}E_(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>cr(this.serializer,i))};this.r_(t)}}class cw extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.V_=!1}m_(){if(this.V_)throw new x(_.FAILED_PRECONDITION,"The client has already been terminated.")}Do(e,t,i,r){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Do(e,Wa(t,i),r,s,o)).catch(s=>{throw"FirebaseError"===s.name?(s.code===_.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new x(_.UNKNOWN,s.toString())})}Mo(e,t,i,r,s){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,Wa(t,i),r,o,a,s)).catch(o=>{throw"FirebaseError"===o.name?(o.code===_.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new x(_.UNKNOWN,o.toString())})}terminate(){this.V_=!0,this.connection.terminate()}}class uw{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){0===this.g_&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){"Online"===this.state?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,"Online"===e&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(ae(t),this.y_=!1):E("OnlineStateTracker",t)}C_(){null!==this.p_&&(this.p_.cancel(),this.p_=null)}}class hw{constructor(e,t,i,r,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.ro(a=>{i.enqueueAndForget((0,y.Z)(function*(){var c;Nt(o)&&(E("RemoteStore","Restarting streams for network reachability change."),yield(c=(0,y.Z)(function*(u){const h=w(u);h.M_.add(4),yield Xn(h),h.N_.set("Unknown"),h.M_.delete(4),yield yr(h)}),function d(u){return c.apply(this,arguments)})(o))}))}),this.N_=new uw(i,r)}}function yr(n){return wl.apply(this,arguments)}function wl(){return wl=(0,y.Z)(function*(n){if(Nt(n))for(const e of n.x_)yield e(!0)}),wl.apply(this,arguments)}function Xn(n){return Il.apply(this,arguments)}function Il(){return Il=(0,y.Z)(function*(n){for(const e of n.x_)yield e(!1)}),Il.apply(this,arguments)}function Ws(n,e){const t=w(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),Cl(t)?Al(t):ti(t).Zo()&&Tl(t,e))}function Jn(n,e){const t=w(n),i=ti(t);t.F_.delete(e),i.Zo()&&Xm(t,e),0===t.F_.size&&(i.Zo()?i.t_():Nt(t)&&t.N_.set("Unknown"))}function Tl(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(P.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ti(n).h_(e)}function Xm(n,e){n.L_.xe(e),ti(n).P_(e)}function Al(n){n.L_=new hE({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),ti(n).start(),n.N_.w_()}function Cl(n){return Nt(n)&&!ti(n).Yo()&&n.F_.size>0}function Nt(n){return 0===w(n).M_.size}function Jm(n){n.L_=void 0}function fw(n){return Sl.apply(this,arguments)}function Sl(){return Sl=(0,y.Z)(function*(n){n.N_.set("Online")}),Sl.apply(this,arguments)}function mw(n){return Rl.apply(this,arguments)}function Rl(){return Rl=(0,y.Z)(function*(n){n.F_.forEach((e,t)=>{Tl(n,e)})}),Rl.apply(this,arguments)}function pw(n,e){return Pl.apply(this,arguments)}function Pl(){return Pl=(0,y.Z)(function*(n,e){Jm(n),Cl(n)?(n.N_.D_(e),Al(n)):n.N_.set("Unknown")}),Pl.apply(this,arguments)}function _w(n,e,t){return Dl.apply(this,arguments)}function Dl(){return Dl=(0,y.Z)(function*(n,e,t){if(n.N_.set("Online"),e instanceof Zf&&2===e.state&&e.cause)try{yield(i=(0,y.Z)(function*(s,o){const a=o.cause;for(const c of o.targetIds)s.F_.has(c)&&(yield s.remoteSyncer.rejectListen(c,a),s.F_.delete(c),s.L_.removeTarget(c))}),function r(s,o){return i.apply(this,arguments)})(n,e)}catch(i){E("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield Ys(n,i)}else if(e instanceof Ms?n.L_.Ke(e):e instanceof Hf?n.L_.He(e):n.L_.We(e),!t.isEqual(P.min()))try{const i=yield Um(n.localStore);t.compareTo(i)>=0&&(yield function(s,o){const a=s.L_.rt(o);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const u=s.F_.get(d);u&&s.F_.set(d,u.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,d)=>{const u=s.F_.get(c);if(!u)return;s.F_.set(c,u.withResumeToken(me.EMPTY_BYTE_STRING,u.snapshotVersion)),Xm(s,c);const h=new gt(u.target,c,d,u.sequenceNumber);Tl(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(i){E("RemoteStore","Failed to raise snapshot:",i),yield Ys(n,i)}var i}),Dl.apply(this,arguments)}function Ys(n,e,t){return kl.apply(this,arguments)}function kl(){return kl=(0,y.Z)(function*(n,e,t){if(!At(e))throw e;n.M_.add(1),yield Xn(n),n.N_.set("Offline"),t||(t=()=>Um(n.localStore)),n.asyncQueue.enqueueRetryable((0,y.Z)(function*(){E("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield yr(n)}))}),kl.apply(this,arguments)}function ep(n,e){return e().catch(t=>Ys(n,t,e))}function ei(n){return Ml.apply(this,arguments)}function Ml(){return Ml=(0,y.Z)(function*(n){const e=w(n),t=Lt(e);let i=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;gw(e);)try{const r=yield ew(e.localStore,i);if(null===r){0===e.v_.length&&t.t_();break}i=r.batchId,yw(e,r)}catch(r){yield Ys(e,r)}tp(e)&&np(e)}),Ml.apply(this,arguments)}function gw(n){return Nt(n)&&n.v_.length<10}function yw(n,e){n.v_.push(e);const t=Lt(n);t.Zo()&&t.T_&&t.E_(e.mutations)}function tp(n){return Nt(n)&&!Lt(n).Yo()&&n.v_.length>0}function np(n){Lt(n).start()}function vw(n){return Fl.apply(this,arguments)}function Fl(){return Fl=(0,y.Z)(function*(n){Lt(n).R_()}),Fl.apply(this,arguments)}function xw(n){return Ol.apply(this,arguments)}function Ol(){return Ol=(0,y.Z)(function*(n){const e=Lt(n);for(const t of n.v_)e.E_(t.mutations)}),Ol.apply(this,arguments)}function bw(n,e,t){return Vl.apply(this,arguments)}function Vl(){return Vl=(0,y.Z)(function*(n,e,t){const i=n.v_.shift(),r=ja.from(i,e,t);yield ep(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield ei(n)}),Vl.apply(this,arguments)}function Ew(n,e){return Nl.apply(this,arguments)}function Nl(){return Nl=(0,y.Z)(function*(n,e){var t;e&&Lt(n).T_&&(yield(t=(0,y.Z)(function*(r,s){if(zf(a=s.code)&&a!==_.ABORTED){const o=r.v_.shift();Lt(r).e_(),yield ep(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield ei(r)}var a}),function i(r,s){return t.apply(this,arguments)})(n,e)),tp(n)&&np(n)}),Nl.apply(this,arguments)}function ip(n,e){return Ll.apply(this,arguments)}function Ll(){return Ll=(0,y.Z)(function*(n,e){const t=w(n);t.asyncQueue.verifyOperationInProgress(),E("RemoteStore","RemoteStore received new credentials");const i=Nt(t);t.M_.add(3),yield Xn(t),i&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield yr(t)}),Ll.apply(this,arguments)}function Bl(n,e){return zl.apply(this,arguments)}function zl(){return zl=(0,y.Z)(function*(n,e){const t=w(n);e?(t.M_.delete(2),yield yr(t)):e||(t.M_.add(2),yield Xn(t),t.N_.set("Unknown"))}),zl.apply(this,arguments)}function ti(n){return n.B_||(n.B_=function(t,i,r){const s=w(t);return s.m_(),new aw(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{ho:fw.bind(null,n),Io:mw.bind(null,n),Eo:pw.bind(null,n),l_:_w.bind(null,n)}),n.x_.push(function(){var e=(0,y.Z)(function*(t){t?(n.B_.e_(),Cl(n)?Al(n):n.N_.set("Unknown")):(yield n.B_.stop(),Jm(n))});return function(t){return e.apply(this,arguments)}}())),n.B_}function Lt(n){return n.k_||(n.k_=function(t,i,r){const s=w(t);return s.m_(),new lw(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{ho:()=>Promise.resolve(),Io:vw.bind(null,n),Eo:Ew.bind(null,n),A_:xw.bind(null,n),d_:bw.bind(null,n)}),n.x_.push(function(){var e=(0,y.Z)(function*(t){t?(n.k_.e_(),yield ei(n)):(yield n.k_.stop(),n.v_.length>0&&(E("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))});return function(t){return e.apply(this,arguments)}}())),n.k_}class Ul{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new fe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new Ul(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new x(_.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ni(n,e){if(ae("AsyncQueue",`${e}: ${n}`),At(n))return new x(_.UNAVAILABLE,`${e}: ${n}`);throw n}class ii{constructor(e){this.comparator=e?(t,i)=>e(t,i)||I.comparator(t.key,i.key):(t,i)=>I.comparator(t.key,i.key),this.keyedMap=tr(),this.sortedSet=new W(this.comparator)}static emptySet(e){return new ii(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ii)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const i=new ii;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class rp{constructor(){this.q_=new W(I.comparator)}track(e){const t=e.doc.key,i=this.q_.get(t);i?0!==e.type&&3===i.type?this.q_=this.q_.insert(t,e):3===e.type&&1!==i.type?this.q_=this.q_.insert(t,{type:i.type,doc:e.doc}):2===e.type&&2===i.type?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===i.type?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===i.type?this.q_=this.q_.remove(t):1===e.type&&2===i.type?this.q_=this.q_.insert(t,{type:1,doc:i.doc}):0===e.type&&1===i.type?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):A():this.q_=this.q_.insert(t,e)}Q_(){const e=[];return this.q_.inorderTraversal((t,i)=>{e.push(i)}),e}}class ri{constructor(e,t,i,r,s,o,a,c,d){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new ri(e,t,ii.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ji(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}class ww{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}}class Iw{constructor(){this.queries=new pt(e=>bf(e),Ji),this.onlineState="Unknown",this.z_=new Set}}function ql(n,e){return Gl.apply(this,arguments)}function Gl(){return Gl=(0,y.Z)(function*(n,e){const t=w(n);let i=3;const r=e.query;let s=t.queries.get(r);s?!s.W_()&&e.G_()&&(i=2):(s=new ww,i=e.G_()?0:1);try{switch(i){case 0:s.K_=yield t.onListen(r,!0);break;case 1:s.K_=yield t.onListen(r,!1);break;case 2:yield t.onFirstRemoteStoreListen(r)}}catch(o){const a=ni(o,`Initialization of query '${Bn(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&Zl(t)}),Gl.apply(this,arguments)}function jl(n,e){return Hl.apply(this,arguments)}function Hl(){return Hl=(0,y.Z)(function*(n,e){const t=w(n),i=e.query;let r=3;const s=t.queries.get(i);if(s){const o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),0===s.U_.length?r=e.G_()?0:1:!s.W_()&&e.G_()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}),Hl.apply(this,arguments)}function Tw(n,e){const t=w(n);let i=!1;for(const r of e){const o=t.queries.get(r.query);if(o){for(const a of o.U_)a.H_(r)&&(i=!0);o.K_=r}}i&&Zl(t)}function Aw(n,e,t){const i=w(n),r=i.queries.get(e);if(r)for(const s of r.U_)s.onError(t);i.queries.delete(e)}function Zl(n){n.z_.forEach(e=>{e.next()})}var Kl,sp;(sp=Kl||(Kl={})).J_="default",sp.Cache="cache";class $l{constructor(e,t,i){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=i||{}}H_(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)3!==r.type&&i.push(r);e=new ri(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){return!e.fromCache||!this.G_()||(!this.options.ra||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ea(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}na(e){e=ri.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==Kl.Cache}}class Cw{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}}class op{constructor(e){this.serializer=e}hs(e){return st(this.serializer,e)}Ps(e){return e.metadata.exists?nm(this.serializer,e.document,!1):J.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return le(e)}}class Sw{constructor(e,t,i){this.oa=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=ap(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;const i=B.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){const t=new Map,i=new op(this.serializer);for(const r of e)if(r.metadata.queries){const s=i.hs(r.metadata.name);for(const o of r.metadata.queries){const a=(t.get(o)||V()).add(s);t.set(o,a)}}return t}complete(){var e=this;return(0,y.Z)(function*(){const t=yield function tw(n,e,t,i){return ml.apply(this,arguments)}(e.localStore,new op(e.serializer),e.documents,e.oa.id),i=e.aa(e.documents);for(const r of e.queries)yield nw(e.localStore,r,i.get(r.name));return e.progress.taskState="Success",{progress:e.progress,ua:e.collectionGroups,ca:t}})()}}function ap(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class lp{constructor(e){this.key=e}}class cp{constructor(e){this.key=e}}class dp{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=V(),this.mutatedKeys=V(),this.Ia=wf(e),this.Ta=new ii(this.Ia)}get Ea(){return this.la}da(e,t){const i=t?t.Aa:new rp,r=t?t.Ta:this.Ta;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,d="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,h)=>{const f=r.get(u),m=er(this.query,h)?h:null,g=!!f&&this.mutatedKeys.has(f.key),v=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let b=!1;f&&m?f.data.isEqual(m.data)?g!==v&&(i.track({type:3,doc:m}),b=!0):this.Ra(f,m)||(i.track({type:2,doc:m}),b=!0,(c&&this.Ia(m,c)>0||d&&this.Ia(m,d)<0)&&(a=!0)):!f&&m?(i.track({type:0,doc:m}),b=!0):f&&!m&&(i.track({type:1,doc:f}),b=!0,(c||d)&&(a=!0)),b&&(m?(o=o.add(m),s=v?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const u="F"===this.query.limitType?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),i.track({type:1,doc:u})}return{Ta:o,Aa:i,Zi:a,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;const o=e.Aa.Q_();o.sort((u,h)=>function(m,g){const v=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return A()}};return v(m)-v(g)}(u.type,h.type)||this.Ia(u.doc,h.doc)),this.Va(i),r=null!=r&&r;const a=t&&!r?this.ma():[],c=0===this.Pa.size&&this.current&&!r?1:0,d=c!==this.ha;return this.ha=c,0!==o.length||d?{snapshot:new ri(this.query,e.Ta,s,o,e.mutatedKeys,0===c,d,!1,!!i&&i.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new rp,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];const e=this.Pa;this.Pa=V(),this.Ta.forEach(i=>{this.ga(i.key)&&(this.Pa=this.Pa.add(i.key))});const t=[];return e.forEach(i=>{this.Pa.has(i)||t.push(new cp(i))}),this.Pa.forEach(i=>{e.has(i)||t.push(new lp(i))}),t}pa(e){this.la=e.ls,this.Pa=V();const t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return ri.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,0===this.ha,this.hasCachedResults)}}class Rw{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class Pw{constructor(e){this.key=e,this.wa=!1}}class Dw{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new pt(a=>bf(a),Ji),this.Da=new Map,this.Ca=new Set,this.va=new W(I.comparator),this.Fa=new Map,this.Ma=new ol,this.xa={},this.Oa=new Map,this.Na=dn.Nn(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return!0===this.La}}function kw(n,e){return Wl.apply(this,arguments)}function Wl(){return Wl=(0,y.Z)(function*(n,e,t=!0){const i=Qs(n);let r;const s=i.ba.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.ya()):r=yield up(i,e,t,!0),r}),Wl.apply(this,arguments)}function Mw(n,e){return Yl.apply(this,arguments)}function Yl(){return Yl=(0,y.Z)(function*(n,e){const t=Qs(n);yield up(t,e,!0,!1)}),Yl.apply(this,arguments)}function up(n,e,t,i){return Ql.apply(this,arguments)}function Ql(){return Ql=(0,y.Z)(function*(n,e,t,i){const r=yield Yn(n.localStore,Me(e)),s=r.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current";let a;return i&&(a=yield Xl(n,e,s,"current"===o,r.resumeToken)),n.isPrimaryClient&&t&&Ws(n.remoteStore,r),a}),Ql.apply(this,arguments)}function Xl(n,e,t,i,r){return Jl.apply(this,arguments)}function Jl(){return Jl=(0,y.Z)(function*(n,e,t,i,r){n.Ba=(h,f,m)=>{return(g=(0,y.Z)(function*(b,C,k,R){let O=C.view.da(k);O.Zi&&(O=yield js(b.localStore,C.query,!1).then(({documents:Ze})=>C.view.da(Ze,O)));const q=R&&R.targetChanges.get(C.targetId),H=R&&null!=R.targetMismatches.get(C.targetId),ce=C.view.applyChanges(O,b.isPrimaryClient,q,H);return dc(b,C.targetId,ce.fa),ce.snapshot}),function v(b,C,k,R){return g.apply(this,arguments)})(n,h,f,m);var g};const s=yield js(n.localStore,e,!0),o=new dp(e,s.ls),a=o.da(s.documents),c=ar.createSynthesizedTargetChangeForCurrentChange(t,i&&"Offline"!==n.onlineState,r),d=o.applyChanges(a,n.isPrimaryClient,c);dc(n,t,d.fa);const u=new Rw(e,t,o);return n.ba.set(e,u),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),d.snapshot}),Jl.apply(this,arguments)}function Fw(n,e,t){return ec.apply(this,arguments)}function ec(){return ec=(0,y.Z)(function*(n,e,t){const i=w(n),r=i.ba.get(e),s=i.Da.get(r.targetId);if(s.length>1)return i.Da.set(r.targetId,s.filter(o=>!Ji(o,e))),void i.ba.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Qn(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Jn(i.remoteStore,r.targetId),si(i,r.targetId)}).catch(Tt))):(si(i,r.targetId),yield Qn(i.localStore,r.targetId,!0))}),ec.apply(this,arguments)}function Ow(n,e){return tc.apply(this,arguments)}function tc(){return tc=(0,y.Z)(function*(n,e){const t=w(n),i=t.ba.get(e),r=t.Da.get(i.targetId);t.isPrimaryClient&&1===r.length&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Jn(t.remoteStore,i.targetId))}),tc.apply(this,arguments)}function nc(){return nc=(0,y.Z)(function*(n,e,t){const i=bc(n);try{const r=yield function(o,a){const c=w(o),d=te.now(),u=a.reduce((m,g)=>m.add(g.key),V());let h,f;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=Le(),v=V();return c.ss.getEntries(m,u).next(b=>{g=b,g.forEach((C,k)=>{k.isValidDocument()||(v=v.add(C))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,g)).next(b=>{h=b;const C=[];for(const k of a){const R=lE(k,h.get(k.key).overlayedDocument);null!=R&&C.push(new _t(k.key,R,sf(R.value.mapValue),ne.exists(!0)))}return c.mutationQueue.addMutationBatch(m,d,C,a)}).next(b=>{f=b;const C=b.applyToLocalDocumentSet(h,v);return c.documentOverlayCache.saveOverlays(m,b.batchId,C)})}).then(()=>({batchId:f.batchId,changes:Tf(h)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(o,a,c){let d=o.xa[o.currentUser.toKey()];d||(d=new W(M)),d=d.insert(a,c),o.xa[o.currentUser.toKey()]=d}(i,r.batchId,t),yield yt(i,r.changes),yield ei(i.remoteStore)}catch(r){const s=ni(r,"Failed to persist write");t.reject(s)}}),nc.apply(this,arguments)}function hp(n,e){return ic.apply(this,arguments)}function ic(){return ic=(0,y.Z)(function*(n,e){const t=w(n);try{const i=yield function JE(n,e){const t=w(n),i=e.snapshotVersion;let r=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.ss.newChangeBuffer({trackRemovals:!0});r=t.ts;const a=[];e.targetChanges.forEach((u,h)=>{const f=r.get(h);if(!f)return;a.push(t.qr.removeMatchingKeys(s,u.removedDocuments,h).next(()=>t.qr.addMatchingKeys(s,u.addedDocuments,h)));let m=f.withSequenceNumber(s.currentSequenceNumber);var v,b,C;null!==e.targetMismatches.get(h)?m=m.withResumeToken(me.EMPTY_BYTE_STRING,P.min()).withLastLimboFreeSnapshotVersion(P.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,i)),r=r.insert(h,m),b=m,C=u,(0===(v=f).resumeToken.approximateByteSize()||b.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8||C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0)&&a.push(t.qr.updateTargetData(s,m))});let c=Le(),d=V();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(qm(s,o,e.documentUpdates).next(u=>{c=u.us,d=u.cs})),!i.isEqual(P.min())){const u=t.qr.getLastRemoteSnapshotVersion(s).next(h=>t.qr.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(u)}return p.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(t.ts=r,s))}(t.localStore,e);e.targetChanges.forEach((r,s)=>{const o=t.Fa.get(s);o&&(S(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.wa=!0:r.modifiedDocuments.size>0?S(o.wa):r.removedDocuments.size>0&&(S(o.wa),o.wa=!1))}),yield yt(t,i,e)}catch(i){yield Tt(i)}}),ic.apply(this,arguments)}function fp(n,e,t){const i=w(n);if(i.isPrimaryClient&&0===t||!i.isPrimaryClient&&1===t){const r=[];i.ba.forEach((s,o)=>{const a=o.view.j_(e);a.snapshot&&r.push(a.snapshot)}),function(o,a){const c=w(o);c.onlineState=a;let d=!1;c.queries.forEach((u,h)=>{for(const f of h.U_)f.j_(a)&&(d=!0)}),d&&Zl(c)}(i.eventManager,e),r.length&&i.Sa.l_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function Nw(n,e,t){return rc.apply(this,arguments)}function rc(){return rc=(0,y.Z)(function*(n,e,t){const i=w(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Fa.get(e),s=r&&r.key;if(s){let o=new W(I.comparator);o=o.insert(s,J.newNoDocument(s,P.min()));const a=V().add(s),c=new or(P.min(),new Map,new W(M),o,a);yield hp(i,c),i.va=i.va.remove(s),i.Fa.delete(e),uc(i)}else yield Qn(i.localStore,e,!1).then(()=>si(i,e,t)).catch(Tt)}),rc.apply(this,arguments)}function Lw(n,e){return sc.apply(this,arguments)}function sc(){return sc=(0,y.Z)(function*(n,e){const t=w(n),i=e.batch.batchId;try{const r=yield function XE(n,e){const t=w(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),s=t.ss.newChangeBuffer({trackRemovals:!0});return function(a,c,d,u){const h=d.batch,f=h.keys();let m=p.resolve();return f.forEach(g=>{m=m.next(()=>u.getEntry(c,g)).next(v=>{const b=d.docVersions.get(g);S(null!==b),v.version.compareTo(b)<0&&(h.applyToRemoteDocument(v,d),v.isValidDocument()&&(v.setReadTime(d.commitVersion),u.addEntry(v)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(a){let c=V();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}(t.localStore,e);cc(t,i,null),lc(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield yt(t,r)}catch(r){yield Tt(r)}}),sc.apply(this,arguments)}function Bw(n,e,t){return oc.apply(this,arguments)}function oc(){return oc=(0,y.Z)(function*(n,e,t){const i=w(n);try{const r=yield function(o,a){const c=w(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let u;return c.mutationQueue.lookupMutationBatch(d,a).next(h=>(S(null!==h),u=h.keys(),c.mutationQueue.removeMutationBatch(d,h))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,u,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,u)).next(()=>c.localDocuments.getDocuments(d,u))})}(i.localStore,e);cc(i,e,t),lc(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield yt(i,r)}catch(r){yield Tt(r)}}),oc.apply(this,arguments)}function ac(){return ac=(0,y.Z)(function*(n,e){const t=w(n);Nt(t.remoteStore)||E("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=yield function(o){const a=w(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(-1===i)return void e.resolve();const r=t.Oa.get(i)||[];r.push(e),t.Oa.set(i,r)}catch(i){const r=ni(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}),ac.apply(this,arguments)}function lc(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function cc(n,e,t){const i=w(n);let r=i.xa[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.xa[i.currentUser.toKey()]=r}}function si(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Da.get(e))n.ba.delete(i),t&&n.Sa.ka(i,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Rr(e).forEach(i=>{n.Ma.containsKey(i)||mp(n,i)})}function mp(n,e){n.Ca.delete(e.path.canonicalString());const t=n.va.get(e);null!==t&&(Jn(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),uc(n))}function dc(n,e,t){for(const i of t)i instanceof lp?(n.Ma.addReference(i.key,e),Uw(n,i)):i instanceof cp?(E("SyncEngine","Document no longer in limbo: "+i.key),n.Ma.removeReference(i.key,e),n.Ma.containsKey(i.key)||mp(n,i.key)):A()}function Uw(n,e){const t=e.key,i=t.path.canonicalString();n.va.get(t)||n.Ca.has(i)||(E("SyncEngine","New document in limbo: "+t),n.Ca.add(i),uc(n))}function uc(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){const e=n.Ca.values().next().value;n.Ca.delete(e);const t=new I(B.fromString(e)),i=n.Na.next();n.Fa.set(i,new Pw(t)),n.va=n.va.insert(t,i),Ws(n.remoteStore,new gt(Me(Nn(t.path)),i,"TargetPurposeLimboResolution",qe.oe))}}function yt(n,e,t){return hc.apply(this,arguments)}function hc(){return hc=(0,y.Z)(function*(n,e,t){const i=w(n),r=[],s=[],o=[];var a;i.ba.isEmpty()||(i.ba.forEach((a,c)=>{o.push(i.Ba(c,e,t).then(d=>{if((d||t)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(c.targetId,d?.fromCache?"not-current":"current"),d){r.push(d);const u=ul.Qi(c.targetId,d);s.push(u)}}))}),yield Promise.all(o),i.Sa.l_(r),yield(a=(0,y.Z)(function*(d,u){const h=w(d);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>p.forEach(u,m=>p.forEach(m.ki,g=>h.persistence.referenceDelegate.addReference(f,m.targetId,g)).next(()=>p.forEach(m.qi,g=>h.persistence.referenceDelegate.removeReference(f,m.targetId,g)))))}catch(f){if(!At(f))throw f;E("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const m=f.targetId;if(!f.fromCache){const g=h.ts.get(m),b=g.withLastLimboFreeSnapshotVersion(g.snapshotVersion);h.ts=h.ts.insert(m,b)}}}),function c(d,u){return a.apply(this,arguments)})(i.localStore,s))}),hc.apply(this,arguments)}function qw(n,e){return fc.apply(this,arguments)}function fc(){return fc=(0,y.Z)(function*(n,e){const t=w(n);if(!t.currentUser.isEqual(e)){E("SyncEngine","User change. New user:",e.toKey());const i=yield zm(t.localStore,e);t.currentUser=e,(s=t).Oa.forEach(a=>{a.forEach(c=>{c.reject(new x(_.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.Oa.clear(),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield yt(t,i._s)}var s}),fc.apply(this,arguments)}function Gw(n,e){const t=w(n),i=t.Fa.get(e);if(i&&i.wa)return V().add(i.key);{let r=V();const s=t.Da.get(e);if(!s)return r;for(const o of s){const a=t.ba.get(o);r=r.unionWith(a.view.Ea)}return r}}function jw(n,e){return mc.apply(this,arguments)}function mc(){return mc=(0,y.Z)(function*(n,e){const t=w(n),i=yield js(t.localStore,e.query,!0),r=e.view.pa(i);return t.isPrimaryClient&&dc(t,e.targetId,r.fa),r}),mc.apply(this,arguments)}function Hw(n,e){return pc.apply(this,arguments)}function pc(){return pc=(0,y.Z)(function*(n,e){const t=w(n);return jm(t.localStore,e).then(i=>yt(t,i))}),pc.apply(this,arguments)}function Zw(n,e,t,i){return _c.apply(this,arguments)}function _c(){return _c=(0,y.Z)(function*(n,e,t,i){const r=w(n),s=yield function(a,c){const d=w(a),u=w(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",h=>u.Cn(h,c).next(f=>f?d.localDocuments.getDocuments(h,f):p.resolve(null)))}(r.localStore,e);var c;null!==s?("pending"===t?yield ei(r.remoteStore):"acknowledged"===t||"rejected"===t?(cc(r,e,i||null),lc(r,e),c=e,w(w(r.localStore).mutationQueue).Fn(c)):A(),yield yt(r,s)):E("SyncEngine","Cannot apply mutation batch with id: "+e)}),_c.apply(this,arguments)}function gc(){return gc=(0,y.Z)(function*(n,e){const t=w(n);if(Qs(t),bc(t),!0===e&&!0!==t.La){const i=t.sharedClientState.getAllActiveQueryTargets(),r=yield pp(t,i.toArray());t.La=!0,yield Bl(t.remoteStore,!0);for(const s of r)Ws(t.remoteStore,s)}else if(!1===e&&!1!==t.La){const i=[];let r=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?i.push(o):r=r.then(()=>(si(t,o),Qn(t.localStore,o,!0))),Jn(t.remoteStore,o)}),yield r,yield pp(t,i),function(o){const a=w(o);a.Fa.forEach((c,d)=>{Jn(a.remoteStore,d)}),a.Ma.Vr(),a.Fa=new Map,a.va=new W(I.comparator)}(t),t.La=!1,yield Bl(t.remoteStore,!1)}}),gc.apply(this,arguments)}function pp(n,e,t){return yc.apply(this,arguments)}function yc(){return yc=(0,y.Z)(function*(n,e,t){const i=w(n),r=[],s=[];for(const o of e){let a;const c=i.Da.get(o);if(c&&0!==c.length){a=yield Yn(i.localStore,Me(c[0]));for(const d of c){const u=i.ba.get(d),h=yield jw(i,u);h.snapshot&&s.push(h.snapshot)}}else{const d=yield Gm(i.localStore,o);a=yield Yn(i.localStore,d),yield Xl(i,_p(d),o,!1,a.resumeToken)}r.push(a)}return i.Sa.l_(s),r}),yc.apply(this,arguments)}function _p(n){return yf(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function $w(n){return t=w(n).localStore,w(w(t).persistence).Li();var t}function Ww(n,e,t,i){return vc.apply(this,arguments)}function vc(){return vc=(0,y.Z)(function*(n,e,t,i){const r=w(n);if(r.La)return void E("SyncEngine","Ignoring unexpected query state notification.");const s=r.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=yield jm(r.localStore,Ef(s[0])),a=or.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,me.EMPTY_BYTE_STRING);yield yt(r,o,a);break}case"rejected":yield Qn(r.localStore,e,!0),si(r,e,i);break;default:A()}}),vc.apply(this,arguments)}function Yw(n,e,t){return xc.apply(this,arguments)}function xc(){return xc=(0,y.Z)(function*(n,e,t){const i=Qs(n);if(i.La){for(const r of e){if(i.Da.has(r)&&i.sharedClientState.isActiveQueryTarget(r)){E("SyncEngine","Adding an already active target "+r);continue}const s=yield Gm(i.localStore,r),o=yield Yn(i.localStore,s);yield Xl(i,_p(s),o.targetId,!1,o.resumeToken),Ws(i.remoteStore,o)}for(const r of t)i.Da.has(r)&&(yield Qn(i.localStore,r,!1).then(()=>{Jn(i.remoteStore,r),si(i,r)}).catch(Tt))}}),xc.apply(this,arguments)}function Qs(n){const e=w(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=hp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Gw.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Nw.bind(null,e),e.Sa.l_=Tw.bind(null,e.eventManager),e.Sa.ka=Aw.bind(null,e.eventManager),e}function bc(n){const e=w(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Lw.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Bw.bind(null,e),e}class vr{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,y.Z)(function*(){t.serializer=gr(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return Bm(this.persistence,new Lm,e.initialUser,this.serializer)}createPersistence(e){return new al(Us.jr,this.serializer)}createSharedClientState(e){return new $m}terminate(){var e=this;return(0,y.Z)(function*(){var t,i;null===(t=e.gcScheduler)||void 0===t||t.stop(),null===(i=e.indexBackfillerScheduler)||void 0===i||i.stop(),e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class Ec extends vr{constructor(e,t,i){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,i=this;return(0,y.Z)(function*(){yield t().call(i,e),yield i.Qa.initialize(i,e),yield bc(i.Qa.syncEngine),yield ei(i.Qa.remoteStore),yield i.persistence.mi(()=>(i.gcScheduler&&!i.gcScheduler.started&&i.gcScheduler.start(),i.indexBackfillerScheduler&&!i.indexBackfillerScheduler.started&&i.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return Bm(this.persistence,new Lm,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new Rm(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const i=new xb(t,this.persistence);return new vb(e.asyncQueue,i)}createPersistence(e){const t=dl(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=void 0!==this.cacheSizeBytes?Re.withCacheSize(this.cacheSizeBytes):Re.DEFAULT;return new cl(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,Ym(),$s(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new $m}}class gp extends Ec{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,i=this;return(0,y.Z)(function*(){yield t().call(i,e);const r=i.Qa.syncEngine;i.sharedClientState instanceof vl&&(i.sharedClientState.syncEngine={Ys:Zw.bind(null,r),Zs:Ww.bind(null,r),Xs:Yw.bind(null,r),Li:$w.bind(null,r),Js:Hw.bind(null,r)},yield i.sharedClientState.start()),yield i.persistence.mi(function(){var s=(0,y.Z)(function*(o){yield function Kw(n,e){return gc.apply(this,arguments)}(i.Qa.syncEngine,o),i.gcScheduler&&(o&&!i.gcScheduler.started?i.gcScheduler.start():o||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(o&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():o||i.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const t=Ym();if(!vl.D(t))throw new x(_.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=dl(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new vl(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class oi{initialize(e,t){var i=this;return(0,y.Z)(function*(){i.localStore||(i.localStore=e.localStore,i.sharedClientState=e.sharedClientState,i.datastore=i.createDatastore(t),i.remoteStore=i.createRemoteStore(t),i.eventManager=i.createEventManager(t),i.syncEngine=i.createSyncEngine(t,!e.synchronizeTabs),i.sharedClientState.onlineStateHandler=r=>fp(i.syncEngine,r,1),i.remoteStore.remoteSyncer.handleCredentialChange=qw.bind(null,i.syncEngine),yield Bl(i.remoteStore,i.syncEngine.isPrimaryClient))})()}createEventManager(e){return new Iw}createDatastore(e){const t=gr(e.databaseInfo.databaseId),i=new ow(e.databaseInfo);return new cw(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return i=this.localStore,r=this.datastore,s=e.asyncQueue,o=t=>fp(this.syncEngine,t,0),a=Wm.D()?new Wm:new iw,new hw(i,r,s,o,a);var i,r,s,o,a}createSyncEngine(e,t){return function(r,s,o,a,c,d,u){const h=new Dw(r,s,o,a,c,d);return u&&(h.La=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){var e=this;return(0,y.Z)(function*(){var t,i;yield(i=(0,y.Z)(function*(s){const o=w(s);E("RemoteStore","RemoteStore shutting down."),o.M_.add(5),yield Xn(o),o.O_.shutdown(),o.N_.set("Unknown")}),function r(s){return i.apply(this,arguments)})(e.remoteStore),null===(t=e.datastore)||void 0===t||t.terminate()})()}}function yp(n,e=10240){let t=0;return{read:()=>(0,y.Z)(function*(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})(),cancel:()=>(0,y.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class Xs{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):ae("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Jw{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new fe,this.buffer=new Uint8Array,this.Wa=new TextDecoder("utf-8"),this.Ga().then(i=>{i&&i.sa()?this.metadata.resolve(i.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(i?.ia)}`))},i=>this.metadata.reject(i))}close(){return this.Ua.cancel()}getMetadata(){var e=this;return(0,y.Z)(function*(){return e.metadata.promise})()}qa(){var e=this;return(0,y.Z)(function*(){return yield e.getMetadata(),e.Ga()})()}Ga(){var e=this;return(0,y.Z)(function*(){const t=yield e.za();if(null===t)return null;const i=e.Wa.decode(t),r=Number(i);isNaN(r)&&e.ja(`length string (${i}) is not valid number`);const s=yield e.Ha(r);return new Cw(JSON.parse(s),t.length+r)})()}Ja(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}za(){var e=this;return(0,y.Z)(function*(){for(;e.Ja()<0&&!(yield e.Ya()););if(0===e.buffer.length)return null;const t=e.Ja();t<0&&e.ja("Reached the end of bundle when a length string is expected.");const i=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),i})()}Ha(e){var t=this;return(0,y.Z)(function*(){for(;t.buffer.length<e;)(yield t.Ya())&&t.ja("Reached the end of bundle when more is expected.");const i=t.Wa.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),i})()}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){var e=this;return(0,y.Z)(function*(){const t=yield e.Ua.read();if(!t.done){const i=new Uint8Array(e.buffer.length+t.value.length);i.set(e.buffer),i.set(t.value,e.buffer.length),e.buffer=i}return t.done})()}}class e0{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,y.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw t.lastTransactionError=new x(_.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),t.lastTransactionError;const i=yield(r=(0,y.Z)(function*(o,a){const c=w(o),d={documents:a.map(m=>lr(c.serializer,m))},u=yield c.Mo("BatchGetDocuments",c.serializer.databaseId,B.emptyPath(),d,a.length),h=new Map;u.forEach(m=>{const g=function yE(n,e){return"found"in e?function(i,r){S(!!r.found);const s=st(i,r.found.name),o=le(r.found.updateTime),a=r.found.createTime?le(r.found.createTime):P.min(),c=new we({mapValue:{fields:r.found.fields}});return J.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(i,r){S(!!r.missing),S(!!r.readTime);const s=st(i,r.missing),o=le(r.readTime);return J.newNoDocument(s,o)}(n,e):A()}(c.serializer,m);h.set(g.key.toString(),g)});const f=[];return a.forEach(m=>{const g=h.get(m.toString());S(!!g),f.push(g)}),f}),function s(o,a){return r.apply(this,arguments)})(t.datastore,e);var r;return i.forEach(r=>t.recordVersion(r)),i})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new Gn(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,y.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastTransactionError)throw e.lastTransactionError;const t=e.readVersions;var i;e.mutations.forEach(i=>{t.delete(i.key.toString())}),t.forEach((i,r)=>{const s=I.fromPath(r);e.mutations.push(new qa(s,e.precondition(s)))}),yield(i=(0,y.Z)(function*(s,o){const a=w(s),c={writes:o.map(d=>cr(a.serializer,d))};yield a.Do("Commit",a.serializer.databaseId,B.emptyPath(),c)}),function r(s,o){return i.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw A();t=P.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new x(_.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(P.min())?ne.exists(!1):ne.updateTime(t):ne.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(P.min()))throw new x(_.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ne.updateTime(t)}return ne.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class t0{constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this.Za=i.maxAttempts,this.Jo=new bl(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){var e=this;this.Jo.Ko((0,y.Z)(function*(){const t=new e0(e.datastore),i=e.tu(t);i&&i.then(r=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(r)}).catch(s=>{e.nu(s)}))}).catch(r=>{e.nu(r)})}))}tu(e){try{const t=this.updateFunction(e);return!Hi(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!zf(t)}return!1}}class n0{constructor(e,t,i,r){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=ge.UNAUTHENTICATED,this.clientId=kh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,function(){var o=(0,y.Z)(function*(a){E("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(i,o=>(E("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new x(_.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new fe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,y.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(i){const r=ni(i,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}function Js(n,e){return wc.apply(this,arguments)}function wc(){return wc=(0,y.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),E("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(function(){var r=(0,y.Z)(function*(s){i.isEqual(s)||(yield zm(e.localStore,s),i=s)});return function(s){return r.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),wc.apply(this,arguments)}function Ic(n,e){return Tc.apply(this,arguments)}function Tc(){return Tc=(0,y.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield Ac(n);E("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>ip(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>ip(e.remoteStore,r)),n._onlineComponents=e}),Tc.apply(this,arguments)}function vp(n){return"FirebaseError"===n.name?n.code===_.FAILED_PRECONDITION||n.code===_.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function Ac(n){return Cc.apply(this,arguments)}function Cc(){return Cc=(0,y.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){E("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Js(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!vp(t))throw t;Ve("Error using user provided cache. Falling back to memory cache: "+t),yield Js(n,new vr)}}else E("FirestoreClient","Using default OfflineComponentProvider"),yield Js(n,new vr);return n._offlineComponents}),Cc.apply(this,arguments)}function eo(n){return Sc.apply(this,arguments)}function Sc(){return Sc=(0,y.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(E("FirestoreClient","Using user provided OnlineComponentProvider"),yield Ic(n,n._uninitializedComponentsProvider._online)):(E("FirestoreClient","Using default OnlineComponentProvider"),yield Ic(n,new oi))),n._onlineComponents}),Sc.apply(this,arguments)}function xp(n){return Ac(n).then(e=>e.persistence)}function ai(n){return Ac(n).then(e=>e.localStore)}function bp(n){return eo(n).then(e=>e.remoteStore)}function Rc(n){return eo(n).then(e=>e.syncEngine)}function li(n){return Pc.apply(this,arguments)}function Pc(){return Pc=(0,y.Z)(function*(n){const e=yield eo(n),t=e.eventManager;return t.onListen=kw.bind(null,e.syncEngine),t.onUnlisten=Fw.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Mw.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Ow.bind(null,e.syncEngine),t}),Pc.apply(this,arguments)}function wp(n,e,t={}){const i=new fe;return n.asyncQueue.enqueueAndForget((0,y.Z)(function*(){return function(s,o,a,c,d){const u=new Xs({next:f=>{o.enqueueAndForget(()=>jl(s,h));const m=f.docs.has(a);!m&&f.fromCache?d.reject(new x(_.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&c&&"server"===c.source?d.reject(new x(_.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(f)},error:f=>d.reject(f)}),h=new $l(Nn(a.path),u,{includeMetadataChanges:!0,ra:!0});return ql(s,h)}(yield li(n),n.asyncQueue,e,t,i)})),i.promise}function Ip(n,e,t={}){const i=new fe;return n.asyncQueue.enqueueAndForget((0,y.Z)(function*(){return function(s,o,a,c,d){const u=new Xs({next:f=>{o.enqueueAndForget(()=>jl(s,h)),f.fromCache&&"server"===c.source?d.reject(new x(_.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(f)},error:f=>d.reject(f)}),h=new $l(a,u,{includeMetadataChanges:!0,ra:!0});return ql(s,h)}(yield li(n),n.asyncQueue,e,t,i)})),i.promise}function Tp(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}const Ap=new Map;function Dc(n,e,t){if(!t)throw new x(_.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Cp(n,e,t,i){if(!0===e&&!0===i)throw new x(_.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Sp(n){if(!I.isDocumentKey(n))throw new x(_.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Rp(n){if(I.isDocumentKey(n))throw new x(_.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function to(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(i=n).constructor?i.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var i;return"function"==typeof n?"a function":A()}function L(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(_.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=to(n);throw new x(_.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Pp(n,e){if(e<=0)throw new x(_.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class Dp{constructor(e){var t,i;if(void 0===e.host){if(void 0!==e.ssl)throw new x(_.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new x(_.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Cp("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=Tp(null!==(i=e.experimentalLongPollingOptions)&&void 0!==i?i:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new x(_.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new x(_.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new x(_.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xr{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new x(_.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new x(_.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dp(e),void 0!==e.credentials&&(this._authCredentials=function(i){if(!i)return new ab;switch(i.type){case"firstParty":return new ub(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new x(_.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=Ap.get(t);i&&(E("ComponentProvider","Removing Datastore"),Ap.delete(t),i.terminate())}(this),Promise.resolve()}}class Ie{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Ie(this.firestore,e,this._query)}}class ee{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ot(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ee(this.firestore,e,this._key)}}class ot extends Ie{constructor(e,t,i){super(e,t,Nn(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ee(this.firestore,null,new I(e))}withConverter(e){return new ot(this.firestore,e,this._path)}}function Mp(n,e,...t){if(n=(0,j.m9)(n),Dc("collection","path",e),n instanceof xr){const i=B.fromString(e,...t);return Rp(i),new ot(n,null,i)}{if(!(n instanceof ee||n instanceof ot))throw new x(_.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(B.fromString(e,...t));return Rp(i),new ot(n.firestore,null,i)}}function no(n,e,...t){if(n=(0,j.m9)(n),1===arguments.length&&(e=kh.newId()),Dc("doc","path",e),n instanceof xr){const i=B.fromString(e,...t);return Sp(i),new ee(n,null,new I(i))}{if(!(n instanceof ee||n instanceof ot))throw new x(_.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(B.fromString(e,...t));return Sp(i),new ee(n.firestore,n instanceof ot?n.converter:null,new I(i))}}function Fp(n,e){return n=(0,j.m9)(n),e=(0,j.m9)(e),(n instanceof ee||n instanceof ot)&&(e instanceof ee||e instanceof ot)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function kc(n,e){return n=(0,j.m9)(n),e=(0,j.m9)(e),n instanceof Ie&&e instanceof Ie&&n.firestore===e.firestore&&Ji(n._query,e._query)&&n.converter===e.converter}class p0{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Jo=new bl(this,"async_queue_retry"),this.hu=()=>{const t=$s();t&&E("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Jo.Uo()};const e=$s();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const t=$s();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});const t=new fe;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){var e=this;return(0,y.Z)(function*(){if(0!==e.su.length){try{yield e.su[0](),e.su.shift(),e.Jo.reset()}catch(t){if(!At(t))throw t;E("AsyncQueue","Operation failed with retryable error: "+t)}e.su.length>0&&e.Jo.Ko(()=>e.Tu())}})()}Iu(e){const t=this.iu.then(()=>(this.uu=!0,e().catch(i=>{throw this.au=i,this.uu=!1,ae("INTERNAL UNHANDLED ERROR: ",function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),a}(i)),i}).then(i=>(this.uu=!1,i))));return this.iu=t,t}enqueueAfterDelay(e,t,i){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);const r=Ul.createAndSchedule(this,e,t,i,s=>this.Eu(s));return this._u.push(r),r}Pu(){this.au&&A()}verifyOperationInProgress(){}du(){var e=this;return(0,y.Z)(function*(){let t;do{t=e.iu,yield t}while(t!==e.iu)})()}Au(e){for(const t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this._u)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){const t=this._u.indexOf(e);this._u.splice(t,1)}}function Mc(n){return function(t,i){if("object"!=typeof t||null===t)return!1;const r=t;for(const s of["next","error","complete"])if(s in r&&"function"==typeof r[s])return!0;return!1}(n)}class _0{constructor(){this._progressObserver={},this._taskCompletionResolver=new fe,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Y extends xr{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new p0,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Op(this),this._firestoreClient.terminate()}}function oe(n){return n._firestoreClient||Op(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Op(n){var e,t,i;const r=n._freezeSettings(),s=(c=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new Ub(n._databaseId,c,n._persistenceKey,(u=r).host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,Tp(u.experimentalLongPollingOptions),u.useFetchStreams));var c,u;n._firestoreClient=new n0(n._authCredentials,n._appCheckCredentials,n._queue,s),null!==(t=r.localCache)&&void 0!==t&&t._offlineComponentProvider&&null!==(i=r.localCache)&&void 0!==i&&i._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}function Vp(n,e,t){const i=new fe;return n.asyncQueue.enqueue((0,y.Z)(function*(){try{yield Js(n,t),yield Ic(n,e),i.resolve()}catch(r){const s=r;if(!vp(s))throw s;Ve("Error enabling indexeddb cache. Falling back to memory cache: "+s),i.reject(s)}})).then(()=>i.promise)}function Np(n){if(n._initialized||n._terminated)throw new x(_.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class at{constructor(e){this._byteString=e}static fromBase64String(e){try{return new at(me.fromBase64String(e))}catch(t){throw new x(_.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new at(me.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class vt{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new x(_.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new X(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hn{constructor(e){this._methodName=e}}class io{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(_.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(_.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return M(this._lat,e._lat)||M(this._long,e._long)}}const C0=/^__.*__$/;class S0{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return null!==this.fieldMask?new _t(e,this.data,this.fieldMask,t,this.fieldTransforms):new qn(e,this.data,t,this.fieldTransforms)}}class Lp{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new _t(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Bp(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw A()}}class ro{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,void 0===s&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new ro(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.gu({path:i,yu:!1});return r.wu(e),r}Su(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.gu({path:i,yu:!1});return r.mu(),r}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return ao(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(0===e.length)throw this.Du("Document fields must not be empty");if(Bp(this.fu)&&C0.test(e))throw this.Du('Document fields cannot begin and end with "__"')}}class R0{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||gr(e)}Fu(e,t,i,r=!1){return new ro({fu:e,methodName:t,vu:i,path:X.emptyPath(),yu:!1,Cu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fn(n){const e=n._freezeSettings(),t=gr(n._databaseId);return new R0(n._databaseId,!!e.ignoreUndefinedProperties,t)}function so(n,e,t,i,r,s={}){const o=n.Fu(s.merge||s.mergeFields?2:0,e,t,r);zc("Data must be an object, but it was:",o,i);const a=qp(i,o);let c,d;if(s.merge)c=new Ne(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const f=wr(e,h,t);if(!o.contains(f))throw new x(_.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);jp(u,f)||u.push(f)}c=new Ne(u),d=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,d=o.fieldTransforms;return new S0(new we(a),c,d)}class Er extends hn{_toFieldTransform(e){if(2!==e.fu)throw e.Du(1===e.fu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Er}}function zp(n,e,t){return new ro({fu:3,vu:e.settings.vu,methodName:n._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Fc extends hn{_toFieldTransform(e){return new ir(e.path,new zn)}isEqual(e){return e instanceof Fc}}class Oc extends hn{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){const t=zp(this,e,!0),i=this.Mu.map(s=>mn(s,t)),r=new nn(i);return new ir(e.path,r)}isEqual(e){return e instanceof Oc&&(0,j.vZ)(this.Mu,e.Mu)}}class Vc extends hn{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){const t=zp(this,e,!0),i=this.Mu.map(s=>mn(s,t)),r=new rn(i);return new ir(e.path,r)}isEqual(e){return e instanceof Vc&&(0,j.vZ)(this.Mu,e.Mu)}}class Nc extends hn{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){const t=new Un(e.serializer,Rf(e.serializer,this.xu));return new ir(e.path,t)}isEqual(e){return e instanceof Nc&&this.xu===e.xu}}function Lc(n,e,t,i){const r=n.Fu(1,e,t);zc("Data must be an object, but it was:",r,i);const s=[],o=we.empty();Ct(i,(c,d)=>{const u=oo(e,c,t);d=(0,j.m9)(d);const h=r.Su(u);if(d instanceof Er)s.push(u);else{const f=mn(d,h);null!=f&&(s.push(u),o.set(u,f))}});const a=new Ne(s);return new Lp(o,a,r.fieldTransforms)}function Bc(n,e,t,i,r,s){const o=n.Fu(1,e,t),a=[wr(e,i,t)],c=[r];if(s.length%2!=0)throw new x(_.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(wr(e,s[f])),c.push(s[f+1]);const d=[],u=we.empty();for(let f=a.length-1;f>=0;--f)if(!jp(d,a[f])){const m=a[f];let g=c[f];g=(0,j.m9)(g);const v=o.Su(m);if(g instanceof Er)d.push(m);else{const b=mn(g,v);null!=b&&(d.push(m),u.set(m,b))}}const h=new Ne(d);return new Lp(u,h,o.fieldTransforms)}function Up(n,e,t,i=!1){return mn(t,n.Fu(i?4:3,e))}function mn(n,e){if(Gp(n=(0,j.m9)(n)))return zc("Unsupported field value:",e,n),qp(n,e);if(n instanceof hn)return function(i,r){if(!Bp(r.fu))throw r.Du(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Du(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&4!==e.fu)throw e.Du("Nested arrays are not supported");return function(i,r){const s=[];let o=0;for(const a of i){let c=mn(a,r.bu(o));null==c&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(i,r){if(null===(i=(0,j.m9)(i)))return{nullValue:"NULL_VALUE"};if("number"==typeof i)return Rf(r.serializer,i);if("boolean"==typeof i)return{booleanValue:i};if("string"==typeof i)return{stringValue:i};if(i instanceof Date){const s=te.fromDate(i);return{timestampValue:jn(r.serializer,s)}}if(i instanceof te){const s=new te(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:jn(r.serializer,s)}}if(i instanceof io)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof at)return{bytesValue:Yf(r.serializer,i._byteString)};if(i instanceof ee){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:$a(i.firestore._databaseId||r.databaseId,i._key.path)}}throw r.Du(`Unsupported field value: ${to(i)}`)}(n,e)}function qp(n,e){const t={};return Wh(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ct(n,(i,r)=>{const s=mn(r,e.pu(i));null!=s&&(t[i]=s)}),{mapValue:{fields:t}}}function Gp(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof te||n instanceof io||n instanceof at||n instanceof ee||n instanceof hn)}function zc(n,e,t){if(!Gp(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const i=to(t);throw e.Du("an object"===i?n+" a custom object":n+" "+i)}var r}function wr(n,e,t){if((e=(0,j.m9)(e))instanceof vt)return e._internalPath;if("string"==typeof e)return oo(n,e);throw ao("Field path arguments must be of type string or ",n,!1,void 0,t)}const P0=new RegExp("[~\\*/\\[\\]]");function oo(n,e,t){if(e.search(P0)>=0)throw ao(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new vt(...e.split("."))._internalPath}catch{throw ao(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ao(n,e,t,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new x(_.INVALID_ARGUMENT,a+n+c)}function jp(n,e){return n.some(t=>t.isEqual(e))}class Ir{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ee(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new D0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(lo("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class D0 extends Ir{data(){return super.data()}}function lo(n,e){return"string"==typeof e?oo(n,e):e instanceof vt?e._internalPath:e._delegate._internalPath}function Hp(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new x(_.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Uc{}class Tr extends Uc{}function Bt(n,e,...t){let i=[];e instanceof Uc&&i.push(e),i=i.concat(t),function(s){const o=s.filter(c=>c instanceof ci).length,a=s.filter(c=>c instanceof Ar).length;if(o>1||o>0&&a>0)throw new x(_.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class Ar extends Tr{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Ar(e,t,i)}_apply(e){const t=this._parse(e);return Wp(e._query,t),new Ie(e.firestore,e.converter,za(e._query,t))}_parse(e){const t=fn(e.firestore);return function(s,o,a,c,d,u,h){let f;if(d.isKeyField()){if("array-contains"===u||"array-contains-any"===u)throw new x(_.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if("in"===u||"not-in"===u){$p(h,u);const m=[];for(const g of h)m.push(Kp(c,s,g));f={arrayValue:{values:m}}}else f=Kp(c,s,h)}else"in"!==u&&"not-in"!==u&&"array-contains-any"!==u||$p(h,u),f=Up(a,"where",h,"in"===u||"not-in"===u);return z.create(d,u,f)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class ci extends Uc{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new ci(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return 1===t.length?t[0]:K.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(r,s){let o=r;const a=s.getFlattenedFilters();for(const c of a)Wp(o,c),o=za(o,c)}(e._query,t),new Ie(e.firestore,e.converter,za(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class qc extends Tr{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new qc(e,t)}_apply(e){const t=function(r,s,o){if(null!==r.startAt)throw new x(_.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new x(_.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Qi(s,o)}(e._query,this._field,this._direction);return new Ie(e.firestore,e.converter,function(r,s){const o=r.explicitOrderBy.concat([s]);return new mt(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class co extends Tr{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new co(e,t,i)}_apply(e){return new Ie(e.firestore,e.converter,Ss(e._query,this._limit,this._limitType))}}class uo extends Tr{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new uo(e,t,i)}_apply(e){const t=Zp(e,this.type,this._docOrFields,this._inclusive);return new Ie(e.firestore,e.converter,(s=t,new mt((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,s,r.endAt)));var r,s}}class ho extends Tr{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new ho(e,t,i)}_apply(e){const t=Zp(e,this.type,this._docOrFields,this._inclusive);return new Ie(e.firestore,e.converter,(s=t,new mt((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,s)));var r,s}}function Zp(n,e,t,i){if(t[0]=(0,j.m9)(t[0]),t[0]instanceof Ir)return function(s,o,a,c,d){if(!c)throw new x(_.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const u=[];for(const h of Ln(s))if(h.field.isKeyField())u.push(en(o,c.key));else{const f=c.data.field(h.field);if(bs(f))throw new x(_.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===f){const m=h.field.canonicalString();throw new x(_.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}u.push(f)}return new kt(u,d)}(n._query,n.firestore._databaseId,e,t[0]._document,i);{const r=fn(n.firestore);return function(o,a,c,d,u,h){const f=o.explicitOrderBy;if(u.length>f.length)throw new x(_.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const m=[];for(let g=0;g<u.length;g++){const v=u[g];if(f[g].field.isKeyField()){if("string"!=typeof v)throw new x(_.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof v}`);if(!Ba(o)&&-1!==v.indexOf("/"))throw new x(_.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${v}' contains a slash.`);const b=o.path.child(B.fromString(v));if(!I.isDocumentKey(b))throw new x(_.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${b}' is not because it contains an odd number of segments.`);const C=new I(b);m.push(en(a,C))}else{const b=Up(c,d,v);m.push(b)}}return new kt(m,h)}(n._query,n.firestore._databaseId,r,e,t,i)}}function Kp(n,e,t){if("string"==typeof(t=(0,j.m9)(t))){if(""===t)throw new x(_.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ba(e)&&-1!==t.indexOf("/"))throw new x(_.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(B.fromString(t));if(!I.isDocumentKey(i))throw new x(_.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return en(n,new I(i))}if(t instanceof ee)return en(n,t._key);throw new x(_.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${to(t)}.`)}function $p(n,e){if(!Array.isArray(n)||0===n.length)throw new x(_.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Wp(n,e){const t=function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new x(_.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Gc{convertValue(e,t="none"){switch(Pt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return se(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ft(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw A()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Ct(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertGeoPoint(e){return new io(se(e.latitude),se(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Es(e);return null==i?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Ki(e));default:return null}}convertTimestamp(e){const t=ht(e);return new te(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=B.fromString(e);S(am(i));const r=new St(i.get(1),i.get(3)),s=new I(i.popFirst(5));return r.isEqual(t)||ae(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function fo(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class z0 extends Gc{constructor(e){super(),this.firestore=e}convertBytes(e){return new at(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ee(this.firestore,null,t)}}class pn{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xt extends Ir{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Cr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(lo("DocumentSnapshot.get",e));if(null!==i)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class Cr extends xt{data(e={}){return super.data(e)}}class zt{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new pn(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Cr(this._firestore,this._userDataWriter,i.key,i,new pn(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new x(_.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>({type:"added",doc:new Cr(r._firestore,r._userDataWriter,a.doc.key,a.doc,new pn(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:o++}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>s||3!==a.type).map(a=>{const c=new Cr(r._firestore,r._userDataWriter,a.doc.key,a.doc,new pn(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let d=-1,u=-1;return 0!==a.type&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),1!==a.type&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:q0(a.type),doc:c,oldIndex:d,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function q0(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return A()}}function Qp(n,e){return n instanceof xt&&e instanceof xt?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof zt&&e instanceof zt&&n._firestore===e._firestore&&kc(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class Ut extends Gc{constructor(e){super(),this.firestore=e}convertBytes(e){return new at(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ee(this.firestore,null,t)}}function Xp(n,e,t){n=L(n,ee);const i=L(n.firestore,Y),r=fo(n.converter,e,t);return di(i,[so(fn(i),"setDoc",n._key,r,null!==n.converter,t).toMutation(n._key,ne.none())])}function Jp(n,e,t,...i){n=L(n,ee);const r=L(n.firestore,Y),s=fn(r);let o;return o="string"==typeof(e=(0,j.m9)(e))||e instanceof vt?Bc(s,"updateDoc",n._key,e,t,i):Lc(s,"updateDoc",n._key,e),di(r,[o.toMutation(n._key,ne.exists(!0))])}function e_(n,...e){var t,i,r;n=(0,j.m9)(n);let s={includeMetadataChanges:!1,source:"default"},o=0;"object"!=typeof e[o]||Mc(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Mc(e[o])){const h=e[o];e[o]=null===(t=h.next)||void 0===t?void 0:t.bind(h),e[o+1]=null===(i=h.error)||void 0===i?void 0:i.bind(h),e[o+2]=null===(r=h.complete)||void 0===r?void 0:r.bind(h)}let c,d,u;if(n instanceof ee)d=L(n.firestore,Y),u=Nn(n._key.path),c={next:h=>{e[o]&&e[o](jc(d,n,h))},error:e[o+1],complete:e[o+2]};else{const h=L(n,Ie);d=L(h.firestore,Y),u=h._query;const f=new Ut(d);c={next:m=>{e[o]&&e[o](new zt(d,f,h,m))},error:e[o+1],complete:e[o+2]},Hp(n._query)}return function(f,m,g,v){const b=new Xs(v),C=new $l(m,b,g);return f.asyncQueue.enqueueAndForget((0,y.Z)(function*(){return ql(yield li(f),C)})),()=>{b.$a(),f.asyncQueue.enqueueAndForget((0,y.Z)(function*(){return jl(yield li(f),C)}))}}(oe(d),u,a,c)}function di(n,e){return function(i,r){const s=new fe;return i.asyncQueue.enqueueAndForget((0,y.Z)(function*(){return function Vw(n,e,t){return nc.apply(this,arguments)}(yield Rc(i),r,s)})),s.promise}(oe(n),e)}function jc(n,e,t){const i=t.docs.get(e._key),r=new Ut(n);return new xt(n,r,e._key,i,new pn(t.hasPendingWrites,t.fromCache),e.converter)}const oI={maxAttempts:5};class t_{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=fn(e)}set(e,t,i){this._verifyNotCommitted();const r=qt(e,this._firestore),s=fo(r.converter,t,i),o=so(this._dataReader,"WriteBatch.set",r._key,s,null!==r.converter,i);return this._mutations.push(o.toMutation(r._key,ne.none())),this}update(e,t,i,...r){this._verifyNotCommitted();const s=qt(e,this._firestore);let o;return o="string"==typeof(t=(0,j.m9)(t))||t instanceof vt?Bc(this._dataReader,"WriteBatch.update",s._key,t,i,r):Lc(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,ne.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=qt(e,this._firestore);return this._mutations=this._mutations.concat(new Gn(t._key,ne.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new x(_.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function qt(n,e){if((n=(0,j.m9)(n)).firestore!==e)throw new x(_.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class aI extends class{constructor(t,i){this._firestore=t,this._transaction=i,this._dataReader=fn(t)}get(t){const i=qt(t,this._firestore),r=new z0(this._firestore);return this._transaction.lookup([i._key]).then(s=>{if(!s||1!==s.length)return A();const o=s[0];if(o.isFoundDocument())return new Ir(this._firestore,r,o.key,o,i.converter);if(o.isNoDocument())return new Ir(this._firestore,r,i._key,null,i.converter);throw A()})}set(t,i,r){const s=qt(t,this._firestore),o=fo(s.converter,i,r),a=so(this._dataReader,"Transaction.set",s._key,o,null!==s.converter,r);return this._transaction.set(s._key,a),this}update(t,i,r,...s){const o=qt(t,this._firestore);let a;return a="string"==typeof(i=(0,j.m9)(i))||i instanceof vt?Bc(this._dataReader,"Transaction.update",o._key,i,r,s):Lc(this._dataReader,"Transaction.update",o._key,i),this._transaction.update(o._key,a),this}delete(t){const i=qt(t,this._firestore);return this._transaction.delete(i._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=qt(e,this._firestore),i=new Ut(this._firestore);return super.get(e).then(r=>new xt(this._firestore,i,t._key,r._document,new pn(!1,!1),t.converter))}}function Zc(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new x("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function s_(){if(typeof Uint8Array>"u")throw new x("unimplemented","Uint8Arrays are not available in this environment.")}function o_(){if(!function Bb(){return typeof atob<"u"}())throw new x("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,t=!0){Rn=Hr.SDK_VERSION,(0,Hr._registerComponent)(new uu.wA("firestore",(i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new Y(new cb(i.getProvider("auth-internal")),new hb(i.getProvider("app-check-internal")),function(d,u){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new x(_.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new St(d.options.projectId,u)}(o,r),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),(0,Hr.registerVersion)(Rh,"4.6.1",e),(0,Hr.registerVersion)(Rh,"4.6.1","esm2017")}();class Sr{constructor(e){this._delegate=e}static fromBase64String(e){return o_(),new Sr(at.fromBase64String(e))}static fromUint8Array(e){return s_(),new Sr(at.fromUint8Array(e))}toBase64(){return o_(),this._delegate.toBase64()}toUint8Array(){return s_(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Kc(n){return function gI(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const i of e)if(i in t&&"function"==typeof t[i])return!0;return!1}(n,["next","error","complete"])}class yI{enableIndexedDbPersistence(e,t){return function y0(n,e){Np(n=L(n,Y));const t=oe(n);if(t._uninitializedComponentsProvider)throw new x(_.FAILED_PRECONDITION,"SDK cache is already specified.");Ve("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const i=n._freezeSettings(),r=new oi;return Vp(t,r,new Ec(r,i.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function v0(n){Np(n=L(n,Y));const e=oe(n);if(e._uninitializedComponentsProvider)throw new x(_.FAILED_PRECONDITION,"SDK cache is already specified.");Ve("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),i=new oi;return Vp(e,i,new gp(i,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function x0(n){if(n._initialized&&!n._terminated)throw new x(_.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new fe;return n._queue.enqueueAndForgetEvenWhileRestricted((0,y.Z)(function*(){try{yield(t=(0,y.Z)(function*(r){if(!tt.D())return Promise.resolve();const s=r+"main";yield tt.delete(s)}),function i(r){return t.apply(this,arguments)})(dl(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class a_{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof St||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Ve("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,i={}){!function kp(n,e,t,i={}){var r;const s=(n=L(n,xr))._getSettings(),o=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Ve("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,c;if("string"==typeof i.mockUserToken)a=i.mockUserToken,c=ge.MOCK_USER;else{a=(0,j.Sg)(i.mockUserToken,null===(r=n._app)||void 0===r?void 0:r.options.projectId);const d=i.mockUserToken.sub||i.mockUserToken.user_id;if(!d)throw new x(_.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new ge(d)}n._authCredentials=new lb(new Ph(a,c))}}(this._delegate,e,t,i)}enableNetwork(){return function E0(n){return function r0(n){return n.asyncQueue.enqueue((0,y.Z)(function*(){const e=yield xp(n),t=yield bp(n);return e.setNetworkEnabled(!0),function(r){const s=w(r);return s.M_.delete(0),yr(s)}(t)}))}(oe(n=L(n,Y)))}(this._delegate)}disableNetwork(){return function w0(n){return function s0(n){return n.asyncQueue.enqueue((0,y.Z)(function*(){const e=yield xp(n),t=yield bp(n);return e.setNetworkEnabled(!1),(i=(0,y.Z)(function*(s){const o=w(s);o.M_.add(0),yield Xn(o),o.N_.set("Offline")}),function r(s){return i.apply(this,arguments)})(t);var i}))}(oe(n=L(n,Y)))}(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,Cp("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function b0(n){return function(t){const i=new fe;return t.asyncQueue.enqueueAndForget((0,y.Z)(function*(){return function zw(n,e){return ac.apply(this,arguments)}(yield Rc(t),i)})),i.promise}(oe(n=L(n,Y)))}(this._delegate)}onSnapshotsInSync(e){return function Q0(n,e){return function l0(n,e){const t=new Xs(e);return n.asyncQueue.enqueueAndForget((0,y.Z)(function*(){return r=yield li(n),s=t,w(r).z_.add(s),void s.next();var r,s})),()=>{t.$a(),n.asyncQueue.enqueueAndForget((0,y.Z)(function*(){return r=yield li(n),s=t,void w(r).z_.delete(s);var r,s}))}}(oe(n=L(n,Y)),Mc(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new x("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ui(this,Mp(this._delegate,e))}catch(t){throw Fe(t,"collection()","Firestore.collection()")}}doc(e){try{return new He(this,no(this._delegate,e))}catch(t){throw Fe(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Oe(this,function m0(n,e){if(n=L(n,xr),Dc("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new x(_.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ie(n,null,(i=e,new mt(B.emptyPath(),i)));var i}(this._delegate,e))}catch(t){throw Fe(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function lI(n,e,t){n=L(n,Y);const i=Object.assign(Object.assign({},oI),t);return function(s){if(s.maxAttempts<1)throw new x(_.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(s,o,a){const c=new fe;return s.asyncQueue.enqueueAndForget((0,y.Z)(function*(){const d=yield function Ep(n){return eo(n).then(e=>e.datastore)}(s);new t0(s.asyncQueue,d,a,o,c).Xa()})),c.promise}(oe(n),r=>e(new aI(n,r)),i)}(this._delegate,t=>e(new l_(this,t)))}batch(){return oe(this._delegate),new c_(new t_(this._delegate,e=>di(this._delegate,e)))}loadBundle(e){return function I0(n,e){const t=oe(n=L(n,Y)),i=new _0;return function c0(n,e,t,i){const r=function(o,a){let c;return c="string"==typeof o?qf().encode(o):o,u=function(u,h){if(u instanceof Uint8Array)return yp(u,h);if(u instanceof ArrayBuffer)return yp(new Uint8Array(u),h);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),new Jw(u,a);var u}(t,gr(e));n.asyncQueue.enqueueAndForget((0,y.Z)(function*(){!function Qw(n,e,t){const i=w(n);var r;(r=(0,y.Z)(function*(o,a,c){try{const d=yield a.getMetadata();if(yield function(g,v){const b=w(g),C=le(v.createTime);return b.persistence.runTransaction("hasNewerBundle","readonly",k=>b.Kr.getBundleMetadata(k,v.id)).then(k=>!!k&&k.createTime.compareTo(C)>=0)}(o.localStore,d))return yield a.close(),c._completeWith({taskState:"Success",documentsLoaded:(g=d).totalDocuments,bytesLoaded:g.totalBytes,totalDocuments:g.totalDocuments,totalBytes:g.totalBytes}),Promise.resolve(new Set);c._updateProgress(ap(d));const u=new Sw(d,o.localStore,a.serializer);let h=yield a.qa();for(;h;){const m=yield u._a(h);m&&c._updateProgress(m),h=yield a.qa()}const f=yield u.complete();return yield yt(o,f.ca,void 0),yield function(g,v){const b=w(g);return b.persistence.runTransaction("Save bundle","readwrite",C=>b.Kr.saveBundleMetadata(C,v))}(o.localStore,d),c._completeWith(f.progress),Promise.resolve(f.ua)}catch(d){return Ve("SyncEngine",`Loading bundle failed with ${d}`),c._failWith(d),Promise.resolve(new Set)}var g}),function s(o,a,c){return r.apply(this,arguments)})(i,e,t).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}(yield Rc(n),r,i)}))}(t,n._databaseId,e,i),i}(this._delegate,e)}namedQuery(e){return function T0(n,e){return function d0(n,e){return n.asyncQueue.enqueue((0,y.Z)(function*(){return function(i,r){const s=w(i);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,r))}(yield ai(n),e)}))}(oe(n=L(n,Y)),e).then(t=>t?new Ie(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Oe(this,t):null)}}class po extends Gc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Sr(new at(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return He.forKey(t,this.firestore,null)}}class l_{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new po(e)}get(e){const t=gn(e);return this._delegate.get(t).then(i=>new Rr(this._firestore,new xt(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const r=gn(e);return i?(Zc("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=gn(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=gn(e);return this._delegate.delete(t),this}}class c_{constructor(e){this._delegate=e}set(e,t,i){const r=gn(e);return i?(Zc("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=gn(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=gn(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class _n{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new Cr(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Pr(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=_n.INSTANCES;let r=i.get(e);r||(r=new WeakMap,i.set(e,r));let s=r.get(t);return s||(s=new _n(e,new po(e),t),r.set(t,s)),s}}_n.INSTANCES=new WeakMap;class He{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new po(e)}static forPath(e,t,i){if(e.length%2!=0)throw new x("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new He(t,new ee(t._delegate,i,new I(e)))}static forKey(e,t,i){return new He(t,new ee(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new ui(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ui(this.firestore,Mp(this._delegate,e))}catch(t){throw Fe(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,j.m9)(e))instanceof ee&&Fp(this._delegate,e)}set(e,t){t=Zc("DocumentReference.set",t);try{return t?Xp(this._delegate,e,t):Xp(this._delegate,e)}catch(i){throw Fe(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return 1===arguments.length?Jp(this._delegate,e):Jp(this._delegate,e,t,...i)}catch(r){throw Fe(r,"updateDoc()","DocumentReference.update()")}}delete(){return function W0(n){return di(L(n.firestore,Y),[new Gn(n._key,ne.none())])}(this._delegate)}onSnapshot(...e){const t=d_(e),i=u_(e,r=>new Rr(this.firestore,new xt(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return e_(this._delegate,t,i)}get(e){let t;return t="cache"===e?.source?function j0(n){n=L(n,ee);const e=L(n.firestore,Y),t=oe(e),i=new Ut(e);return function o0(n,e){const t=new fe;return n.asyncQueue.enqueueAndForget((0,y.Z)(function*(){return(i=(0,y.Z)(function*(s,o,a){try{const c=yield function(u,h){const f=w(u);return f.persistence.runTransaction("read document","readonly",m=>f.localDocuments.getDocument(m,h))}(s,o);c.isFoundDocument()?a.resolve(c):c.isNoDocument()?a.resolve(null):a.reject(new x(_.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(c){const d=ni(c,`Failed to get document '${o} from cache`);a.reject(d)}}),function r(s,o,a){return i.apply(this,arguments)})(yield ai(n),e,t);var i})),t.promise}(t,n._key).then(r=>new xt(e,i,n._key,r,new pn(null!==r&&r.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function H0(n){n=L(n,ee);const e=L(n.firestore,Y);return wp(oe(e),n._key,{source:"server"}).then(t=>jc(e,n,t))}(this._delegate):function G0(n){n=L(n,ee);const e=L(n.firestore,Y);return wp(oe(e),n._key).then(t=>jc(e,n,t))}(this._delegate),t.then(i=>new Rr(this.firestore,new xt(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new He(this.firestore,this._delegate.withConverter(e?_n.getInstance(this.firestore,e):null))}}function Fe(n,e,t){return n.message=n.message.replace(e,t),n}function d_(n){for(const e of n)if("object"==typeof e&&!Kc(e))return e;return{}}function u_(n,e){var t,i;let r;return r=Kc(n[0])?n[0]:Kc(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(e(s))},error:null===(t=r.error)||void 0===t?void 0:t.bind(r),complete:null===(i=r.complete)||void 0===i?void 0:i.bind(r)}}class Rr{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new He(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Qp(this._delegate,e._delegate)}}class Pr extends Rr{data(e){const t=this._delegate.data(e);return this._delegate._converter||function ob(n,e){n||A()}(void 0!==t),t}}class Oe{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new po(e)}where(e,t,i){try{return new Oe(this.firestore,Bt(this._delegate,function k0(n,e,t){const i=e,r=lo("where",n);return Ar._create(r,i,t)}(e,t,i)))}catch(r){throw Fe(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Oe(this.firestore,Bt(this._delegate,function M0(n,e="asc"){const t=e,i=lo("orderBy",n);return qc._create(i,t)}(e,t)))}catch(i){throw Fe(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Oe(this.firestore,Bt(this._delegate,function F0(n){return Pp("limit",n),co._create("limit",n,"F")}(e)))}catch(t){throw Fe(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Oe(this.firestore,Bt(this._delegate,function O0(n){return Pp("limitToLast",n),co._create("limitToLast",n,"L")}(e)))}catch(t){throw Fe(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Oe(this.firestore,Bt(this._delegate,function V0(...n){return uo._create("startAt",n,!0)}(...e)))}catch(t){throw Fe(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Oe(this.firestore,Bt(this._delegate,function N0(...n){return uo._create("startAfter",n,!1)}(...e)))}catch(t){throw Fe(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Oe(this.firestore,Bt(this._delegate,function L0(...n){return ho._create("endBefore",n,!1)}(...e)))}catch(t){throw Fe(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Oe(this.firestore,Bt(this._delegate,function B0(...n){return ho._create("endAt",n,!0)}(...e)))}catch(t){throw Fe(t,"endAt()","Query.endAt()")}}isEqual(e){return kc(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function K0(n){n=L(n,Ie);const e=L(n.firestore,Y),t=oe(e),i=new Ut(e);return function a0(n,e){const t=new fe;return n.asyncQueue.enqueueAndForget((0,y.Z)(function*(){return(i=(0,y.Z)(function*(s,o,a){try{const c=yield js(s,o,!0),d=new dp(o,c.ls),u=d.da(c.documents),h=d.applyChanges(u,!1);a.resolve(h.snapshot)}catch(c){const d=ni(c,`Failed to execute query '${o} against cache`);a.reject(d)}}),function r(s,o,a){return i.apply(this,arguments)})(yield ai(n),e,t);var i})),t.promise}(t,n._query).then(r=>new zt(e,i,n,r))}(this._delegate):"server"===e?.source?function $0(n){n=L(n,Ie);const e=L(n.firestore,Y),t=oe(e),i=new Ut(e);return Ip(t,n._query,{source:"server"}).then(r=>new zt(e,i,n,r))}(this._delegate):function Z0(n){n=L(n,Ie);const e=L(n.firestore,Y),t=oe(e),i=new Ut(e);return Hp(n._query),Ip(t,n._query).then(r=>new zt(e,i,n,r))}(this._delegate),t.then(i=>new $c(this.firestore,new zt(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=d_(e),i=u_(e,r=>new $c(this.firestore,new zt(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return e_(this._delegate,t,i)}withConverter(e){return new Oe(this.firestore,this._delegate.withConverter(e?_n.getInstance(this.firestore,e):null))}}class xI{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Pr(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class $c{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Oe(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Pr(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new xI(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new Pr(this._firestore,i))})}isEqual(e){return Qp(this._delegate,e._delegate)}}class ui extends Oe{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new He(this.firestore,e):null}doc(e){try{return new He(this.firestore,void 0===e?no(this._delegate):no(this._delegate,e))}catch(t){throw Fe(t,"doc()","CollectionReference.doc()")}}add(e){return function Y0(n,e){const t=L(n.firestore,Y),i=no(n),r=fo(n.converter,e);return di(t,[so(fn(n.firestore),"addDoc",i._key,r,null!==n.converter,{}).toMutation(i._key,ne.exists(!1))]).then(()=>i)}(this._delegate,e).then(t=>new He(this.firestore,t))}isEqual(e){return Fp(this._delegate,e._delegate)}withConverter(e){return new ui(this.firestore,this._delegate.withConverter(e?_n.getInstance(this.firestore,e):null))}}function gn(n){return L(n,ee)}class Wc{constructor(...e){this._delegate=new vt(...e)}static documentId(){return new Wc(X.keyField().canonicalString())}isEqual(e){return(e=(0,j.m9)(e))instanceof vt&&this._delegate._internalPath.isEqual(e._internalPath)}}class yn{constructor(e){this._delegate=e}static serverTimestamp(){const e=function dI(){return new Fc("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new yn(e)}static delete(){const e=function cI(){return new Er("deleteField")}();return e._methodName="FieldValue.delete",new yn(e)}static arrayUnion(...e){const t=function uI(...n){return new Oc("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new yn(t)}static arrayRemove(...e){const t=function hI(...n){return new Vc("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new yn(t)}static increment(e){const t=function fI(n){return new Nc("increment",n)}(e);return t._methodName="FieldValue.increment",new yn(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const bI={Firestore:a_,GeoPoint:io,Timestamp:te,Blob:Sr,Transaction:l_,WriteBatch:c_,DocumentReference:He,DocumentSnapshot:Rr,Query:Oe,QueryDocumentSnapshot:Pr,QuerySnapshot:$c,CollectionReference:ui,FieldPath:Wc,FieldValue:yn,setLogLevel:function vI(n){!function sb(n){It.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function h_(n,e){return function II(n,e=Mr.z){return new xn.y(t=>{let i;return null!=e?e.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},t)}):i=n.onSnapshot({includeMetadataChanges:!0},t),()=>{i?.()}})}(n,e)}function Yc(n,e){return h_(n,e).pipe((0,De.U)(t=>({payload:t,type:"query"})))}!function wI(n){(function EI(n,e){n.INTERNAL.registerComponent(new uu.wA("firestore-compat",t=>{const i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},bI)))})(n,(e,t)=>new a_(e,t,new yI)),n.registerVersion("@firebase/firestore-compat","0.3.30")}(Qv.Z),D(7142);class f_{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const i=this.ref.collection(e),{ref:r,query:s}=g_(i,t);return new __(r,s,this.afs)}snapshotChanges(){return function TI(n,e){return h_(n,e).pipe((0,bn.O)(void 0),No(),(0,De.U)(t=>{const[i,r]=t;return r.exists?i?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Be.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,De.U)(({payload:t})=>e.idField?{...t.data(),[e.idField]:t.id}:t.data()))}get(e){return(0,jr.D)(this.ref.get(e)).pipe(Be.iC)}}function _o(n,e){return Yc(n,e).pipe((0,bn.O)(void 0),No(),(0,De.U)(t=>{const[i,r]=t,s=r.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return i&&JSON.stringify(i.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((a,c)=>{const d=s.find(h=>h.doc.ref.isEqual(a.ref)),u=i?.payload.docs.find(h=>h.ref.isEqual(a.ref));d&&JSON.stringify(d.doc.metadata)===JSON.stringify(a.metadata)||!d&&u&&JSON.stringify(u.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function m_(n,e,t){return _o(n,t).pipe((0,Lo.R)((i,r)=>function AI(n,e,t){return e.forEach(i=>{t.indexOf(i.type)>-1&&(n=function CI(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return Qc(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return Qc(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Qc(n,e.oldIndex,1)}return n}(n,i))}),n}(i,r.map(s=>s.payload),e),[]),(0,su.x)(),(0,De.U)(i=>i.map(r=>({type:r.type,payload:r}))))}function Qc(n,e,t,...i){const r=n.slice();return r.splice(e,t,...i),r}function p_(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class __{ref;query;afs;constructor(e,t,i){this.ref=e,this.query=t,this.afs=i}stateChanges(e){let t=_o(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,De.U)(i=>i.filter(r=>e.indexOf(r.type)>-1)))),t.pipe((0,bn.O)(void 0),No(),(0,ct.h)(([i,r])=>r.length>0||!i),(0,De.U)(([,i])=>i),Be.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,Lo.R)((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=p_(e);return m_(this.query,t,this.afs.schedulers.outsideAngular).pipe(Be.iC)}valueChanges(e={}){return Yc(this.query,this.afs.schedulers.outsideAngular).pipe((0,De.U)(t=>t.payload.docs.map(i=>e.idField?{...i.data(),[e.idField]:i.id}:i.data())),Be.iC)}get(e){return(0,jr.D)(this.query.get(e)).pipe(Be.iC)}add(e){return this.ref.add(e)}doc(e){return new f_(this.ref.doc(e),this.afs)}}class SI{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?_o(this.query,this.afs.schedulers.outsideAngular).pipe((0,De.U)(t=>t.filter(i=>e.indexOf(i.type)>-1)),(0,ct.h)(t=>t.length>0),Be.iC):_o(this.query,this.afs.schedulers.outsideAngular).pipe(Be.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,Lo.R)((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=p_(e);return m_(this.query,t,this.afs.schedulers.outsideAngular).pipe(Be.iC)}valueChanges(e={}){return Yc(this.query,this.afs.schedulers.outsideAngular).pipe((0,De.U)(i=>i.payload.docs.map(r=>e.idField?{[e.idField]:r.id,...r.data()}:r.data())),Be.iC)}get(e){return(0,jr.D)(this.query.get(e)).pipe(Be.iC)}}const RI=new l.OlP("angularfire2.enableFirestorePersistence"),PI=new l.OlP("angularfire2.firestore.persistenceSettings"),DI=new l.OlP("angularfire2.firestore.settings"),kI=new l.OlP("angularfire2.firestore.use-emulator");function g_(n,e=(t=>t)){return{query:e(n),ref:n}}let MI=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,i,r,s,o,a,c,d,u,h,f,m,g,v,b,C,k){this.schedulers=c;const R=(0,Gr.on)(t,a,i),O=u;h&&(0,bt.nw)(R,a,f,g,v,b,m,C),[this.firestore,this.persistenceEnabled$]=(0,Gr.cc)(`${R.name}.firestore`,"AngularFirestore",R.name,()=>{const q=a.runOutsideAngular(()=>R.firestore());if(s&&q.settings(s),O&&q.useEmulator(...O),r&&!(0,G.PM)(o)){const H=()=>{try{return(0,jr.D)(q.enablePersistence(d||void 0).then(()=>!0,()=>!1))}catch(ce){return typeof console<"u"&&console.warn(ce),(0,Ro.of)(!1)}};return[q,a.runOutsideAngular(H)]}return[q,(0,Ro.of)(!1)]},[s,O,r])}collection(t,i){let r;r="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:o}=g_(r,i),a=this.schedulers.ngZone.run(()=>s);return new __(a,o,this)}collectionGroup(t,i){const r=i||(o=>o),s=this.firestore.collectionGroup(t);return new SI(r(s),this)}doc(t){let i;i="string"==typeof t?this.firestore.doc(t):t;const r=this.schedulers.ngZone.run(()=>i);return new f_(r,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(i){return new(i||n)(l.LFG(Gr.Dh),l.LFG(Gr.xv,8),l.LFG(RI,8),l.LFG(DI,8),l.LFG(l.Lbi),l.LFG(l.R0b),l.LFG(Be.HU),l.LFG(PI,8),l.LFG(kI,8),l.LFG(bt.zQ,8),l.LFG(bt.Qv,8),l.LFG(bt.L6,8),l.LFG(bt._Q,8),l.LFG(bt.rT,8),l.LFG(bt.lh,8),l.LFG(bt.f7,8),l.LFG(Be.Rf,8))};static \u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),FI=(()=>{class n{constructor(t,i){this._AngularFirestore=t,this._AuthService=i,this.userToken=localStorage.getItem("token")}addPatient(t){return this._AngularFirestore.createId(),this._AngularFirestore.collection(`users/${this.userToken}/Patients`).add(t)}getAllPatients(){return this.userToken=localStorage.getItem("token"),this._AngularFirestore.collection(`users/${this.userToken}/Patients`).snapshotChanges()}deletePatient(t){return this._AngularFirestore.doc(`users/${this.userToken}/Patients/${t.id}`).delete()}updatePatient(t){this.deletePatient(t),this.addPatient(t)}static#e=this.\u0275fac=function(i){return new(i||n)(l.LFG(MI),l.LFG(du.e))};static#t=this.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function OI(n,e){1&n&&(l.TgZ(0,"mat-error"),l._uU(1," First name is "),l.TgZ(2,"strong"),l._uU(3,"required"),l.qZA()())}function VI(n,e){1&n&&(l.TgZ(0,"mat-error"),l._uU(1," Name length must be at least "),l.TgZ(2,"strong"),l._uU(3,"3"),l.qZA(),l._uU(4," characters "),l.qZA())}function NI(n,e){1&n&&(l.TgZ(0,"mat-error"),l._uU(1," Name length must be at most "),l.TgZ(2,"strong"),l._uU(3,"20"),l.qZA(),l._uU(4," characters "),l.qZA())}function LI(n,e){1&n&&(l.TgZ(0,"mat-error"),l._uU(1," Last name is "),l.TgZ(2,"strong"),l._uU(3,"required"),l.qZA()())}function BI(n,e){1&n&&(l.TgZ(0,"mat-error"),l._uU(1," Name length must be at least "),l.TgZ(2,"strong"),l._uU(3,"3"),l.qZA(),l._uU(4," characters "),l.qZA())}function zI(n,e){1&n&&(l.TgZ(0,"mat-error"),l._uU(1," Name length must be at most "),l.TgZ(2,"strong"),l._uU(3,"20"),l.qZA(),l._uU(4," characters "),l.qZA())}function UI(n,e){if(1&n&&(l.TgZ(0,"mat-option",44),l._uU(1),l.qZA()),2&n){const t=e.$implicit;l.Q6J("value",t.value),l.xp6(1),l.hij(" ",t.viewValue," ")}}function qI(n,e){1&n&&(l.TgZ(0,"mat-error"),l._uU(1," Gender is "),l.TgZ(2,"strong"),l._uU(3,"required"),l.qZA()())}function GI(n,e){1&n&&(l.TgZ(0,"mat-error"),l._uU(1," Birth date is "),l.TgZ(2,"strong"),l._uU(3,"required"),l.qZA()())}function jI(n,e){1&n&&(l.TgZ(0,"mat-error"),l._uU(1," Email is "),l.TgZ(2,"strong"),l._uU(3,"required"),l.qZA()())}function HI(n,e){1&n&&(l.TgZ(0,"mat-error"),l._uU(1," Please enter a valid email address "),l.qZA())}function ZI(n,e){1&n&&(l.TgZ(0,"mat-error"),l._uU(1," Phone number is "),l.TgZ(2,"strong"),l._uU(3,"required"),l.qZA()())}function KI(n,e){1&n&&(l.TgZ(0,"mat-error"),l._uU(1," Please enter a valid phone number "),l.qZA())}function $I(n,e){if(1&n){const t=l.EpF();l.TgZ(0,"tr")(1,"td"),l._uU(2),l.qZA(),l.TgZ(3,"td"),l._uU(4),l.qZA(),l.TgZ(5,"td"),l._uU(6),l.qZA(),l.TgZ(7,"td"),l._uU(8),l.qZA(),l.TgZ(9,"td"),l._uU(10),l.qZA(),l.TgZ(11,"td"),l._uU(12),l.qZA(),l.TgZ(13,"td")(14,"button",45),l.NdJ("click",function(){const s=l.CHM(t).$implicit,o=l.oxw();return l.KtG(o.deletePatient(s))}),l._uU(15,"delete"),l.qZA()()()}if(2&n){const t=e.$implicit;l.xp6(2),l.Oqu(t.firstName),l.xp6(2),l.Oqu(t.lastName),l.xp6(2),l.Oqu(t.gender),l.xp6(2),l.Oqu(t.birthDate),l.xp6(2),l.Oqu(t.email),l.xp6(2),l.Oqu(t.phone)}}function WI(n,e){if(1&n&&l._UZ(0,"div",46),2&n){const t=l.oxw();l.Q6J("innerHtml",t.generatedText,l.oJD)}}function YI(n,e){1&n&&l._UZ(0,"i",47)}function QI(n,e){1&n&&l._UZ(0,"i",48)}class XI{isErrorState(e,t){return!!(e&&e.invalid&&(e.dirty||e.touched||t&&t.submitted))}}let JI=(()=>{class n{constructor(t,i,r){this._AuthService=t,this._DataService=i,this._GeminiService=r,this.patientList=[],this.genders=[{value:"male",viewValue:"Male"},{value:"female",viewValue:"Female"}],this.generatedText="",this.prompt="",this.loading=!1,this.createPatientForm=new N.cw({id:new N.NI(""),firstName:new N.NI(null,[N.kI.required,N.kI.minLength(3),N.kI.maxLength(20)]),lastName:new N.NI(null,[N.kI.required,N.kI.minLength(3),N.kI.maxLength(20)]),gender:new N.NI(null,[N.kI.required]),birthDate:new N.NI(null,[N.kI.required]),email:new N.NI(null,[N.kI.required,N.kI.email]),phone:new N.NI(null,[N.kI.required,N.kI.pattern(/^(01)[0125][0-9]{8}$/)])})}ngOnInit(){this.getAllPatients(),this._AuthService.saveUserToken()}signOut(){this._AuthService.singOut()}getAllPatients(){this._DataService.getAllPatients().subscribe({next:t=>{console.log(t),this.patientList=t.map(i=>{const r=i.payload.doc.data();return r.id=i.payload.doc.id,r}),console.log(this.patientList)},error:t=>{console.log(t)}})}addPatient(){this._DataService.addPatient(this.createPatientForm.value)}deletePatient(t){confirm(`are you sure you want to delete ${t.firstName} ${t.lastName} ?`)&&this._DataService.deletePatient(t)}callGemini(){}generateContent(){this.loading=!0,this._GeminiService.generateContent(this.prompt).subscribe({next:t=>{this.loading=!1,this.generatedText=this.styleContent(t.candidates[0].content.parts[0].text),console.log(this.generatedText),this.prompt=""},error:t=>{this.loading=!1,console.error("Error generating content:",t)}})}styleContent(t){return(t=(t=(t=(t=(t=(t=(t=t.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")).replace(/(?:^|\n)\*\s/g,"<li>").replace(/\n\s*\*\s/g,"</li><li>")).replace(/(<li>.*<\/li>)/gs,"<ul>$1</ul>")).replace(/<\/li>\n/g,"</li>")).replace(/(?:^|\n)(\*\*.*?\*\*)/g,"<h2>$1</h2>")).replace(/\n/g,"<p>")).replace(/<p><\/li>/g,"</li>")).replace(/<\/ul><p>/g,"</ul>")}toggleChat(){}static#e=this.\u0275fac=function(i){return new(i||n)(l.Y36(du.e),l.Y36(FI),l.Y36(cu))};static#t=this.\u0275cmp=l.Xpm({type:n,selectors:[["app-dashboard"]],standalone:!0,features:[l._Bn([cu]),l.jDz],decls:99,vars:20,consts:[[1,""],[1,"navbar","navbar-expand-sm","navbar-light","bg-light"],[1,"container"],["href","#",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapsibleNavId","aria-controls","collapsibleNavId","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler","d-lg-none"],[1,"navbar-toggler-icon"],["id","collapsibleNavId",1,"collapse","navbar-collapse"],[1,"navbar-nav","ms-auto","mt-2","mt-lg-0"],[1,"nav-item"],[1,"nav-link",3,"click"],[1,"container","mt-4"],[1,"row","justify-content-center","mb-3"],[1,"col-md-6"],[1,"example-form","mt-4",3,"formGroup"],[1,"text-center"],["appearance","outline",1,"example-full-width"],["formControlName","firstName","type","text","matInput","","placeholder","Enter patient first name"],[4,"ngIf"],["formControlName","lastName","type","text","matInput","","placeholder","Enter patient last name"],[1,"w-100"],["formControlName","gender"],[3,"value",4,"ngFor","ngForOf"],["formControlName","birthDate","type","date","matInput","","placeholder","Date"],["formControlName","email","type","text","matInput","","placeholder","Enter patient email"],["formControlName","phone","type","text","matInput","","placeholder","Enter patient phone"],["type","button",1,"btn","btn-outline-primary","d-block","ms-auto",3,"disabled","click"],[1,"row"],[1,"col-md-12"],[1,"text-center","text-success"],[1,"card","shadow","p-2"],[1,"table"],[4,"ngFor","ngForOf"],[1,"container","mt-5","position-fixed","top-50","translate-middle-y","end-0"],[1,"card","col-lg-4","col-md-6","col-sm-12","ms-auto"],[1,"card-header"],[1,"text-center","fw-bolder"],[1,"card-body"],["class","response-container",3,"innerHtml",4,"ngIf"],[1,"card-footer"],[1,"gap-3","d-flex","justify-content-between","align-items-center"],["type","text","id","gemini","placeholder","Chat with nasrallah",1,"form-control",3,"ngModel","ngModelChange"],["title","talk","type","button",1,"btn","btn-outline-secondary",3,"click"],["class","fa-solid fa-comment-dots",4,"ngIf"],["class","fa fa-spinner fa-spin",4,"ngIf"],[3,"value"],[1,"btn","btn-outline-danger",3,"click"],[1,"response-container",3,"innerHtml"],[1,"fa-solid","fa-comment-dots"],[1,"fa","fa-spinner","fa-spin"]],template:function(i,r){if(1&i&&(l.TgZ(0,"section")(1,"div",0)(2,"nav",1)(3,"div",2)(4,"a",3),l._uU(5,"Derma"),l.qZA(),l.TgZ(6,"button",4),l._UZ(7,"span",5),l.qZA(),l.TgZ(8,"div",6)(9,"ul",7)(10,"li",8)(11,"a",9),l.NdJ("click",function(){return r.signOut()}),l._uU(12,"Sign Out"),l.qZA()()()()()(),l.TgZ(13,"div",2)(14,"div",10)(15,"div",11)(16,"div",12)(17,"form",13)(18,"h2",14),l._uU(19,"Add Patient Form"),l.qZA(),l.TgZ(20,"div")(21,"mat-form-field",15)(22,"mat-label"),l._uU(23,"First Name"),l.qZA(),l._UZ(24,"input",16),l.YNc(25,OI,4,0,"mat-error",17),l.YNc(26,VI,5,0,"mat-error",17),l.YNc(27,NI,5,0,"mat-error",17),l.qZA(),l.TgZ(28,"mat-form-field",15)(29,"mat-label"),l._uU(30,"Last Name"),l.qZA(),l._UZ(31,"input",18),l.YNc(32,LI,4,0,"mat-error",17),l.YNc(33,BI,5,0,"mat-error",17),l.YNc(34,zI,5,0,"mat-error",17),l.qZA(),l.TgZ(35,"mat-form-field",19)(36,"mat-label"),l._uU(37,"Select gender"),l.qZA(),l.TgZ(38,"mat-select",20),l.YNc(39,UI,2,2,"mat-option",21),l.qZA(),l.YNc(40,qI,4,0,"mat-error",17),l.qZA(),l.TgZ(41,"mat-form-field",15)(42,"mat-label"),l._uU(43,"Date of birth"),l.qZA(),l._UZ(44,"input",22),l.YNc(45,GI,4,0,"mat-error",17),l.qZA(),l.TgZ(46,"mat-form-field",15)(47,"mat-label"),l._uU(48,"Email"),l.qZA(),l._UZ(49,"input",23),l.YNc(50,jI,4,0,"mat-error",17),l.YNc(51,HI,2,0,"mat-error",17),l.qZA(),l.TgZ(52,"mat-form-field",15)(53,"mat-label"),l._uU(54,"Phone"),l.qZA(),l._UZ(55,"input",24),l.YNc(56,ZI,4,0,"mat-error",17),l.YNc(57,KI,2,0,"mat-error",17),l.qZA()(),l.TgZ(58,"button",25),l.NdJ("click",function(){return r.addPatient()}),l._uU(59,"Add Patient"),l.qZA()()()(),l.TgZ(60,"div",26)(61,"div",27)(62,"div")(63,"h2",28),l._uU(64,"patient list"),l.qZA(),l.TgZ(65,"div",29)(66,"table",30)(67,"thead")(68,"tr")(69,"th"),l._uU(70,"first name"),l.qZA(),l.TgZ(71,"th"),l._uU(72,"last name"),l.qZA(),l.TgZ(73,"th"),l._uU(74,"Gender"),l.qZA(),l.TgZ(75,"th"),l._uU(76,"Date of birth"),l.qZA(),l.TgZ(77,"th"),l._uU(78,"email"),l.qZA(),l.TgZ(79,"th"),l._uU(80,"phone"),l.qZA(),l.TgZ(81,"th"),l._uU(82,"action"),l.qZA()()(),l.TgZ(83,"tbody"),l.YNc(84,$I,16,6,"tr",31),l.qZA()()()()()()()()(),l.TgZ(85,"div",32)(86,"div",33)(87,"div",34)(88,"h1",35),l._uU(89,"NASRLLAHGPT"),l.qZA()(),l.TgZ(90,"div",36)(91,"div"),l.YNc(92,WI,1,1,"div",37),l.qZA()(),l.TgZ(93,"div",38)(94,"div",39)(95,"input",40),l.NdJ("ngModelChange",function(o){return r.prompt=o}),l.qZA(),l.TgZ(96,"button",41),l.NdJ("click",function(){return r.generateContent()}),l.YNc(97,YI,1,0,"i",42),l.YNc(98,QI,1,0,"i",43),l.qZA()()()()()()),2&i){let s,o,a,c,d,u,h,f,m,g,v,b;l.xp6(17),l.Q6J("formGroup",r.createPatientForm),l.xp6(8),l.Q6J("ngIf",null==(s=r.createPatientForm.get("firstName"))||null==s.errors?null:s.errors.required),l.xp6(1),l.Q6J("ngIf",null==(o=r.createPatientForm.get("firstName"))||null==o.errors?null:o.errors.minlength),l.xp6(1),l.Q6J("ngIf",null==(a=r.createPatientForm.get("firstName"))||null==a.errors?null:a.errors.maxlength),l.xp6(5),l.Q6J("ngIf",null==(c=r.createPatientForm.get("lastName"))||null==c.errors?null:c.errors.required),l.xp6(1),l.Q6J("ngIf",null==(d=r.createPatientForm.get("lastName"))||null==d.errors?null:d.errors.minlength),l.xp6(1),l.Q6J("ngIf",null==(u=r.createPatientForm.get("lastName"))||null==u.errors?null:u.errors.maxlength),l.xp6(5),l.Q6J("ngForOf",r.genders),l.xp6(1),l.Q6J("ngIf",null==(h=r.createPatientForm.get("gender"))||null==h.errors?null:h.errors.required),l.xp6(5),l.Q6J("ngIf",null==(f=r.createPatientForm.get("birthDate"))||null==f.errors?null:f.errors.required),l.xp6(5),l.Q6J("ngIf",null==(m=r.createPatientForm.get("email"))||null==m.errors?null:m.errors.required),l.xp6(1),l.Q6J("ngIf",null==(g=r.createPatientForm.get("email"))||null==g.errors?null:g.errors.email),l.xp6(5),l.Q6J("ngIf",null==(v=r.createPatientForm.get("phone"))||null==v.errors?null:v.errors.required),l.xp6(1),l.Q6J("ngIf",null==(b=r.createPatientForm.get("phone"))||null==b.errors?null:b.errors.pattern),l.xp6(1),l.Q6J("disabled",r.createPatientForm.invalid),l.xp6(26),l.Q6J("ngForOf",r.patientList),l.xp6(8),l.Q6J("ngIf",r.generatedText),l.xp6(3),l.Q6J("ngModel",r.prompt),l.xp6(2),l.Q6J("ngIf",!r.loading),l.xp6(1),l.Q6J("ngIf",r.loading)}},dependencies:[G.ez,G.sg,G.O5,Br,Sy,Ao,vy,Fy,My,N.UX,N._Y,N.Fj,N.JJ,N.JL,N.sg,N.u,N.u5,N.On,Yv,Wv,Ad],styles:[".example-form[_ngcontent-%COMP%]{min-width:150px;max-width:100%;width:100%}.example-full-width[_ngcontent-%COMP%]{width:100%}.left-side[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{right:20px;top:10px}.card-body[_ngcontent-%COMP%]{height:400px;overflow:auto}.response-container[_ngcontent-%COMP%]{border:1px solid #ccc;padding:20px;width:100%;min-width:400px;max-width:600px;box-shadow:0 0 10px #0000001a;border-radius:8px;font-family:Arial,sans-serif}.response-container[_ngcontent-%COMP%]{border:1px solid #ccc;padding:20px;width:100%;box-shadow:0 0 10px #0000001a;border-radius:8px;background-color:#f9f9f9}.response-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px;margin-bottom:10px;color:#333}.response-container[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:20px;margin-bottom:20px;list-style-type:disc}.response-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px;line-height:1.6}.response-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:15px;line-height:1.6;color:#555}.response-container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700;color:#000}"]})}return n})()}}]);